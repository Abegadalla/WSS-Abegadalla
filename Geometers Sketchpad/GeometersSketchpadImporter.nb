(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    333454,       8200]
NotebookOptionsPosition[    304533,       7705]
NotebookOutlinePosition[    305103,       7726]
CellTagsIndexPosition[    305060,       7723]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Geometer's Sketchpad Importer", "Title",
 CellChangeTimes->{{3.437418864478209*^9, 3.437418869776973*^9}, 
   3.437503596805079*^9, {3.437756288419866*^9, 3.437756299549172*^9}, {
   3.438608655894864*^9, 3.438608666861088*^9}, {3.438609060451026*^9, 
   3.438609060525852*^9}},ExpressionUUID->"a4640f93-e7dc-406f-8b76-\
a6edd1874fbb"],

Cell["Christopher Carlson  2008.12.18", "Subsubtitle",
 CellChangeTimes->{{3.438608671272461*^9, 
  3.438608684133127*^9}},ExpressionUUID->"35e3879c-55b8-4cbd-8f42-\
505c425429cc"],

Cell[TextData[{
 "This notebook started as an effort to divine how Geometer's Sketchpad \
works.  \n\nTo test my understanding, I attempted to model Geometer's \
Sketchpad's behavior in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ".\n\nThat effort ended with an import function that will import \
functioning, interactive GSP models into ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.437418861475746*^9, 3.437418910713726*^9}, 
   3.4375035968055153`*^9, {3.437756308919491*^9, 3.43775631037309*^9}, {
   3.43860868842948*^9, 3.438608765284113*^9}, {3.4386087996194344`*^9, 
   3.438608838293095*^9}, {3.438609073115988*^9, 3.4386091298950357`*^9}, 
   3.438609730268125*^9},ExpressionUUID->"54bfb705-efca-40d0-9304-\
e156eeded9bd"],

Cell[CellGroupData[{

Cell["Notes", "Section",
 CellChangeTimes->{{3.4374189143888474`*^9, 3.4374189150011673`*^9}, 
   3.4375035968058453`*^9},ExpressionUUID->"afe4804d-c564-42d4-b268-\
53fee723c7ba"],

Cell[CellGroupData[{

Cell["Notes on GSP's constraint strategy", "Subsection",
 CellChangeTimes->{{3.43748829308663*^9, 3.437488310543231*^9}, 
   3.437503596806115*^9},ExpressionUUID->"c21d4703-7857-4da5-b570-\
713c3226d776"],

Cell["\<\
The geometry of a configuration depends only on the absolute position of the \
mouse, not on drag history (in contrast to Geometry Expressions' behavior).\
\>", "Text",
 CellChangeTimes->{{3.437418934362493*^9, 3.437418945405807*^9}, 
   3.437503596806973*^9},ExpressionUUID->"454b1e5e-bdaa-4907-8d64-\
4fc42236cd04"],

Cell["\<\
When dragging a point on a circle, the position of the point is the \
projection of the point onto the circle, ie, the intersection of the line \
from the center to the point with the circle.\
\>", "Text",
 CellChangeTimes->{{3.437418934362493*^9, 3.437418966473217*^9}, 
   3.437503596807192*^9},ExpressionUUID->"61ac282b-55f5-4959-aba8-\
feac89808b56"],

Cell["\<\
Drag any point on a chord, drag outside the circle, and the chord collapses \
to a single point on the line parallel to the chord and passing through the \
center of the circle.\
\>", "Text",
 CellChangeTimes->{{3.437418934362493*^9, 3.437418966473217*^9}, {
   3.437485260963027*^9, 3.437485265382053*^9}, 
   3.4375035968074102`*^9},ExpressionUUID->"4433b4d9-2f5a-410a-89fb-\
3471b2b88627"],

Cell["A line is represented by two points.", "Text",
 CellChangeTimes->{{3.437486633354917*^9, 3.437486646200882*^9}, 
   3.4375035968076267`*^9},ExpressionUUID->"9f78930b-1ecb-4c85-b102-\
7dc9b1dcadf1"],

Cell["\<\
A point on a line is represented by the parametric position relative to the \
two points that define the line.  If the points are moved, the point on the \
line moves proportionally.\
\>", "Text",
 CellChangeTimes->{{3.437486648377199*^9, 3.4374866856172523`*^9}, 
   3.4375035968078423`*^9},ExpressionUUID->"cc758185-97ed-48a8-9809-\
828c55421488"],

Cell["\<\
Dragging a point-on-a-line changes is parametric position on the line.  The \
line never drags.\
\>", "Text",
 CellChangeTimes->{{3.437486772259726*^9, 3.4374868225376463`*^9}, 
   3.4375035968080597`*^9},ExpressionUUID->"27709269-2493-44ec-bda6-\
7b620a52b280"],

Cell["\<\
A point on a circle is represented by its angular position on the circle.  If \
the circle is rotated by dragging its center, the orientation of the point is \
unchanged.\
\>", "Text",
 CellChangeTimes->{{3.437486720275817*^9, 3.4374867489054937`*^9}, 
   3.437503596808277*^9},ExpressionUUID->"6865e6ee-dd6f-4dde-b781-\
9c10ea65e1ed"],

Cell["\<\
Dragging a point on a circle gives the projection of the mouse position onto \
the circle.  The circle never drags.\
\>", "Text",
 CellChangeTimes->{{3.437486854811822*^9, 3.437486884689814*^9}, 
   3.4375035968084917`*^9},ExpressionUUID->"b4d33bfd-ad14-47f7-94a5-\
3dd1ab21752a"],

Cell["\<\
If multiple objects are dragged and the constraints are too complex to solve, \
the whole object translates as a rigid body.\
\>", "Text",
 CellChangeTimes->{{3.437487130805071*^9, 3.437487160723154*^9}, 
   3.437503596808707*^9},ExpressionUUID->"4b4638f1-a79b-432e-9d21-\
45feab0a7648"],

Cell["\<\
Limiting constraints to constructions ensures that the resulting constraint \
structure has no loops.  Allowing the addition of arbitrary constraints (as a \
constraint language might permit) would require a strategy for dealing with \
constraint loops.\
\>", "Text",
 CellChangeTimes->{{3.4380053359325523`*^9, 
  3.438005399818878*^9}},ExpressionUUID->"570b6704-e128-43dc-b524-\
437c5243e430"],

Cell[TextData[{
 "Limiting constraints to constructions also ensures that no object depends \
on other objects in more than one way: you can't construct a point that lies \
on a line ",
 StyleBox["and",
  FontSlant->"Italic"],
 " lies on a circle."
}], "Text",
 CellChangeTimes->{{3.4380061509879837`*^9, 
  3.438006209795884*^9}},ExpressionUUID->"122611f2-fd99-4b77-9b2c-\
6588ae1b507e"],

Cell["\<\
Limiting constraints to constructions means that in the resulting constraint \
graph, (1) only one multiedge emanates from any object node, and (2) there \
are no cycles.\
\>", "Text",
 CellChangeTimes->{{3.438007075135098*^9, 
  3.4380071108604097`*^9}},ExpressionUUID->"18413670-6ba9-4f63-b8cd-\
692625a878ce"],

Cell[TextData[{
 "It is painful in GSP to construct a line segment with a fixed length.  To \
construct a line segment with a fixed length ",
 StyleBox["and direction",
  FontSlant->"Italic"],
 ", you translate a copy of a point from itself by a fixed distance, then \
construct a line segment between the points.  To construct a line segment \
with a fixed length, but not direction, you have to construct a circle with a \
fixed radius using the procedure I just described, then construct a point on \
the circle, and finally, a line between the center of the circle and the \
point on the circle."
}], "Text",
 CellChangeTimes->{{3.438005409069469*^9, 3.438005503035543*^9}, {
  3.43800556619033*^9, 
  3.4380056643953667`*^9}},ExpressionUUID->"d66b16ad-255f-41e0-94cb-\
480b6240104f"],

Cell["\<\
GSP often throws up its hands and translates an entire object if it has to \
solve contstraints in two directions at once.\
\>", "Text",
 CellChangeTimes->{{3.438015578362389*^9, 3.438015589711089*^9}, {
  3.438015635994972*^9, 
  3.438015655295184*^9}},ExpressionUUID->"dd90fc41-d187-4b77-b5fc-\
3a62dffcc31a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Other notes", "Subsection",
 CellChangeTimes->{{3.437488314007719*^9, 3.437488315278981*^9}, 
   3.4375035968089247`*^9},ExpressionUUID->"77ca1ac3-c041-447e-b2ae-\
7c2d5ca324ff"],

Cell["\<\
In order to make an intelligent choice of constraint system, we have to know \
what we intend to do with it.\
\>", "Text",
 CellChangeTimes->{{3.437488324567244*^9, 3.437488349607049*^9}, 
   3.4375035968092337`*^9},ExpressionUUID->"ed15fd70-66d7-45b2-836c-\
d9b40a0e4ca7"],

Cell["\<\
GSP has many auxilliary features that make it attractive in education: \
animations, scripts, traces, buttons, styling of objects and text, import of \
images, tabbed views, links.\
\>", "Text",
 CellChangeTimes->{{3.4386943490642357`*^9, 3.438694378239416*^9}, {
  3.438694804966608*^9, 
  3.438694809960903*^9}},ExpressionUUID->"e0b3a6e8-1ae6-46ec-a6a1-\
98b30ab0e7d0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparison to Geometry Expressions", "Subsection",
 CellChangeTimes->{{3.437487973200356*^9, 3.4374879789656477`*^9}, 
   3.437503596809452*^9},ExpressionUUID->"8accb375-fd64-4b06-a57e-\
eb6d731b395e"],

Cell["\<\
A chain of fixed-length line segments is a pain to construct.  You can't drag \
the whole chain; just individual segments.  And since the end segments are \
not symmetric (one goes from radius to center, one from center to radius), \
they drag differently. \
\>", "Text",
 CellChangeTimes->{{3.437488017544271*^9, 3.437488103718504*^9}, 
   3.437503596809752*^9},ExpressionUUID->"6f87ce50-0143-4547-9127-\
e9b6b888552c"],

Cell["\<\
If you were to construct a grid in GSP, it would not have the nice drag \
property that it does in GE.\
\>", "Text",
 CellChangeTimes->{{3.437488226742606*^9, 3.437488256694997*^9}, 
   3.437503597228457*^9},ExpressionUUID->"05a3d56e-3b40-4374-8892-\
9401a1950a85"]
}, Closed]],

Cell[CellGroupData[{

Cell["GSP Constraints", "Subsection",
 CellChangeTimes->{{3.438458491323599*^9, 
  3.438458497400552*^9}},ExpressionUUID->"c030f226-b881-4c70-b944-\
5a46f8f6fc8b"],

Cell[BoxData[GridBox[{
   {"Constraint", "Inputs", "Outputs", 
    RowBox[{"Drag", "\[IndentingNewLine]", "Backpropagation"}], 
    RowBox[{"Backpropagation", "\[IndentingNewLine]", "Stop"}]},
   {"CenterPointCircle", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Point"}], "}"}], "Circle", "yes", "no"},
   {"PointPointLine", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Point"}], "}"}], "Line", "yes", "no"},
   {"PointOnLine", "Line", "Point", "no", "yes"},
   {"PointOnCircle", "Circle", "Point", "no", "yes"},
   {"Midpoint", "Line", "Point", "yes", "no"},
   {"AngleBisector", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Point", ",", "Point"}], "}"}], "Line", "yes", 
    "no"},
   {"ArcThroughThreePoints", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Point", ",", "Point"}], "}"}], "Arc", "yes", "no"},
   {"ParallelLine", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Line"}], "}"}], "Line", 
    RowBox[{
     RowBox[{"Point", ":", "yes"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "no"}]}], 
    RowBox[{
     RowBox[{"Point", ":", "no"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "yes"}]}]},
   {"PerpendicularLine", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Line"}], "}"}], "Line", 
    RowBox[{
     RowBox[{"Point", ":", "yes"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "no"}]}], 
    RowBox[{
     RowBox[{"Point", ":", "no"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "yes"}]}]},
   {"CenterRadiusCircle", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Line"}], "}"}], "Circle", 
    RowBox[{
     RowBox[{"Point", ":", "yes"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "no"}]}], 
    RowBox[{
     RowBox[{"Point", ":", "no"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "yes"}]}]},
   {"Translate", "Object", "Object", 
    RowBox[{"yes", ":", " ", 
     RowBox[{
      SuperscriptBox["t", 
       RowBox[{"-", "1"}]], ".", "d"}]}], "no"},
   {"Rotate", "Object", "Object", "\[Placeholder]", "\[Placeholder]"},
   {"Dialate", "Object", "Object", "\[Placeholder]", "\[Placeholder]"},
   {"Reflect", "Object", "Object", "\[Placeholder]", "\[Placeholder]"}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}}]], "Input",
 CellChangeTimes->{{3.438458545949321*^9, 3.438458618742032*^9}, {
  3.438458671543292*^9, 3.438458699718639*^9}, {3.438458775229303*^9, 
  3.438458806999043*^9}, {3.438458876544417*^9, 3.438458927826297*^9}, {
  3.438459101188678*^9, 3.438459107426815*^9}, {3.438459232988752*^9, 
  3.4384592534430017`*^9}, {3.4384593814258547`*^9, 3.438459424723297*^9}, {
  3.438459494965974*^9, 3.438459611186418*^9}, {3.438459653989311*^9, 
  3.4384596671398163`*^9}, {3.438459700071013*^9, 3.4384597337424507`*^9}, {
  3.438512001086767*^9, 3.438512032973083*^9}, {3.438512067558947*^9, 
  3.43851206765161*^9}},ExpressionUUID->"15f00648-abbd-4f5a-ad93-\
9600234c5da8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sources of GSP Files", "Subsection",
 CellChangeTimes->{{3.438694611931305*^9, 
  3.4386946158964777`*^9}},ExpressionUUID->"0bb240a4-20f2-4715-b00c-\
674812fd8d2d"],

Cell["custom tools, basic techniques, basic sketches:", "Text",
 CellChangeTimes->{{3.440274633736216*^9, 
  3.440274634991269*^9}},ExpressionUUID->"c4627b7d-b8bc-4421-8276-\
0036a4f2bebb"],

Cell[TextData[{
 ButtonBox["http://pt3.ed.asu.edu/Summer2002_sketchpad_PC.html",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://pt3.ed.asu.edu/Summer2002_sketchpad_PC.html"], None},
  ButtonNote->"http://pt3.ed.asu.edu/Summer2002_sketchpad_PC.html"],
 " "
}], "Text",
 CellChangeTimes->{{3.438694701384265*^9, 3.43869472111769*^9}, {
  3.438694814124386*^9, 3.4386948180005627`*^9}, {3.440274631025137*^9, 
  3.44027463126367*^9}},ExpressionUUID->"076080ac-96ac-43ac-87e9-\
06e4fa88ed9d"],

Cell["Mechanical linkages:", "Text",
 CellChangeTimes->{{3.440274623145095*^9, 
  3.4402746257593203`*^9}},ExpressionUUID->"bc73f400-8532-4ceb-98bc-\
f5fe60711706"],

Cell[TextData[ButtonBox["http://www.mfdabbs.pwp.blueyonder.co.uk/Maths_Pages/\
SketchPad_Files/Mechanical_Linkages/Mechanical_Linkages.html",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://www.mfdabbs.pwp.blueyonder.co.uk/Maths_Pages/SketchPad_Files/\
Mechanical_Linkages/Mechanical_Linkages.html"], None},
 ButtonNote->
  "http://www.mfdabbs.pwp.blueyonder.co.uk/Maths_Pages/SketchPad_Files/\
Mechanical_Linkages/Mechanical_Linkages.html"]], "Text",
 CellChangeTimes->{{3.440274610010356*^9, 
  3.4402746179319773`*^9}},ExpressionUUID->"daf973e9-3886-4936-ba56-\
24576948e08b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["To Do", "Section",
 CellChangeTimes->{{3.438608858071232*^9, 
  3.438608859613888*^9}},ExpressionUUID->"62b865fe-d200-408e-b3e1-\
624f7870a480"],

Cell[CellGroupData[{

Cell["To Do", "Subsection",
 CellChangeTimes->{{3.438091004198845*^9, 
  3.438091005100202*^9}},ExpressionUUID->"4281c50e-90ca-49d6-a3a7-\
52d47f63273f"],

Cell[CellGroupData[{

Cell["High Priority", "Subsubsection",
 CellChangeTimes->{{3.4386095148292522`*^9, 
  3.438609525687325*^9}},ExpressionUUID->"deb8e877-ed04-444f-9fad-\
40da19f22989"],

Cell["\<\
- the drag algorithm should drag rigidly if there is more than one path to an \
object (through affine transforms)\
\>", "Text",
 CellChangeTimes->{{3.443902639187002*^9, 3.4439026939548492`*^9}, {
  3.4440743501384773`*^9, 
  3.4440743575615883`*^9}},ExpressionUUID->"2f457843-bab5-4b0f-9c74-\
e0570fc9f5fc"],

Cell["\<\
- however, if you drag a line between a point and its reflection, the \
reflection line drags\
\>", "Text",
 CellChangeTimes->{{3.4440743631866407`*^9, 
  3.444074380929549*^9}},ExpressionUUID->"78e011ba-641e-4ba9-9f5f-\
55ab272d623c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Medium Priority", "Subsubsection",
 CellChangeTimes->{{3.438609527959704*^9, 
  3.438609530358839*^9}},ExpressionUUID->"3cd0919e-e4b7-4775-bc3c-\
87d47fb1617f"],

Cell["- implement hidden attibute", "Text",
 CellChangeTimes->{{3.438708923468072*^9, 
  3.438708927292131*^9}},ExpressionUUID->"163a3051-d28c-4c3c-ac8c-\
e5d027227d00"],

Cell["- read trace attribute from html file", "Text",
 CellChangeTimes->{{3.438780222233177*^9, 
  3.4387802282788477`*^9}},ExpressionUUID->"d3e36572-2e09-41e7-8b78-\
1c4bc929168f"],

Cell["- implement loci", "Text",
 CellChangeTimes->{{3.438595713029784*^9, 3.4385957299276123`*^9}, {
   3.438599933792951*^9, 3.438599985652996*^9}, 3.438603580677176*^9, {
   3.4386094320741577`*^9, 3.438609437657764*^9}, 3.4386094746065283`*^9, 
   3.438705108049123*^9},ExpressionUUID->"64948ef7-191c-4768-9877-\
57f30682fd3f"],

Cell["\<\
- check out what happens and what is supposed to happen when multiple objects \
are dragged\
\>", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609451998703*^9}, {3.43871316196135*^9, 
   3.438713163228207*^9}},ExpressionUUID->"b98ecdaf-7cea-4315-9ea6-\
516fa062ca7f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Low Priority", "Subsubsection",
 CellChangeTimes->{{3.438609531599647*^9, 
  3.438609533294582*^9}},ExpressionUUID->"4f046a2a-4af7-49f1-ba0e-\
b1f9594e6ea7"],

Cell["- parse files with multiple tabs", "Text",
 CellChangeTimes->{{3.438695034372682*^9, 
  3.438695040729445*^9}},ExpressionUUID->"bfc1638b-7890-448e-8a9c-\
19e2d3172599"],

Cell["- implement GSP's concept of \"script tools\"", "Text",
 CellChangeTimes->{{3.438632342850834*^9, 
  3.4386323532503767`*^9}},ExpressionUUID->"9f7610d5-42f1-405d-8ded-\
99bee2f0f462"],

Cell["- example of merging back-propagation paths that conflict?", "Text",
 CellChangeTimes->{{3.438431952071487*^9, 
  3.4384319709245663`*^9}},ExpressionUUID->"953da44c-b85e-4b82-a72f-\
8d9f74c96eaf"],

Cell["\<\
- what alternative strategy could be used to accomodate multiple drags on one \
back propagation path?\
\>", "Text",
 CellChangeTimes->{{3.438457918666637*^9, 
  3.438457955688493*^9}},ExpressionUUID->"d4e82f2d-0b83-4b1c-904b-\
d9d0d183562c"],

Cell["- replace separate parameter with PointOnObject[p]?", "Text",
 CellChangeTimes->{{3.438595713029784*^9, 3.4385957299276123`*^9}, {
   3.438599933792951*^9, 3.438599985652996*^9}, 3.438603580677176*^9, 
   3.4386094320741577`*^9},ExpressionUUID->"6f46aa4d-8898-439f-836c-\
38865abf21ba"],

Cell["- add rotation and dialation drag tools", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609449063109*^9}, {3.438705140281457*^9, 
   3.4387051423646812`*^9}},ExpressionUUID->"7cd8b805-0834-422c-86e5-\
c177a746c106"],

Cell["- unify GSP and model constraint syntaxes", "Text",
 CellChangeTimes->{{3.438595713029784*^9, 3.4385957299276123`*^9}, {
   3.438599933792951*^9, 3.438599985652996*^9}, 3.438603580677176*^9, {
   3.4386094320741577`*^9, 3.438609434665965*^9}, 
   3.438609472174828*^9},ExpressionUUID->"dd8e73eb-47dd-44f5-bb73-\
e9d39dd0f621"]
}, Closed]],

Cell["Unprioritized", "Subsubsection",
 CellChangeTimes->{{3.438609546810713*^9, 
  3.438609549854766*^9}},ExpressionUUID->"c8f6c7d6-86f9-4f28-9fb8-\
48c5b876f23a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Done", "Subsection",
 CellChangeTimes->{{3.43860941307299*^9, 
  3.4386094134063168`*^9}},ExpressionUUID->"e2b16141-1d61-44cf-b4a0-\
c95258c362c0"],

Cell["\t- add all remaining constraints", "Text",
 CellChangeTimes->{{3.438705047644321*^9, 3.438705052172261*^9}, 
   3.438712937822775*^9, 
   3.4387802008339033`*^9},ExpressionUUID->"5b8da94d-6d42-43c5-90ae-\
36716d18f0d1"],

Cell["\t- add trace objects", "Text",
 CellChangeTimes->{{3.438713146326548*^9, 3.43871314909976*^9}, 
   3.438780202374798*^9},ExpressionUUID->"b973376d-e438-49d3-916f-\
fbe8953f64ef"],

Cell["\<\
\t- make transform constraints work inversely: ConstraintTransform has to be \
fed not only the argument parameter, but also the argument objects: make the \
constraint-specific functions nicer, eg: ConstraintTransform[Rotation, -1.3, \
Point[{0,0}]] and prepare the arguments in the drag function.\
\>", "Text",
 CellChangeTimes->{{3.43870506178053*^9, 3.4387050726124277`*^9}, {
   3.4387166806787024`*^9, 3.438716682018908*^9}, {3.438719521448056*^9, 
   3.438719600399932*^9}, {3.438774340889319*^9, 3.438774342015444*^9}, 
   3.4387743953459263`*^9},ExpressionUUID->"36312e2a-a869-4c42-81b7-\
3e22f5e8a0bd"],

Cell["\<\
\t- in Pantograph, circle radius line moves when circle is dragged; \
constraint should mark which arguments get dragged and which don't; ditto \
with ParabolicLocus parallel lines\
\>", "Text",
 CellChangeTimes->{{3.438709034782337*^9, 3.438709074252451*^9}, {
  3.438711753068943*^9, 3.438711762369153*^9}, {3.4387178206455803`*^9, 
  3.438717846192676*^9}},ExpressionUUID->"81e8fb94-4f07-4b32-98c3-\
a56225d81c69"],

Cell["\t- correct line and point-on-line constraints", "Text",
 CellChangeTimes->{{3.438705031051297*^9, 3.438705044396523*^9}, 
   3.438709221464746*^9, 
   3.438712937822109*^9},ExpressionUUID->"4a4a19f1-afcc-4ca5-a2fc-\
1a0dc48923a3"],

Cell["\t- accommodate failed constructions", "Text",
 CellChangeTimes->{{3.4380910098760777`*^9, 3.438091018028192*^9}, 
   3.438712920084017*^9},ExpressionUUID->"b672a71a-4686-4ea8-a3dd-\
ce85142905a5"],

Cell["\t- ignore unrecognized file elements", "Text",
 CellChangeTimes->{{3.438622369410424*^9, 3.438622393903256*^9}, 
   3.4387050903891163`*^9},ExpressionUUID->"37d72f8c-aab4-4eee-adb5-\
a5ac8ec7cfc2"],

Cell["\<\
\t- when dragging CenterOnCircleChain, centers depart from circles\
\>", "Text",
 CellChangeTimes->{{3.438611669722814*^9, 3.438611679090208*^9}, 
   3.438618288605113*^9},ExpressionUUID->"37969a60-2d5b-4b27-a6a2-\
3b0d7a8d090a"],

Cell["\t- reverse sense of point on circle parameter", "Text",
 CellChangeTimes->{{3.4386113157571917`*^9, 3.4386113242423687`*^9}, 
   3.43861858264824*^9},ExpressionUUID->"5a8063f6-50e0-486c-8198-\
d8029b6c3923"],

Cell["\t- correct ProjectPoint and GetHit for line types", "Text",
 CellChangeTimes->{{3.438546762703796*^9, 3.438546791188651*^9}, 
   3.438609430450466*^9, 
   3.438619369370061*^9},ExpressionUUID->"65333d90-0d6e-43b8-9db6-\
01c39573d2a4"],

Cell["\t- test points on line segments", "Text",
 CellChangeTimes->{{3.438546762703796*^9, 3.438546791188651*^9}, 
   3.438609430450466*^9, 3.438609469814547*^9, 
   3.438619372158087*^9},ExpressionUUID->"fe85a778-6cb5-423f-9807-\
f1fc43fee5d8"],

Cell["\t- should be able to mouse-down and immediately drag", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609447782826*^9}, 
   3.438621355952017*^9},ExpressionUUID->"c94ffae6-3fa0-4358-a392-\
d68e9677971a"],

Cell["\t- can't drag line in endpointOnLineChain", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.4386094511109343`*^9}, 
   3.4386219847305183`*^9},ExpressionUUID->"b0cda947-3b95-4a1f-a6c4-\
2d27591d361f"],

Cell["\t- sometimes objects can't be hit after a drag", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609449726831*^9}, 
   3.4386193791023293`*^9},ExpressionUUID->"7a28c988-4497-4f6d-8f33-\
a86a42c6d775"],

Cell["\<\
\t- what about constructions that result in more than one object (like \
intersection of circles)?\
\>", "Text",
 CellChangeTimes->{{3.438091022115841*^9, 3.438091036861925*^9}, 
   3.438456763668036*^9},ExpressionUUID->"efc1aafe-fa94-4be3-b450-\
f55b6cf04f3d"],

Cell["\<\
\t- clean up image size, plot range, and hit-testing issues in manipulate \
environment\
\>", "Text",
 CellChangeTimes->{{3.4386034950033216`*^9, 3.438603552711946*^9}, {
   3.438608583666483*^9, 3.438608592573007*^9}, 
   3.438609423788*^9},ExpressionUUID->"224759f2-d920-4461-b03a-37722474f198"],

Cell["\t- import plot range along with GSP html information", "Text",
 CellChangeTimes->{{3.4386034950033216`*^9, 3.438603552711946*^9}, {
   3.438608583666483*^9, 3.438608592573007*^9}, {3.438609423788*^9, 
   3.4386094257219887`*^9}, 
   3.438609461398863*^9},ExpressionUUID->"57444c38-1bae-43c0-9e0a-\
a21bda4ee2c0"],

Cell["\t- how are loci implemented?", "Text",
 CellChangeTimes->{{3.4386034950033216`*^9, 3.438603552711946*^9}, {
   3.438608583666483*^9, 3.438608592573007*^9}, {3.438609423788*^9, 
   3.438609427154249*^9}, 
   3.438609465966515*^9},ExpressionUUID->"eef91ff4-4c18-4bb9-a36a-\
7d237011d78b"],

Cell["\t- import GSP files?", "Text",
 CellChangeTimes->{{3.438595713029784*^9, 3.4385957299276123`*^9}, {
   3.438599933792951*^9, 3.438599985652996*^9}, 3.438603580677176*^9, {
   3.4386094320741577`*^9, 3.438609436290324*^9}, 
   3.438609473318781*^9},ExpressionUUID->"6ff653cf-77d4-4f10-8a84-\
7d020a98abe2"],

Cell["\<\
\t- points should draw and hit-test in front of everything else\
\>", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, 
   3.438609445663458*^9},ExpressionUUID->"96a40119-f50a-4e0c-8d74-\
4dad78256563"],

Cell["\t- nothing should change if you drag nothing", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609447039068*^9}},ExpressionUUID->"cd68d6df-72c7-4431-80ea-\
29125af0a481"],

Cell["\t- hit precision depends on plot range", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609450542713*^9}},ExpressionUUID->"f9226158-9269-4b59-ba0e-\
abe4918629ea"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.438780276026884*^9, 
  3.4387802770478163`*^9}},ExpressionUUID->"5df35583-9028-4859-92a9-\
c239f1bc6607"],

Cell[CellGroupData[{

Cell["Import Example", "Subsection",
 CellChangeTimes->{{3.534601769623968*^9, 
  3.534601782995954*^9}},ExpressionUUID->"74a9e50d-d584-4c76-9cf7-\
3a021db8b3e3"],

Cell["\<\
These examples are run directly from Geometer's Sketchpad output files with \
commands like this:\
\>", "Text",
 CellChangeTimes->{{3.4387809347761*^9, 3.43878097191805*^9}, {
  3.43878307599527*^9, 
  3.438783087315271*^9}},ExpressionUUID->"f7b70eca-efbb-4aa2-b47c-\
61a25a51595a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ImportModel", "[", "\"\<CircleLocus.html\>\"", "]"}], "//", 
  "PrettyPrintModel"}]], "Input",
 CellLabel->
  "In[193]:=",ExpressionUUID->"73efcf0e-3c65-4cef-a4ed-475ffaa14df4"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"527", ",", "397"}], "}"}], "]"}], "", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}]},
    {"2", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"586", ",", "377"}], "}"}], "]"}], "", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}]},
    {"3", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"527", ",", "397"}], "}"}], ",", 
       SqrtBox["3881"]}], "]"}], "CircleCenterRadius", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]},
    {"4", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"561.9997758996814`", ",", "345.4634529001788`"}], "}"}], 
      "]"}], "PointOnObject", 
     RowBox[{"{", 
      RowBox[{"-", "0.974218`"}], "}"}], 
     RowBox[{"{", "3", "}"}]},
    {"5", 
     RowBox[{"LineSegment", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"561.9997758996814`", ",", "345.4634529001788`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"527", ",", "397"}], "}"}]}], "}"}], "]"}], 
     "LineSegmentThroughPoints", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", 
      RowBox[{"4", ",", "1"}], "}"}]},
    {"6", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"420", ",", "216"}], "}"}], "]"}], "", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}]},
    {"7", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"420", ",", "216"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"368.4634529001788`", ",", "181.00022410031863`"}], "}"}]}], 
       "}"}], "]"}], "Perpendicular", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}]},
    {"8", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"251", ",", "212"}], "}"}], "]"}], "", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}]},
    {"9", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"251", ",", "212"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"285.99977589968137`", ",", "160.46345290017882`"}], "}"}]}],
        "}"}], "]"}], "Perpendicular", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", 
      RowBox[{"7", ",", "8"}], "}"}]},
    {"10", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"302.483452333205`", ",", "136.19153272190562`"}], "}"}], 
      "]"}], "PointAtIntersection", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", 
      RowBox[{"7", ",", "9"}], "}"}]},
    {"11", "$Failed", "Locus", 
     RowBox[{"{", "300", "}"}], 
     RowBox[{"{", 
      RowBox[{"10", ",", "4", ",", "3"}], "}"}]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->
  "Out[193]=",ExpressionUUID->"698014f6-8231-412a-9f2c-e2549498c609"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RunModel", "@", "\"\<CircleLocus.html\>\""}]], "Input",
 CellLabel->
  "In[194]:=",ExpressionUUID->"e14b0457-c89a-4258-bc09-dc6a6f7e42be"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$103488 = \
$CellContext`selection$103488)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$103488 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$103488 = \
$CellContext`initialModel$103488; $CellContext`selection$103488 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       DefaultBaseStyle->"Column",
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$103488], StandardForm,
             Graphics],
           
           ImageSizeCache->{{-51170.41421356237, 
            51957.41421356237}, {-51468.41421356237, 51659.41421356237}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$103488, \
$CellContext`selection$103488], StandardForm, Graphics],
           
           ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
            4.503599627370496*^15, -4.503599627370496*^15}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$103488, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          566}}],
        ImageSize->{739, 566},
        PlotRange->{{0, 739}, {0, 566}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$103488 = \
($CellContext`mouseDownPosition$103488 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$103488 = \
$CellContext`model$103488; $CellContext`mouseDownHit$103488 = \
$CellContext`GetHit[$CellContext`model$103488, 
            $CellContext`hitTransform$103488[$CellContext`mouseDownPosition$\
103488]]; $CellContext`mouseDownOnSelection$103488 = 
          Intersection[$CellContext`selection$103488, \
$CellContext`mouseDownHit$103488] =!= {}; $CellContext`selection$103488 = 
          If[$CellContext`mouseDownHit$103488 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$103488, \
$CellContext`mouseDownHit$103488]]; $CellContext`firstDrag$103488 = 
          True; $CellContext`mouseDidDrag$103488 = 
          False; $CellContext`mouseDownShiftKey$103488 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$103488], \
$CellContext`mouseDownOnSelection$103488], $CellContext`selection$103488 = \
$CellContext`ToggleSelection[$CellContext`selection$103488, \
$CellContext`mouseDownHit$103488]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$103488], 
            
            Not[$CellContext`mouseDownShiftKey$103488]], \
$CellContext`selection$103488 = $CellContext`mouseDownHit$103488]; \
$CellContext`mouseDidDrag$103488 = True; $CellContext`firstDrag$103488 = 
          False; With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$103488 = \
$CellContext`Drag[$CellContext`mouseDownModel$103488, \
$CellContext`selection$103488, 
              TranslationTransform[
               $CellContext`dragTransform$103488[$CellContext`mousePosition$\
103488 - $CellContext`mouseDownPosition$103488]]]; \
$CellContext`mousePosition$103488 = $CellContext`newPosition$]; \
$CellContext`trace$103488 = \
$CellContext`UpdateTrace[$CellContext`model$103488, \
$CellContext`tracedObjects$103488, $CellContext`trace$103488]), Method -> 
        "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->
  "Out[194]=",ExpressionUUID->"623d3fb0-d596-4fd7-83e5-b3b7a86a1518"]
}, Open  ]],

Cell["\<\
To avoid having to bundle the input files with this file, I've pre-imported \
the models and included them directly in the RunModel commands.\
\>", "Text",
 CellChangeTimes->{{3.4387810114149733`*^9, 3.4387810434469337`*^9}, {
  3.438783055980522*^9, 
  3.438783066467317*^9}},ExpressionUUID->"edb6b627-b1bf-455f-abfe-\
58baa8631c13"]
}, Closed]],

Cell[CellGroupData[{

Cell["Line Segment Pentagon", "Subsection",
 CellChangeTimes->{
  3.4387813594968348`*^9, {3.438781825643661*^9, 3.4387818273045683`*^9}, {
   3.438782245538156*^9, 3.4387822480333967`*^9}, 
   3.534601855559547*^9},ExpressionUUID->"60aeed7e-784d-470d-ba39-\
081e28237a46"],

Cell["Each endpoint is constrained to lie on a line segment.", "Text",
 CellChangeTimes->{{3.438782312725662*^9, 
  3.438782334395122*^9}},ExpressionUUID->"2257bf59-a071-41f4-b6c3-\
fdb2c5d780d2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lineSegmentPentagon", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"162", ",", "147"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"254", ",", "63"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"254", ",", "63"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"162", ",", "147"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"218.859772`", ",", "95.084556`"}], "}"}], "]"}], ",", 
         "PointOnObject", ",", 
         RowBox[{"{", "0.618041`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"302", ",", "152"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"302", ",", "152"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"218.859772`", ",", "95.084556`"}], "}"}]}], "}"}], 
          "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"280.84247477856`", ",", "137.51615781088`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "0.74552`", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"238", ",", "225"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"238", ",", "225"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"280.84247477856`", ",", "137.51615781088`"}], "}"}]}], 
           "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "7"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"257.1320354344372`", ",", "185.93260304513126`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "0.553433`", "}"}], ",", 
         RowBox[{"{", "9", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"130", ",", "193"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"130", ",", "193"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"257.1320354344372`", ",", "185.93260304513126`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"11", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"200.3664374246421`", ",", "189.08825939205275`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "0.446509`", "}"}], ",", 
         RowBox[{"{", "12", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"179.285604`", ",", "131.217492`"}], "}"}], "]"}], ",", 
         "PointOnObject", ",", 
         RowBox[{"{", "0.187887`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"179.285604`", ",", "131.217492`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"200.3664374246421`", ",", "189.08825939205275`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"14", ",", "13"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"449", ",", "294"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "lineSegmentPentagon", "]"}]}], "Input",
 CellChangeTimes->{{3.438781113286737*^9, 3.438781132732469*^9}, {
   3.438781304820574*^9, 3.438781308400848*^9}, {3.438781559954962*^9, 
   3.438781563692922*^9}, {3.4387816224097853`*^9, 3.438781635255231*^9}, {
   3.438781794935876*^9, 3.438781810786272*^9}, {3.438782234130805*^9, 
   3.438782258847501*^9}, 3.438782292728421*^9},
 CellLabel->
  "In[195]:=",ExpressionUUID->"7fde3f30-e911-4aa5-9520-cb82941e6954"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$103505 = \
$CellContext`selection$103505)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$103505 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$103505 = \
$CellContext`initialModel$103505; $CellContext`selection$103505 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       DefaultBaseStyle->"Column",
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$103505], StandardForm,
             Graphics],
           ImageSizeCache->{{126.5, 305.5}, {-83.5, 85.5}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$103505, \
$CellContext`selection$103505], StandardForm, Graphics],
           
           ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
            4.503599627370496*^15, -4.503599627370496*^15}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$103505, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          294}}],
        ImageSize->{449, 294},
        PlotRange->{{0, 449}, {0, 294}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$103505 = \
($CellContext`mouseDownPosition$103505 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$103505 = \
$CellContext`model$103505; $CellContext`mouseDownHit$103505 = \
$CellContext`GetHit[$CellContext`model$103505, 
            $CellContext`hitTransform$103505[$CellContext`mouseDownPosition$\
103505]]; $CellContext`mouseDownOnSelection$103505 = 
          Intersection[$CellContext`selection$103505, \
$CellContext`mouseDownHit$103505] =!= {}; $CellContext`selection$103505 = 
          If[$CellContext`mouseDownHit$103505 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$103505, \
$CellContext`mouseDownHit$103505]]; $CellContext`firstDrag$103505 = 
          True; $CellContext`mouseDidDrag$103505 = 
          False; $CellContext`mouseDownShiftKey$103505 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$103505], \
$CellContext`mouseDownOnSelection$103505], $CellContext`selection$103505 = \
$CellContext`ToggleSelection[$CellContext`selection$103505, \
$CellContext`mouseDownHit$103505]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$103505], 
            
            Not[$CellContext`mouseDownShiftKey$103505]], \
$CellContext`selection$103505 = $CellContext`mouseDownHit$103505]; \
$CellContext`mouseDidDrag$103505 = True; $CellContext`firstDrag$103505 = 
          False; 
         With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$103505 = \
$CellContext`Drag[$CellContext`mouseDownModel$103505, \
$CellContext`selection$103505, 
              TranslationTransform[
               $CellContext`dragTransform$103505[$CellContext`mousePosition$\
103505 - $CellContext`mouseDownPosition$103505]]]; \
$CellContext`mousePosition$103505 = $CellContext`newPosition$]; \
$CellContext`trace$103505 = \
$CellContext`UpdateTrace[$CellContext`model$103505, \
$CellContext`tracedObjects$103505, $CellContext`trace$103505]), Method -> 
        "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->
  "Out[196]=",ExpressionUUID->"7d52dfb8-bdf7-44c5-8a90-ecaa97ef265d"]
}, {2}]]
}, Closed]],

Cell[CellGroupData[{

Cell["Affine Transform Chain", "Subsection",
 CellChangeTimes->{
  3.4387813594968348`*^9, {3.438781825643661*^9, 3.4387818273045683`*^9}, {
   3.438782245538156*^9, 3.4387822480333967`*^9}, {3.438782431415038*^9, 
   3.438782435837041*^9}, 
   3.534601857453163*^9},ExpressionUUID->"7e808c8d-3661-4e1c-92d6-\
83327e7c3503"],

Cell["\<\
This model is a chain of affine transforms of the leftmost line-circle-points \
motif: a translation, a rotation, a scaling, and a reflection.\
\>", "Text",
 CellChangeTimes->{{3.438782312725662*^9, 3.438782334395122*^9}, {
  3.4387825110356913`*^9, 3.438782544391594*^9}, {3.438782583313381*^9, 
  3.438782618417037*^9}},ExpressionUUID->"3011d9a8-1868-41b8-9564-\
5424f0602520"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"affineTransformChain", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"139", ",", "176"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"172", ",", "130"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"139", ",", "176"}], "}"}], ",", 
           SqrtBox["3205"]}], "]"}], ",", "CircleCenterRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"190", ",", "225"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"190", ",", "225"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"139", ",", "176"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"280.73199999999997`", ",", "176"}], "}"}], "]"}], ",", 
         "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "1", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"313.73199999999997`", ",", "130"}], "}"}], "]"}], ",", 
         "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"280.73199999999997`", ",", "176"}], "}"}], ",", 
           SqrtBox["3205"]}], "]"}], ",", "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"331.73199999999997`", ",", "225"}], "}"}], "]"}], ",", 
         "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"331.73199999999997`", ",", "225"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"280.73199999999997`", ",", "176"}], "}"}]}], "}"}], 
          "]"}], ",", "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "5", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"238.99966672242397`", ",", "315.7321799864379`"}], "}"}], 
          "]"}], ",", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.5708`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"284.9995455063452`", ",", "348.7323489536501`"}], "}"}], 
          "]"}], ",", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.5708`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"238.99966672242397`", ",", "315.7321799864379`"}], "}"}],
            ",", 
           SqrtBox["3205"]}], "]"}], ",", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.5708`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"189.99947938929427`", ",", "366.73199999904386`"}], "}"}],
           "]"}], ",", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.5708`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"189.99947938929427`", ",", "366.73199999904386`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"238.99966672242397`", ",", "315.7321799864379`"}], 
             "}"}]}], "}"}], "]"}], ",", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.5708`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"300.8212531515858`", ",", "255.2440297514193`"}], "}"}], 
          "]"}], ",", "Scaling", ",", 
         RowBox[{"{", "0.333333`", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"11", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"316.1545307462666`", ",", "266.244075073767`"}], "}"}], 
          "]"}], ",", "Scaling", ",", 
         RowBox[{"{", "0.333333`", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"300.8212531515858`", ",", "255.2440297514193`"}], "}"}], 
           ",", "18.870887602051074`"}], "]"}], ",", "Scaling", ",", 
         RowBox[{"{", "0.333333`", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"13", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"284.4878737072716`", ",", "272.2439527556813`"}], "}"}], 
          "]"}], ",", "Scaling", ",", 
         RowBox[{"{", "0.333333`", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"14", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"284.4878737072716`", ",", "272.2439527556813`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"300.8212531515858`", ",", "255.2440297514193`"}], 
             "}"}]}], "}"}], "]"}], ",", "Scaling", ",", 
         RowBox[{"{", "0.333333`", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"15", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"360.7159087021013`", ",", "192.9046943825154`"}], "}"}], 
          "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"16", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"372.32024337623767`", ",", "207.78588437726654`"}], "}"}],
           "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"17", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"360.7159087021013`", ",", "192.9046943825154`"}], "}"}], 
           ",", "18.870887602051074`"}], "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"18", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"377.0491632575668`", ",", "175.90465138700665`"}], "}"}], 
          "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"19", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"377.0491632575668`", ",", "175.90465138700665`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"360.7159087021013`", ",", "192.9046943825154`"}], 
             "}"}]}], "}"}], "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"20", ",", "10"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"620", ",", "390"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "affineTransformChain", "]"}]}], "Input",
 CellChangeTimes->{{3.438781113286737*^9, 3.438781132732469*^9}, {
   3.438781304820574*^9, 3.438781308400848*^9}, {3.438781559954962*^9, 
   3.438781563692922*^9}, {3.4387816224097853`*^9, 3.438781635255231*^9}, {
   3.438781794935876*^9, 3.438781810786272*^9}, {3.438782234130805*^9, 
   3.438782258847501*^9}, 3.438782292728421*^9, {3.4387824387884912`*^9, 
   3.438782473196824*^9}, {3.438782534081546*^9, 3.43878253569343*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"3fa1b9f9-47dd-4ef1-be31-21312f5d1f1a"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$103520 = \
$CellContext`selection$103520)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$103520 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$103520 = \
$CellContext`initialModel$103520; $CellContext`selection$103520 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       DefaultBaseStyle->"Column",
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$103520], StandardForm,
             Graphics],
           
           ImageSizeCache->{{81.38728058112736, 
            380.58679630415236`}, {-180.34489940531057`, 74.61271941887264}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$103520, \
$CellContext`selection$103520], StandardForm, Graphics],
           
           ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
            4.503599627370496*^15, -4.503599627370496*^15}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$103520, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          390}}],
        ImageSize->{620, 390},
        PlotRange->{{0, 620}, {0, 390}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$103520 = \
($CellContext`mouseDownPosition$103520 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$103520 = \
$CellContext`model$103520; $CellContext`mouseDownHit$103520 = \
$CellContext`GetHit[$CellContext`model$103520, 
            $CellContext`hitTransform$103520[$CellContext`mouseDownPosition$\
103520]]; $CellContext`mouseDownOnSelection$103520 = 
          Intersection[$CellContext`selection$103520, \
$CellContext`mouseDownHit$103520] =!= {}; $CellContext`selection$103520 = 
          If[$CellContext`mouseDownHit$103520 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$103520, \
$CellContext`mouseDownHit$103520]]; $CellContext`firstDrag$103520 = 
          True; $CellContext`mouseDidDrag$103520 = 
          False; $CellContext`mouseDownShiftKey$103520 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$103520], \
$CellContext`mouseDownOnSelection$103520], $CellContext`selection$103520 = \
$CellContext`ToggleSelection[$CellContext`selection$103520, \
$CellContext`mouseDownHit$103520]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$103520], 
            
            Not[$CellContext`mouseDownShiftKey$103520]], \
$CellContext`selection$103520 = $CellContext`mouseDownHit$103520]; \
$CellContext`mouseDidDrag$103520 = True; $CellContext`firstDrag$103520 = 
          False; With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$103520 = \
$CellContext`Drag[$CellContext`mouseDownModel$103520, \
$CellContext`selection$103520, 
              TranslationTransform[
               $CellContext`dragTransform$103520[$CellContext`mousePosition$\
103520 - $CellContext`mouseDownPosition$103520]]]; \
$CellContext`mousePosition$103520 = $CellContext`newPosition$]; \
$CellContext`trace$103520 = \
$CellContext`UpdateTrace[$CellContext`model$103520, \
$CellContext`tracedObjects$103520, $CellContext`trace$103520]), Method -> 
        "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->
  "Out[198]=",ExpressionUUID->"9b2a9dc9-e996-4418-854f-db2a6e964c1d"]
}, {2}]]
}, Closed]],

Cell[CellGroupData[{

Cell["Centroid Construction", "Subsection",
 CellChangeTimes->{
  3.438781163234713*^9, {3.438781364990996*^9, 3.438781367678492*^9}, 
   3.438781528342391*^9},ExpressionUUID->"87b9af90-7322-4a44-a91c-\
073978c2f2ef"],

Cell["\<\
Drag the centroid of the inscribed triangle.  When the centroid coincides \
with the center of the circle, the triangle is equilateral.\
\>", "Text",
 CellChangeTimes->{{3.4387813700314713`*^9, 3.438781370662834*^9}, {
  3.438781479382165*^9, 
  3.438781518305943*^9}},ExpressionUUID->"c9911aab-4b67-4723-8a79-\
1c5622f41c1c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"centroidConstruction", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"231", ",", "168"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"327", ",", "235"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"231", ",", "168"}], "}"}], ",", 
           SqrtBox["13705"]}], "]"}], ",", "CircleCenterRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"114.20541404207701`", ",", "176.0015430335241`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "3.07319`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"285.9162396056885`", ",", "64.6113805703422`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.08253`"}], "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"285.9162396056885`", ",", "64.6113805703422`"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"114.20541404207701`", ",", "176.0015430335241`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"345.169034939983`", ",", "193.89269126361603`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "0.22302`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"345.169034939983`", ",", "193.89269126361603`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"285.9162396056885`", ",", "64.6113805703422`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "5"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"200.06082682388273`", ",", "120.30646180193315`"}], "}"}],
           "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"315.54263727283575`", ",", "129.2520359169791`"}], "}"}], 
          "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "8", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"345.169034939983`", ",", "193.89269126361603`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"200.06082682388273`", ",", "120.30646180193315`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"114.20541404207701`", ",", "176.0015430335241`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"315.54263727283575`", ",", "129.2520359169791`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"248.4302295292494`", ",", "144.83520495582746`"}], "}"}], 
          "]"}], ",", "PointAtIntersection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", "11"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"345.169034939983`", ",", "193.89269126361603`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"114.20541404207701`", ",", "176.0015430335241`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"229.68722449103`", ",", "184.94711714857004`"}], "}"}], 
          "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "14", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"285.9162396056885`", ",", "64.6113805703422`"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"229.68722449103`", ",", "184.94711714857004`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "15"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"481", ",", "338"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "centroidConstruction", "]"}]}], "Input",
 CellChangeTimes->{{3.438781322833305*^9, 3.438781334906537*^9}, {
  3.4387814630497093`*^9, 3.438781466729137*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"2e94f9c1-f32f-4a40-92b3-9d46301e5c53"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$103535 = \
$CellContext`selection$103535)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$103535 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$103535 = \
$CellContext`initialModel$103535; $CellContext`selection$103535 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       DefaultBaseStyle->"Column",
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$103535], StandardForm,
             Graphics],
           
           ImageSizeCache->{{110.35955657989008`, 
            349.4142135623731}, {-119.4142135623731, 117.4142135623731}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$103535, \
$CellContext`selection$103535], StandardForm, Graphics],
           
           ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
            4.503599627370496*^15, -4.503599627370496*^15}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$103535, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          338}}],
        ImageSize->{481, 338},
        PlotRange->{{0, 481}, {0, 338}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$103535 = \
($CellContext`mouseDownPosition$103535 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$103535 = \
$CellContext`model$103535; $CellContext`mouseDownHit$103535 = \
$CellContext`GetHit[$CellContext`model$103535, 
            $CellContext`hitTransform$103535[$CellContext`mouseDownPosition$\
103535]]; $CellContext`mouseDownOnSelection$103535 = 
          Intersection[$CellContext`selection$103535, \
$CellContext`mouseDownHit$103535] =!= {}; $CellContext`selection$103535 = 
          If[$CellContext`mouseDownHit$103535 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$103535, \
$CellContext`mouseDownHit$103535]]; $CellContext`firstDrag$103535 = 
          True; $CellContext`mouseDidDrag$103535 = 
          False; $CellContext`mouseDownShiftKey$103535 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$103535], \
$CellContext`mouseDownOnSelection$103535], $CellContext`selection$103535 = \
$CellContext`ToggleSelection[$CellContext`selection$103535, \
$CellContext`mouseDownHit$103535]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$103535], 
            
            Not[$CellContext`mouseDownShiftKey$103535]], \
$CellContext`selection$103535 = $CellContext`mouseDownHit$103535]; \
$CellContext`mouseDidDrag$103535 = True; $CellContext`firstDrag$103535 = 
          False; With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$103535 = \
$CellContext`Drag[$CellContext`mouseDownModel$103535, \
$CellContext`selection$103535, 
              TranslationTransform[
               $CellContext`dragTransform$103535[$CellContext`mousePosition$\
103535 - $CellContext`mouseDownPosition$103535]]]; \
$CellContext`mousePosition$103535 = $CellContext`newPosition$]; \
$CellContext`trace$103535 = \
$CellContext`UpdateTrace[$CellContext`model$103535, \
$CellContext`tracedObjects$103535, $CellContext`trace$103535]), Method -> 
        "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->
  "Out[200]=",ExpressionUUID->"99c02920-fd82-45c4-92ca-a15501026334"]
}, {2}]]
}, Closed]],

Cell[CellGroupData[{

Cell["Parabolic Locus", "Subsection",
 CellChangeTimes->{{3.438780699603301*^9, 
  3.438780704968943*^9}},ExpressionUUID->"c53f0233-073b-4de6-aa22-\
0da8e02e64d2"],

Cell["\<\
Select the highest point, press \"Trace\".  Then drag the point at the \
intersection of the horizontal and vertical lines.  The traced point has a \
parabolic path.  Drag any other part of the construction to make other \
parabolic paths.\
\>", "Text",
 CellChangeTimes->{{3.438780298768556*^9, 3.438780339153075*^9}, {
  3.438780719294024*^9, 
  3.438780801379127*^9}},ExpressionUUID->"ba8c20c5-2956-4ca1-ab27-\
cdc055111acd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"parabolicLocusModel", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"221", ",", "318"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"476.051`", ",", "315"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"476.051`", ",", "315"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"221", ",", "318"}], "}"}]}], "}"}], "]"}], ",", 
         "LineThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"326", ",", "262"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"417.866725472`", ",", "315.684384`"}], "}"}], "]"}], ",", 
         "PointOnObject", ",", 
         RowBox[{"{", "0.771872`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"417.866725472`", ",", "315.684384`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"326", ",", "262"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"371.933362736`", ",", "288.842192`"}], "}"}], "]"}], ",", 
         "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"371.933362736`", ",", "288.842192`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"425.617746736`", ",", "196.97546652800003`"}], "}"}]}], 
           "}"}], "]"}], ",", "Perpendicular", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "7"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"417.866725472`", ",", "315.684384`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"414.866725472`", ",", "60.633384000000035`"}], "}"}]}], 
           "}"}], "]"}], ",", "Perpendicular", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "5"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"416.6509152215499`", ",", "212.31984393748394`"}], "}"}], 
          "]"}], ",", "PointAtIntersection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "8"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"689", ",", "540"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{"RunModel", "[", "parabolicLocusModel", "]"}]}], "Input",
 CellChangeTimes->{{3.438780660339003*^9, 3.4387806714200373`*^9}, 
   3.438780876415847*^9},
 CellLabel->
  "In[201]:=",ExpressionUUID->"62888c63-8b7b-46a8-be87-3da3929182d4"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$103556 = \
$CellContext`selection$103556)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$103556 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$103556 = \
$CellContext`initialModel$103556; $CellContext`selection$103556 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       DefaultBaseStyle->"Column",
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$103556], StandardForm,
             Graphics],
           
           ImageSizeCache->{{-254831.41421356238`, 
            255529.41421356238`}, {-255100.41421356238`, 
            255260.41421356238`}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$103556, \
$CellContext`selection$103556], StandardForm, Graphics],
           
           ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
            4.503599627370496*^15, -4.503599627370496*^15}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$103556, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          540}}],
        ImageSize->{689, 540},
        PlotRange->{{0, 689}, {0, 540}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$103556 = \
($CellContext`mouseDownPosition$103556 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$103556 = \
$CellContext`model$103556; $CellContext`mouseDownHit$103556 = \
$CellContext`GetHit[$CellContext`model$103556, 
            $CellContext`hitTransform$103556[$CellContext`mouseDownPosition$\
103556]]; $CellContext`mouseDownOnSelection$103556 = 
          Intersection[$CellContext`selection$103556, \
$CellContext`mouseDownHit$103556] =!= {}; $CellContext`selection$103556 = 
          If[$CellContext`mouseDownHit$103556 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$103556, \
$CellContext`mouseDownHit$103556]]; $CellContext`firstDrag$103556 = 
          True; $CellContext`mouseDidDrag$103556 = 
          False; $CellContext`mouseDownShiftKey$103556 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$103556], \
$CellContext`mouseDownOnSelection$103556], $CellContext`selection$103556 = \
$CellContext`ToggleSelection[$CellContext`selection$103556, \
$CellContext`mouseDownHit$103556]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$103556], 
            
            Not[$CellContext`mouseDownShiftKey$103556]], \
$CellContext`selection$103556 = $CellContext`mouseDownHit$103556]; \
$CellContext`mouseDidDrag$103556 = True; $CellContext`firstDrag$103556 = 
          False; With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$103556 = \
$CellContext`Drag[$CellContext`mouseDownModel$103556, \
$CellContext`selection$103556, 
              TranslationTransform[
               $CellContext`dragTransform$103556[$CellContext`mousePosition$\
103556 - $CellContext`mouseDownPosition$103556]]]; \
$CellContext`mousePosition$103556 = $CellContext`newPosition$]; \
$CellContext`trace$103556 = \
$CellContext`UpdateTrace[$CellContext`model$103556, \
$CellContext`tracedObjects$103556, $CellContext`trace$103556]), Method -> 
        "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->
  "Out[202]=",ExpressionUUID->"c2c4b0d8-637d-4696-bdc2-424ffa4e0aad"]
}, {2}]]
}, Closed]],

Cell[CellGroupData[{

Cell["Elliptical Locus", "Subsection",
 CellChangeTimes->{{3.438780699603301*^9, 3.438780704968943*^9}, {
  3.4387810965878696`*^9, 
  3.438781098248816*^9}},ExpressionUUID->"0154ba3b-bea6-4bbe-a822-\
eb234f9b57b8"],

Cell["\<\
Select the midpoint of the short line segment, press \"Trace\".  Then drag \
the point on the circle.  The traced point has an elliptical path.  Drag any \
other part of the construction to make other paths.\
\>", "Text",
 CellChangeTimes->{{3.438780298768556*^9, 3.438780339153075*^9}, {
  3.438780719294024*^9, 3.438780801379127*^9}, {3.438781177336316*^9, 
  3.438781203683172*^9}},ExpressionUUID->"37980e0d-b631-4b5b-ad25-\
591574e9f856"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ellipticalLocusModel", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"194", ",", "246"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"159", ",", "298"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"194", ",", "246"}], "}"}], ",", 
           SqrtBox["3929"]}], "]"}], ",", "CircleCenterRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"134.69134341084742`", ",", "266.285050002156`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "2.81204`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"276.42334341084745`", ",", "266.285050002156`"}], "}"}], 
          "]"}], ",", "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"330", ",", "374"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"448", ",", "206"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"448", ",", "206"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"330", ",", "374"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "6"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"449.50338157775934`", ",", "387.85317204796314`"}], "}"}],
           "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "8"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"449.50338157775934`", ",", "387.85317204796314`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"134.69134341084742`", ",", "266.285050002156`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"292.0973624943034`", ",", "327.06911102505956`"}], "}"}], 
          "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "10", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"276.42334341084745`", ",", "266.285050002156`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"292.0973624943034`", ",", "327.06911102505956`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "11"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"284.26035295257543`", ",", "296.6770805136078`"}], "}"}], 
          "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "12", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"722", ",", "610"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "ellipticalLocusModel", "]"}]}], "Input",
 CellChangeTimes->{{3.438781140125218*^9, 3.4387811468632603`*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"3e737c5e-eaab-458d-ae15-8b57fe194187"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$103582 = \
$CellContext`selection$103582)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$103582 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$103582 = \
$CellContext`initialModel$103582; $CellContext`selection$103582 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       DefaultBaseStyle->"Column",
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$103582], StandardForm,
             Graphics],
           
           ImageSizeCache->{{129.9040506607676, 
            453.41759514013245`}, {-88.76738561033625, 121.09594933923239`}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$103582, \
$CellContext`selection$103582], StandardForm, Graphics],
           
           ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
            4.503599627370496*^15, -4.503599627370496*^15}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$103582, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          610}}],
        ImageSize->{722, 610},
        PlotRange->{{0, 722}, {0, 610}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$103582 = \
($CellContext`mouseDownPosition$103582 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$103582 = \
$CellContext`model$103582; $CellContext`mouseDownHit$103582 = \
$CellContext`GetHit[$CellContext`model$103582, 
            $CellContext`hitTransform$103582[$CellContext`mouseDownPosition$\
103582]]; $CellContext`mouseDownOnSelection$103582 = 
          Intersection[$CellContext`selection$103582, \
$CellContext`mouseDownHit$103582] =!= {}; $CellContext`selection$103582 = 
          If[$CellContext`mouseDownHit$103582 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$103582, \
$CellContext`mouseDownHit$103582]]; $CellContext`firstDrag$103582 = 
          True; $CellContext`mouseDidDrag$103582 = 
          False; $CellContext`mouseDownShiftKey$103582 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$103582], \
$CellContext`mouseDownOnSelection$103582], $CellContext`selection$103582 = \
$CellContext`ToggleSelection[$CellContext`selection$103582, \
$CellContext`mouseDownHit$103582]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$103582], 
            
            Not[$CellContext`mouseDownShiftKey$103582]], \
$CellContext`selection$103582 = $CellContext`mouseDownHit$103582]; \
$CellContext`mouseDidDrag$103582 = True; $CellContext`firstDrag$103582 = 
          False; With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$103582 = \
$CellContext`Drag[$CellContext`mouseDownModel$103582, \
$CellContext`selection$103582, 
              TranslationTransform[
               $CellContext`dragTransform$103582[$CellContext`mousePosition$\
103582 - $CellContext`mouseDownPosition$103582]]]; \
$CellContext`mousePosition$103582 = $CellContext`newPosition$]; \
$CellContext`trace$103582 = \
$CellContext`UpdateTrace[$CellContext`model$103582, \
$CellContext`tracedObjects$103582, $CellContext`trace$103582]), Method -> 
        "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->
  "Out[204]=",ExpressionUUID->"7cb2f639-0cd4-4d0c-a759-ce1ede0cba9b"]
}, {2}]]
}, Closed]],

Cell[CellGroupData[{

Cell["Pantograph", "Subsection",
 CellChangeTimes->{{3.438782678582665*^9, 
  3.4387826799457283`*^9}},ExpressionUUID->"89c839df-aba0-4848-9fa5-\
d06c05c02725"],

Cell["\<\
Click the point and the center of the right circle and the point to its right \
on the horizontal line to select both points.  Press \"Trace\" to trace them. \
 Then click the background to deselect everything, and drag the point at the \
center of the right circle.  You'll see a functioning pantograph.\
\>", "Text",
 CellChangeTimes->{{3.4387829156510344`*^9, 3.438782980781434*^9}, {
  3.4387831125372753`*^9, 
  3.4387831967091312`*^9}},ExpressionUUID->"e10ae6e8-aff7-4f13-95eb-\
9e4d8a10cda7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pantograph", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"25", ",", "27"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"107.018`", ",", "28"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"107.018`", ",", "28"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"25", ",", "27"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"134", ",", "265"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"252", ",", "265"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Ray", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"252", ",", "265"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"134", ",", "265"}], "}"}]}], "}"}], "]"}], ",", 
         "RayThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"134", ",", "265"}], "}"}], ",", "82.02409599623759`"}], 
          "]"}], ",", "CircleByRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"252", ",", "265"}], "}"}], ",", "82.02409599623759`"}], 
          "]"}], ",", "CircleByRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"192.99999999999972`", ",", "208.017964901207`"}], "}"}], 
          "]"}], ",", "PointAtIntersection1", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "8"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Ray", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"192.99999999999972`", ",", "208.017964901207`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"134", ",", "265"}], "}"}]}], "}"}], "]"}], ",", 
         "RayThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"252", ",", "265"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"192.99999999999972`", ",", "208.017964901207`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"298.4961299999992`", ",", "106.13009740210819`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "2.78807`", "}"}], ",", 
         RowBox[{"{", "10", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"298.4961299999992`", ",", "106.13009740210819`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"192.99999999999972`", ",", "208.017964901207`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"353.82619851647706`", ",", "159.56772293133784`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"294.8261985164768`", ",", "102.58568783254483`"}], 
             "}"}]}], "}"}], "]"}], ",", "Parallel", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"11", ",", "12"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"249.94754596658834`", ",", "266.9822543689919`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"190.94754596658862`", ",", "323.9642894677849`"}], 
             "}"}]}], "}"}], "]"}], ",", "Parallel", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", "5"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"357.4961299999995`", ",", "163.11213250090123`"}], "}"}], 
          "]"}], ",", "PointAtIntersection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"14", ",", "15"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"462.99226`", ",", "265.`"}], "}"}], "]"}], ",", 
         "PointAtIntersection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "14"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"192.99999999999972`", ",", "208.017964901207`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"134", ",", "265"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"298.4961299999992`", ",", "106.13009740210819`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "13", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"357.4961299999995`", ",", "163.11213250090123`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"298.4961299999992`", ",", "106.13009740210819`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"16", ",", "19"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"252", ",", "265"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"357.4961299999995`", ",", "163.11213250090123`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "16"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"462.99226`", ",", "265.`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"357.4961299999995`", ",", "163.11213250090123`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"17", ",", "16"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"617", ",", "425"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "pantograph", "]"}]}], "Input",
 CellChangeTimes->{{3.438782682299424*^9, 3.438782713224702*^9}, {
  3.4387828633694344`*^9, 3.4387828870484657`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"b30b1b59-e55d-4acc-a347-eb26bc78936d"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$103598 = \
$CellContext`selection$103598)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$103598 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$103598 = \
$CellContext`initialModel$103598; $CellContext`selection$103598 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       DefaultBaseStyle->"Column",
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$103598], StandardForm,
             Graphics],
           
           ImageSizeCache->{{-58811.41421356237, 
            118253.41421356237`}, {-57097.41421356237, 57091.41421356237}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$103598, \
$CellContext`selection$103598], StandardForm, Graphics],
           
           ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
            4.503599627370496*^15, -4.503599627370496*^15}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$103598, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          425}}],
        ImageSize->{617, 425},
        PlotRange->{{0, 617}, {0, 425}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$103598 = \
($CellContext`mouseDownPosition$103598 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$103598 = \
$CellContext`model$103598; $CellContext`mouseDownHit$103598 = \
$CellContext`GetHit[$CellContext`model$103598, 
            $CellContext`hitTransform$103598[$CellContext`mouseDownPosition$\
103598]]; $CellContext`mouseDownOnSelection$103598 = 
          Intersection[$CellContext`selection$103598, \
$CellContext`mouseDownHit$103598] =!= {}; $CellContext`selection$103598 = 
          If[$CellContext`mouseDownHit$103598 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$103598, \
$CellContext`mouseDownHit$103598]]; $CellContext`firstDrag$103598 = 
          True; $CellContext`mouseDidDrag$103598 = 
          False; $CellContext`mouseDownShiftKey$103598 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$103598], \
$CellContext`mouseDownOnSelection$103598], $CellContext`selection$103598 = \
$CellContext`ToggleSelection[$CellContext`selection$103598, \
$CellContext`mouseDownHit$103598]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$103598], 
            
            Not[$CellContext`mouseDownShiftKey$103598]], \
$CellContext`selection$103598 = $CellContext`mouseDownHit$103598]; \
$CellContext`mouseDidDrag$103598 = True; $CellContext`firstDrag$103598 = 
          False; With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$103598 = \
$CellContext`Drag[$CellContext`mouseDownModel$103598, \
$CellContext`selection$103598, 
              TranslationTransform[
               $CellContext`dragTransform$103598[$CellContext`mousePosition$\
103598 - $CellContext`mouseDownPosition$103598]]]; \
$CellContext`mousePosition$103598 = $CellContext`newPosition$]; \
$CellContext`trace$103598 = \
$CellContext`UpdateTrace[$CellContext`model$103598, \
$CellContext`tracedObjects$103598, $CellContext`trace$103598]), Method -> 
        "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->
  "Out[206]=",ExpressionUUID->"f39dfcad-f632-4e08-a5db-9a9a8eed6e02"]
}, {2}]]
}, Closed]],

Cell[CellGroupData[{

Cell["Hyperbolic Trace", "Subsection",
 CellChangeTimes->{{3.438796893952669*^9, 
  3.438796898328253*^9}},ExpressionUUID->"25d5d309-cfb4-480a-99e0-\
54a4bc3236ed"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hyperbolicTrace", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"186", ",", "179"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"220", ",", "229"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"186", ",", "179"}], "}"}], ",", 
           RowBox[{"2", " ", 
            SqrtBox["914"]}]}], "]"}], ",", "CircleCenterRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"243.37122841716868`", ",", "198.09298692989282`"}], "}"}],
           "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "0.321268`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"376", ",", "173"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"376", ",", "173"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"243.37122841716868`", ",", "198.09298692989282`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"309.68561420858435`", ",", "185.54649346494642`"}], "}"}],
           "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"309.68561420858435`", ",", "185.54649346494642`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"284.59262727869157`", ",", "52.9177218821151`"}], 
             "}"}]}], "}"}], "]"}], ",", "Perpendicular", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "7"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"478", ",", "384"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "hyperbolicTrace", "]"}]}], "Input",
 CellChangeTimes->{{3.438796841249798*^9, 3.4387969056085787`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"36fed6f7-92ad-49a0-abaa-396d3fc6072c"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$103613 = \
$CellContext`selection$103613)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$103613 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$103613 = \
$CellContext`initialModel$103613; $CellContext`selection$103613 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       DefaultBaseStyle->"Column",
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$103613], StandardForm,
             Graphics],
           
           ImageSizeCache->{{-24810.414213562384`, 
            25404.414213562384`}, {-132626.41421356238`, 
            132767.41421356238`}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$103613, \
$CellContext`selection$103613], StandardForm, Graphics],
           
           ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
            4.503599627370496*^15, -4.503599627370496*^15}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$103613, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          384}}],
        ImageSize->{478, 384},
        PlotRange->{{0, 478}, {0, 384}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$103613 = \
($CellContext`mouseDownPosition$103613 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$103613 = \
$CellContext`model$103613; $CellContext`mouseDownHit$103613 = \
$CellContext`GetHit[$CellContext`model$103613, 
            $CellContext`hitTransform$103613[$CellContext`mouseDownPosition$\
103613]]; $CellContext`mouseDownOnSelection$103613 = 
          Intersection[$CellContext`selection$103613, \
$CellContext`mouseDownHit$103613] =!= {}; $CellContext`selection$103613 = 
          If[$CellContext`mouseDownHit$103613 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$103613, \
$CellContext`mouseDownHit$103613]]; $CellContext`firstDrag$103613 = 
          True; $CellContext`mouseDidDrag$103613 = 
          False; $CellContext`mouseDownShiftKey$103613 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$103613], \
$CellContext`mouseDownOnSelection$103613], $CellContext`selection$103613 = \
$CellContext`ToggleSelection[$CellContext`selection$103613, \
$CellContext`mouseDownHit$103613]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$103613], 
            
            Not[$CellContext`mouseDownShiftKey$103613]], \
$CellContext`selection$103613 = $CellContext`mouseDownHit$103613]; \
$CellContext`mouseDidDrag$103613 = True; $CellContext`firstDrag$103613 = 
          False; With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$103613 = \
$CellContext`Drag[$CellContext`mouseDownModel$103613, \
$CellContext`selection$103613, 
              TranslationTransform[
               $CellContext`dragTransform$103613[$CellContext`mousePosition$\
103613 - $CellContext`mouseDownPosition$103613]]]; \
$CellContext`mousePosition$103613 = $CellContext`newPosition$]; \
$CellContext`trace$103613 = \
$CellContext`UpdateTrace[$CellContext`model$103613, \
$CellContext`tracedObjects$103613, $CellContext`trace$103613]), Method -> 
        "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellLabel->
  "Out[208]=",ExpressionUUID->"38504799-817d-4279-a9e7-ee315b7d08cc"]
}, {2}]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Implementation", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.438018909659019*^9, 3.438018915812456*^9}, {
  3.438105967704818*^9, 3.438105968085754*^9}, {3.4381090446417017`*^9, 
  3.438109045006662*^9}, {3.43845797037278*^9, 3.438457977728137*^9}, {
  3.438604923864585*^9, 
  3.438604927381139*^9}},ExpressionUUID->"b15a324c-bf02-4089-b0c0-\
afd2184401e5"],

Cell["\<\
As a consequence of GSP's strict enforcement of constructions-only, each \
object has associated with it a single relation on other objects.  Therefore \
a constrained structure can be expressed as a list of objects, one relation \
per object.  Leaves are always points.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4380189297685347`*^9, 3.4380190789813833`*^9}, {
  3.438082899620655*^9, 
  3.4380829051634407`*^9}},ExpressionUUID->"976f21c0-8bd9-49c8-beb5-\
db3763b22acf"],

Cell[CellGroupData[{

Cell["SyntaxInformation", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.43853799340493*^9, 
  3.438538000853655*^9}},ExpressionUUID->"3e46b0a7-4343-45f6-92c4-\
58addb61c489"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "[", "LineSegment", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "___", "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438109217805357*^9, 
  3.438109240773151*^9}},ExpressionUUID->"7cb06764-13cf-490c-b669-\
658c66646774"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "[", "Ray", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "___", "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438109217805357*^9, 
  3.438109243756527*^9}},ExpressionUUID->"efa56b83-c40f-40ab-a902-\
9bf26176fe16"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "[", "LabelObjects", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "___", "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438109217805357*^9, 3.438109243756527*^9}, 
   3.438373104310891*^9},ExpressionUUID->"7354c0d4-04d0-4306-b407-\
b61e4039df19"]
}, Closed]],

Cell[CellGroupData[{

Cell["Debug Utilities", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438772837790268*^9, 
  3.4387728399541693`*^9}},ExpressionUUID->"097d0222-a793-47ff-ad98-\
4b6bc1d5ae57"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DebugPrint", "[", "x___", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"NotebookWrite", "[", 
        RowBox[{
         RowBox[{"MessagesNotebook", "[", "]"}], ",", 
         RowBox[{"ToBoxes", "[", "#", "]"}]}], "]"}], "&"}], " ", "/@", " ", 
      RowBox[{"{", "x", "}"}]}], ";", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"MessagesNotebook", "[", "]"}], ",", "\"\<\\n\>\""}], "]"}]}], 
    ")"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438772841883924*^9, 3.438772861636322*^9}, {
  3.438772905977544*^9, 3.4387729318467827`*^9}, {3.438772990184876*^9, 
  3.438773009360928*^9}},ExpressionUUID->"a474c1fa-bd3c-429d-af44-\
78694b882ffc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Model and Object Projection Functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438531982888589*^9, 
  3.4385319902873793`*^9}},ExpressionUUID->"c51b4bbc-b9d5-4c77-be85-\
f96e0ff2d7b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ObjectCache", "[", "object_", "]"}], ":=", 
  RowBox[{"object", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438531992493202*^9, 3.438532006067556*^9}, {
  3.438532454894484*^9, 
  3.438532464667429*^9}},ExpressionUUID->"087c4547-06dc-4bc8-bcab-\
d0150afcafc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintFunction", "[", "object_", "]"}], ":=", 
  RowBox[{"object", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438531992493202*^9, 
  3.438532006067556*^9}},ExpressionUUID->"fad13ae0-e9dd-49b6-ac3d-\
1d4c928502b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParameterArguments", "[", "object_", "]"}], ":=", 
  RowBox[{"object", "[", 
   RowBox[{"[", "3", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438531992493202*^9, 3.438532006067556*^9}, {
  3.438532056542345*^9, 
  3.4385321240989447`*^9}},ExpressionUUID->"8b918d46-5e29-4c55-a920-\
3b288cf7359f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ObjectArguments", "[", "object_", "]"}], ":=", 
  RowBox[{"object", "[", 
   RowBox[{"[", "4", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438531992493202*^9, 3.438532006067556*^9}, {
  3.438532056542345*^9, 
  3.43853209549907*^9}},ExpressionUUID->"bf6b886e-51a2-4859-ac09-\
f05be84f7ddb"]
}, Closed]],

Cell[CellGroupData[{

Cell["RenderModel", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438083390418531*^9, 3.438083392139024*^9}, {
  3.438537971394278*^9, 
  3.4385379727652884`*^9}},ExpressionUUID->"08332dfc-633f-4947-9567-\
f11eb49a6c1d"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "RenderModel", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4383627530995626`*^9, 
  3.4383627554268417`*^9}},ExpressionUUID->"050634fe-f372-4e85-b182-\
49d075d91466"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderModel", "[", 
   RowBox[{"model_List", ",", " ", "opts___"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "labelObjects", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"labelObjects", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"LabelObjects", "/.", 
         RowBox[{"{", "opts", "}"}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{"LabelObjects", "\[Rule]", "False"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"LineColor", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RenderObject", "[", 
           RowBox[{"#1", ",", "labelObjects", ",", "#2"}], "]"}], "&"}], ",", 
         " ", 
         RowBox[{"Select", "[", 
          RowBox[{"model", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "=!=", "Point"}], 
             ")"}], "&"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RenderObject", "[", 
           RowBox[{"#1", ",", "labelObjects", ",", "#2"}], "]"}], "&"}], ",", 
         " ", 
         RowBox[{"Select", "[", 
          RowBox[{"model", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "Point"}], 
             ")"}], "&"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438082931943461*^9, 3.4380829448283567`*^9}, {
  3.438082992728578*^9, 3.438083016877119*^9}, {3.438083942817164*^9, 
  3.438083951421555*^9}, {3.4380839898699007`*^9, 3.43808399274966*^9}, {
  3.43836047104292*^9, 3.43836048181789*^9}, {3.4383623209637403`*^9, 
  3.438362363483638*^9}, {3.4383624629197483`*^9, 3.438362498196526*^9}, {
  3.4383626020087976`*^9, 3.4383626050204763`*^9}, {3.438362783113497*^9, 
  3.4383628029016314`*^9}, {3.438543819541912*^9, 
  3.4385438741928473`*^9}},ExpressionUUID->"82104efd-80ac-42f4-8e21-\
bede00330a40"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LineColor", "[", "]"}], ":=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.0067750057221332115`", ",", "0.`", ",", "0.4`"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083907329523*^9, 3.438083911765191*^9}, {
  3.4380840592175426`*^9, 
  3.438084062872446*^9}},ExpressionUUID->"bfeac947-0808-44f7-ab96-\
c83729c0df87"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CircleColor", "[", "]"}], ":=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.1322194247348745`", ",", "0.6`", ",", "0.`"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083913541498*^9, 3.438083924235567*^9}, {
  3.438084057226754*^9, 
  3.438084065368415*^9}},ExpressionUUID->"60bccb19-4ce8-459f-bcbc-\
9e2e45c0d7c1"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "RenderObject", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438084961719989*^9, 
  3.438084967220899*^9}},ExpressionUUID->"f2b84e2d-ccaa-42fa-ab23-\
56eb945524f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Point", "[", "pt_", "]"}], ",", "___"}], "}"}], ",", 
    "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"FaceForm", "[", "Red", "]"}], ",", 
    RowBox[{"EdgeForm", "[", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Disk", "[", 
     RowBox[{"pt", ",", 
      RowBox[{"Offset", "[", 
       RowBox[{"2.5", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"labelObject", ",", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"i", ",", "14"}], "]"}], ",", 
        RowBox[{"Offset", "[", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], ",", "pt"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083019167383*^9, 3.438083057534326*^9}, {
  3.438083955728963*^9, 3.438083981127119*^9}, {3.4380840240337973`*^9, 
  3.4380840311988373`*^9}, {3.438084900369686*^9, 3.438084902477441*^9}, {
  3.4381029227616463`*^9, 3.438102925097144*^9}, {3.438105985407544*^9, 
  3.438105985838964*^9}, {3.438362390662531*^9, 3.438362393652244*^9}, {
  3.438362432009324*^9, 3.438362451011517*^9}, {3.4383625119049664`*^9, 
  3.438362564654516*^9}, {3.438362883178219*^9, 3.438362957367488*^9}, {
  3.438363098160565*^9, 
  3.438363105741858*^9}},ExpressionUUID->"f75f0efe-d8e2-4a01-84d4-\
4aac7cc51b6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LineSegment", "[", 
       RowBox[{"{", 
        RowBox[{"pt1_", ",", "pt2_"}], "}"}], "]"}], ",", "___"}], "}"}], ",",
     "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"pt1", ",", "pt2"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"labelObject", ",", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"i", ",", "14", ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pt1", "+", "pt2"}], ")"}], "/", "2"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083042605836*^9, 3.4380830650534067`*^9}, {
   3.438083099206868*^9, 3.438083106083701*^9}, {3.438084906054965*^9, 
   3.4380849080062838`*^9}, {3.438102889029818*^9, 3.438102893328597*^9}, 
   3.438106048045034*^9, 3.438362398406337*^9, {3.4383624431349163`*^9, 
   3.438362453927163*^9}, {3.4383629786886053`*^9, 3.4383630207264233`*^9}, {
   3.438363057041162*^9, 
   3.4383630732860403`*^9}},ExpressionUUID->"27aad1ae-6164-42c4-8c80-\
32fd9d6a49b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"pt1_", ",", "pt2_"}], "}"}], "]"}], ",", "___"}], "}"}], ",",
     "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", "1000"}], "}"}], ",", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pt1", " ", "+", 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"pt1", "-", "pt2"}], ")"}]}]}], ",", " ", 
       RowBox[{"pt2", "+", 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"pt2", "-", "pt1"}], ")"}]}]}]}], "}"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380830675336437`*^9, 3.438083167972753*^9}, 
   3.438083632826252*^9, {3.438084909887355*^9, 3.4380849118306932`*^9}, {
   3.438102896306999*^9, 3.438102898793536*^9}, 3.438106093590179*^9, 
   3.4383624001856613`*^9, {3.438362444016089*^9, 
   3.438362454527946*^9}},ExpressionUUID->"1f536b9e-88de-4363-b4b4-\
a8c3dc8a0237"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ray", "[", 
       RowBox[{"{", 
        RowBox[{"pt1_", ",", "pt2_"}], "}"}], "]"}], ",", "___"}], "}"}], ",",
     "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", "1000"}], "}"}], ",", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"pt2", ",", " ", 
       RowBox[{"pt1", "+", 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"pt1", "-", "pt2"}], ")"}]}]}]}], "}"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380830675336437`*^9, 3.4380832094624434`*^9}, {
   3.438084913519136*^9, 3.438084915630823*^9}, {3.4381029010019407`*^9, 
   3.438102903785225*^9}, 3.438106113668552*^9, 3.438362401377495*^9, {
   3.438362444513053*^9, 3.438362454862693*^9}, {3.438706803127452*^9, 
   3.438706811819936*^9}},ExpressionUUID->"c39fef22-3954-42ea-907d-\
d18b4bcb8dce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{"c_", ",", " ", "r_"}], "]"}], ",", "___"}], "}"}], ",", 
    "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"CircleColor", "[", "]"}], ",", 
    RowBox[{"Circle", "[", 
     RowBox[{"c", ",", "r"}], "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083218209655*^9, 3.438083237725712*^9}, {
   3.438083997846736*^9, 3.438084001517963*^9}, {3.4380849180869904`*^9, 
   3.438084920205586*^9}, {3.438102906179286*^9, 3.438102908913003*^9}, 
   3.4381061270138083`*^9, 3.438362402752002*^9, {3.438362445047752*^9, 
   3.438362455159017*^9}},ExpressionUUID->"09c2b85e-4821-40e6-b123-\
65948288cbf3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$Failed", ",", " ", "_", ",", " ", "_", ",", " ", "_"}], "}"}], 
    ",", "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43808523874478*^9, 3.4380852480851583`*^9}, {
   3.438102917760668*^9, 3.43810291855978*^9}, 3.4383624045758533`*^9, {
   3.438362445621202*^9, 3.438362455447281*^9}, {3.43869694270827*^9, 
   3.438696964425024*^9}, {3.4386970446836443`*^9, 3.438697044920106*^9}, 
   3.438697103265123*^9, {3.438712531497179*^9, 3.438712544657778*^9}, {
   3.4387126286588383`*^9, 
   3.438712629853561*^9}},ExpressionUUID->"8b1d8174-456d-468a-a7bd-\
7be786baf78f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{"x_", ",", "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<can't render \>\"", ",", " ", "x"}], "]"}], ";", 
    RowBox[{"{", "}"}]}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43808523874478*^9, 3.4380852480851583`*^9}, {
   3.438102917760668*^9, 3.43810291855978*^9}, 3.4383624045758533`*^9, {
   3.438362445621202*^9, 3.438362455447281*^9}, {3.43869694270827*^9, 
   3.438696964425024*^9}, {3.4386970446836443`*^9, 3.438697044920106*^9}, 
   3.438697103265123*^9},ExpressionUUID->"3d58ab1f-181b-4baf-a476-\
0b4436abf270"]
}, Closed]],

Cell[CellGroupData[{

Cell["DrawConstraintGraph", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438086748650729*^9, 3.438086751315278*^9}, 
   3.438538035060328*^9},ExpressionUUID->"b0531fdd-6932-4834-8c34-\
1becb308a11a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DrawConstraintGraph", "[", "model_", "]"}], ":=", 
  RowBox[{"LayeredGraphPlot", "[", 
   RowBox[{
    RowBox[{"ToConstraintGraph", "[", "model", "]"}], ",", 
    RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4381093681965322`*^9, 3.4381093834253073`*^9}, {
  3.43810943550134*^9, 
  3.4381094359293013`*^9}},ExpressionUUID->"b5af88d8-080f-43e6-9e2d-\
a179de12e93b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToConstraintGraph", "[", "model_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "VertexLabel", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"VertexLabel", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\< (\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Head", "[", 
         RowBox[{"ObjectCache", "[", 
          RowBox[{"model", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], "<>", 
       "\"\<)\>\"", "<>", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ConstraintFunction", "[", 
           RowBox[{"model", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "===", "Null"}], ",", 
         "\"\<\>\"", ",", 
         RowBox[{"\"\<\\n\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"ConstraintFunction", "[", 
            RowBox[{"model", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}]}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"VertexLabel", "[", "i", "]"}], "->", 
             RowBox[{"VertexLabel", "[", "#", "]"}]}], "&"}], " ", "/@", " ", 
           RowBox[{"ObjectArguments", "[", 
            RowBox[{"model", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "model", "]"}]}], "}"}]}], "]"}], ",", 
       "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380857091301622`*^9, 3.438085721844913*^9}, {
   3.438085770032125*^9, 3.438085816461973*^9}, {3.438085884104425*^9, 
   3.438085920910079*^9}, 3.438085968493471*^9, {3.4380860460425463`*^9, 
   3.438086090783574*^9}, {3.43808612543486*^9, 3.4380861255756407`*^9}, {
   3.4380861570483437`*^9, 3.438086176615988*^9}, 3.4380862094475822`*^9, {
   3.438086305674684*^9, 3.4380863472241583`*^9}, {3.438086389853154*^9, 
   3.438086401096963*^9}, {3.438086772010807*^9, 3.438086787495275*^9}, {
   3.43808704080932*^9, 3.438087042913713*^9}, 3.438087080701858*^9, {
   3.438087143765677*^9, 3.4380872002165003`*^9}, {3.438102993378148*^9, 
   3.438103012052706*^9}, {3.438106166310463*^9, 3.438106181660595*^9}, {
   3.4383451692887383`*^9, 3.438345209219219*^9}, {3.438345262423024*^9, 
   3.438345302105421*^9}, {3.438532170299592*^9, 3.438532180499082*^9}, {
   3.438532248201169*^9, 3.438532253901506*^9}, {3.438532488333029*^9, 
   3.438532498720368*^9}},ExpressionUUID->"11b63568-c99d-46cb-b528-\
0db79929b464"]
}, Closed]],

Cell[CellGroupData[{

Cell["DrawIndexGraph", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438086748650729*^9, 3.438086751315278*^9}, {
   3.4381092709335337`*^9, 3.438109271518366*^9}, 
   3.438538040435007*^9},ExpressionUUID->"baadf379-d627-404f-9547-\
0cd51f7d26ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DrawIndexGraph", "[", "model_", "]"}], ":=", 
  RowBox[{"LayeredGraphPlot", "[", 
   RowBox[{
    RowBox[{"ToIndexGraph", "[", "model", "]"}], ",", 
    RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4381093681965322`*^9, 
  3.438109440401617*^9}},ExpressionUUID->"ef7c7bb8-82a4-4f10-801b-\
9d2ff7a52df0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToIndexGraph", "[", "model_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "VertexLabel", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"VertexLabel", "[", "i_", "]"}], ":=", "i"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"i", "->", 
           RowBox[{"ObjectArguments", "[", 
            RowBox[{"model", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "model", "]"}]}], "}"}]}], "]"}], ",", 
       "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380857091301622`*^9, 3.438085721844913*^9}, {
   3.438085770032125*^9, 3.438085816461973*^9}, {3.438085884104425*^9, 
   3.438085920910079*^9}, 3.438085968493471*^9, {3.4380860460425463`*^9, 
   3.438086090783574*^9}, {3.43808612543486*^9, 3.4380861255756407`*^9}, {
   3.4380861570483437`*^9, 3.438086176615988*^9}, 3.4380862094475822`*^9, {
   3.438086305674684*^9, 3.4380863472241583`*^9}, {3.438086389853154*^9, 
   3.438086401096963*^9}, {3.438086772010807*^9, 3.438086787495275*^9}, {
   3.43808704080932*^9, 3.438087042913713*^9}, 3.438087080701858*^9, {
   3.438087143765677*^9, 3.4380872002165003`*^9}, {3.438102993378148*^9, 
   3.438103012052706*^9}, {3.438106166310463*^9, 3.438106181660595*^9}, {
   3.438109273772092*^9, 3.43810928383263*^9}, {3.438109401987691*^9, 
   3.4381094172533827`*^9}, 
   3.438532259235633*^9},ExpressionUUID->"21668f78-58c2-4ffd-9c0b-\
0e175e5d8dba"]
}, Closed]],

Cell[CellGroupData[{

Cell["PrettyPrintModel", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{
  3.438533434630862*^9},ExpressionUUID->"e61045dd-eab7-4de7-bcc4-\
248e73542f5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PrettyPrintModel", "[", "model_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", "=", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"#", ",", 
           RowBox[{"i", "++"}]}], "]"}], "&"}], " ", "/@", " ", "model"}], 
       ",", 
       RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
       RowBox[{"Dividers", "\[Rule]", "Automatic"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438533312285843*^9, 3.438533411461409*^9}, 
   3.438533442978717*^9},ExpressionUUID->"e4b58f00-a7b1-4144-ae9a-\
b56c2c0eba86"]
}, Closed]],

Cell[CellGroupData[{

Cell["LeafIndices", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4384368631821957`*^9, 
  3.4384368647518806`*^9}},ExpressionUUID->"a602d4fc-5865-4529-993f-\
852c964c3255"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LeafIndices", "[", "model_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"First", " ", "/@", " ", 
   RowBox[{"Position", "[", 
    RowBox[{"model", ",", " ", 
     RowBox[{"{", 
      RowBox[{"_", ",", "Null", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", "1"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438436873074225*^9, 
  3.438436878996484*^9}},ExpressionUUID->"186969a9-196a-413f-a9fb-\
8b55ba9594f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["construct", "Subsection",
 InitializationCell->
  True,ExpressionUUID->"870daa9f-0855-4409-8c67-c8e3720b5eb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"construct", "[", "model_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Resatisfy", "[", 
   RowBox[{"model", ",", " ", 
    RowBox[{"LeafIndices", "[", "model", "]"}]}], "]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"75fedcbd-5b15-484e-b96e-c636566d1242"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constraints", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4381052573045473`*^9, 
  3.4381052585757217`*^9}},ExpressionUUID->"612bf9e9-ac9c-437b-9d10-\
485f809714f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CircleCenterRadius", "[", 
   RowBox[{
    RowBox[{"Point", "[", "c_", "]"}], ",", 
    RowBox[{"Point", "[", "r_", "]"}]}], "]"}], ":=", 
  RowBox[{"Circle", "[", 
   RowBox[{"c", ",", 
    RowBox[{"Norm", "[", 
     RowBox[{"r", "-", "c"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090283488566*^9, 3.438090302510235*^9}, {
  3.4380919818185596`*^9, 3.438091991159019*^9}, {3.4381053962053757`*^9, 
  3.4381054026806393`*^9}, {3.438105438430071*^9, 3.4381054471047583`*^9}, {
  3.438105993946743*^9, 3.438105995436957*^9}, {3.438344175764976*^9, 
  3.438344178977532*^9}, {3.4384344973570023`*^9, 3.4384344992901783`*^9}, {
  3.438435711885648*^9, 
  3.4384357386682863`*^9}},ExpressionUUID->"506eafba-4916-423f-aa0b-\
23b43817f07f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CircleByRadius", "[", 
   RowBox[{
    RowBox[{"Point", "[", "c_", "]"}], ",", 
    RowBox[{"LineSegment", "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Circle", "[", 
   RowBox[{"c", ",", 
    RowBox[{"Norm", "[", 
     RowBox[{"p2", "-", "p1"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090283488566*^9, 3.438090302510235*^9}, {
  3.4380919818185596`*^9, 3.438091991159019*^9}, {3.4381053962053757`*^9, 
  3.4381054026806393`*^9}, {3.438105438430071*^9, 3.4381054471047583`*^9}, {
  3.438105993946743*^9, 3.438105995436957*^9}, {3.438344175764976*^9, 
  3.438344178977532*^9}, {3.4384344973570023`*^9, 3.4384344992901783`*^9}, {
  3.438435711885648*^9, 3.4384357386682863`*^9}, {3.438695701129149*^9, 
  3.438695726040936*^9}},ExpressionUUID->"019a646e-69a8-4280-91e7-\
fd586f3e42ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "CircleByRadius", "]"}], ":=", 
  RowBox[{"{", "2", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 
  3.438717208165916*^9}},ExpressionUUID->"906f8468-ef93-4c5f-b108-\
260f11d96eff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointOnObject", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", "r_"}], "]"}], ",", "a_"}], "]"}], ":=", 
  RowBox[{"Point", "[", 
   RowBox[{"c", "+", 
    RowBox[{"r", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "a", "]"}], ",", 
       RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090322736787*^9, 3.43809032590158*^9}, {
   3.4380906046390657`*^9, 3.4380906618780403`*^9}, {3.4380906985946712`*^9, 
   3.438090770348379*^9}, {3.438092006258031*^9, 3.438092014327174*^9}, {
   3.438092130268738*^9, 3.438092132415217*^9}, 3.438106129245789*^9, {
   3.438344181730592*^9, 3.438344185065558*^9}, {3.438434501594719*^9, 
   3.438434503346094*^9}, {3.4384357131546087`*^9, 3.438435740641636*^9}, {
   3.4385314433358088`*^9, 3.4385314457134666`*^9}, {3.4385316590474377`*^9, 
   3.438531662019321*^9}, {3.4386185069437523`*^9, 3.438618508908032*^9}, {
   3.438688652203985*^9, 3.438688654193203*^9}, {3.438688748308526*^9, 
   3.4386887500812197`*^9}, {3.4386893620604773`*^9, 3.43868939456242*^9}, 
   3.438689795001113*^9, {3.4386905294153767`*^9, 3.438690540752809*^9}, {
   3.438690653592551*^9, 3.438690659244639*^9}, 
   3.438691568642468*^9},ExpressionUUID->"762f875d-c85c-4565-a0e1-\
9cb8fe3d6976"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LineThroughPoints", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p1_", "]"}], ",", 
    RowBox[{"Point", "[", "p2_", "]"}]}], "]"}], ":=", 
  RowBox[{"Line", "[", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090799841749*^9, 3.4380908291748238`*^9}, {
  3.438103498147629*^9, 3.438103507577651*^9}, {3.43810599697622*^9, 
  3.438105998043755*^9}, {3.4383441938346863`*^9, 3.4383441961048603`*^9}, {
  3.438434506162348*^9, 3.438434507657571*^9}, {3.438435715433539*^9, 
  3.438435742177422*^9}},ExpressionUUID->"f4f691fc-fb4a-4852-953a-\
311b0167f245"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LineSegmentThroughPoints", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p1_", "]"}], ",", 
    RowBox[{"Point", "[", "p2_", "]"}]}], "]"}], ":=", 
  RowBox[{"LineSegment", "[", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090799841749*^9, 3.4380908291748238`*^9}, {
  3.438103498147629*^9, 3.438103507577651*^9}, {3.43810599697622*^9, 
  3.438105998043755*^9}, {3.4383441938346863`*^9, 3.438344210897807*^9}, {
  3.43843450965022*^9, 3.4384345113135977`*^9}, {3.438435721842711*^9, 
  3.438435744018032*^9}},ExpressionUUID->"4f1e57ce-03e7-47e5-9146-\
76d01e9aa521"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RayThroughPoints", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p1_", "]"}], ",", 
    RowBox[{"Point", "[", "p2_", "]"}]}], "]"}], ":=", 
  RowBox[{"Ray", "[", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090799841749*^9, 3.4380908291748238`*^9}, {
  3.438103498147629*^9, 3.438103507577651*^9}, {3.43810599697622*^9, 
  3.438105998043755*^9}, {3.4383441938346863`*^9, 3.438344221146179*^9}, {
  3.438434513666067*^9, 3.438434515104746*^9}, {3.438435725357511*^9, 
  3.438435745873458*^9}},ExpressionUUID->"07dbc183-3ee8-4baa-a900-\
89076d6d09f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", "Midpoint", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.458557738801639*^9, 
  3.458557765263216*^9}},ExpressionUUID->"ebdf9603-ae70-4f19-86e8-\
52110cff458c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Midpoint", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p1_", "]"}], ",", 
    RowBox[{"Point", "[", "p2_", "]"}]}], "]"}], ":=", 
  RowBox[{"Point", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p1", "+", "p2"}], ")"}], "/", "2"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380908978602123`*^9, 3.438090940430127*^9}, {
  3.4381036826202*^9, 3.438103685128295*^9}, {3.438103760216571*^9, 
  3.438103764378023*^9}, {3.438103835396172*^9, 3.43810383706501*^9}, {
  3.438105999317615*^9, 3.4381059999822474`*^9}, {3.438344229375052*^9, 
  3.438344234337702*^9}, {3.438434517169834*^9, 3.438434518617797*^9}, {
  3.438435726781746*^9, 
  3.438435747313993*^9}},ExpressionUUID->"618d495f-0a28-4b71-b69b-\
21cb7c3cf05c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Midpoint", "[", 
   RowBox[{"LineSegment", "[", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], "]"}], ":=", 
  RowBox[{"Point", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p1", "+", "p2"}], ")"}], "/", "2"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380908978602123`*^9, 3.438090940430127*^9}, {
   3.4381036826202*^9, 3.438103685128295*^9}, {3.438103760216571*^9, 
   3.438103809240643*^9}, {3.4381038397857237`*^9, 3.438103841704974*^9}, 
   3.4381060510024853`*^9, {3.438344237530786*^9, 3.4383442397380333`*^9}, {
   3.438434520682266*^9, 3.438434522177658*^9}, {3.438435727492681*^9, 
   3.438435749313114*^9}, {3.43869624595479*^9, 
   3.438696268803076*^9}},ExpressionUUID->"157bcc7a-1c89-476d-9f63-\
26058f5935ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "Midpoint", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4585577456664457`*^9, 
  3.458557767187742*^9}},ExpressionUUID->"6d71b993-210c-4214-9548-\
839b398d8de7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Parallel", "[", 
   RowBox[{
    RowBox[{"line", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}], "[", 
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], ",", 
    RowBox[{"point", ":", 
     RowBox[{"Point", "[", "p0_", "]"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", 
      RowBox[{"p0", "-", 
       RowBox[{
        RowBox[{"ProjectPoint", "[", 
         RowBox[{"point", ",", " ", "line"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", "+", "v"}], ",", 
       RowBox[{"p2", "+", "v"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380908978602123`*^9, 3.438090940430127*^9}, {
   3.4381036826202*^9, 3.438103685128295*^9}, {3.438103760216571*^9, 
   3.438103809240643*^9}, {3.4381038397857237`*^9, 3.438103841704974*^9}, 
   3.4381060510024853`*^9, {3.438344237530786*^9, 3.4383442397380333`*^9}, {
   3.438434520682266*^9, 3.438434522177658*^9}, {3.438435727492681*^9, 
   3.438435749313114*^9}, {3.438696219897235*^9, 3.4386962320632067`*^9}, {
   3.4386962718918953`*^9, 3.4386962767477283`*^9}, {3.438696311916209*^9, 
   3.438696368919881*^9}, {3.4386965220842333`*^9, 
   3.438696679257002*^9}},ExpressionUUID->"d1d3b90d-fbef-4d65-bae3-\
c894db7c19e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "Parallel", "]"}], ":=", 
  RowBox[{"{", "1", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}, {
  3.4387172631559067`*^9, 
  3.43871727070444*^9}},ExpressionUUID->"6286b7f6-9597-4868-af6b-\
e44ce0d88ae9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Perpendicular", "[", 
   RowBox[{
    RowBox[{"line", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}], "[", 
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], ",", 
    RowBox[{"point", ":", 
     RowBox[{"Point", "[", "p0_", "]"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Line", "[", 
   RowBox[{"{", 
    RowBox[{"p0", ",", " ", 
     RowBox[{"p0", "+", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], " ", 
       RowBox[{"Reverse", "[", 
        RowBox[{"p2", "-", "p1"}], "]"}]}]}]}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380908978602123`*^9, 3.438090940430127*^9}, {
   3.4381036826202*^9, 3.438103685128295*^9}, {3.438103760216571*^9, 
   3.438103809240643*^9}, {3.4381038397857237`*^9, 3.438103841704974*^9}, 
   3.4381060510024853`*^9, {3.438344237530786*^9, 3.4383442397380333`*^9}, {
   3.438434520682266*^9, 3.438434522177658*^9}, {3.438435727492681*^9, 
   3.438435749313114*^9}, {3.438696219897235*^9, 3.4386962320632067`*^9}, {
   3.4386962718918953`*^9, 3.4386962767477283`*^9}, {3.438696311916209*^9, 
   3.438696368919881*^9}, {3.4386965220842333`*^9, 3.438696679257002*^9}, {
   3.438709398677662*^9, 3.438709400433139*^9}, {3.4387094699118156`*^9, 
   3.438709477512945*^9}, {3.4387095390292463`*^9, 3.438709548073902*^9}, {
   3.4387096106518097`*^9, 3.438709613910988*^9}, {3.438709655412723*^9, 
   3.43870965765736*^9}, {3.438709754070725*^9, 3.4387097626742363`*^9}, {
   3.438711080387611*^9, 3.4387110855160007`*^9}, {3.438711661920292*^9, 
   3.438711675381195*^9}},ExpressionUUID->"38e49dff-3dec-405e-9bcb-\
299e34eee9c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "Perpendicular", "]"}], ":=", 
  RowBox[{"{", "1", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}, {
  3.4387172631559067`*^9, 
  3.438717279859502*^9}},ExpressionUUID->"ed1cd812-63ba-4d05-9d85-\
fc74393c8ad9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointOnObject", "[", 
   RowBox[{
    RowBox[{"LineSegment", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}], ",", " ", 
    "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{"p2", "+", " ", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"t", ",", "1"}], "]"}], ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"p1", "-", "p2"}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438344591112109*^9, 3.438344713012328*^9}, {
   3.43834474368999*^9, 3.4383447476970043`*^9}, {3.438434542756167*^9, 
   3.438434544867216*^9}, {3.4385246040247993`*^9, 3.43852460555048*^9}, 
   3.438531452840191*^9, {3.438531667229896*^9, 3.438531671509264*^9}, {
   3.43870749831164*^9, 
   3.4387075083012753`*^9}},ExpressionUUID->"98d3b5a5-d3ea-44bb-881e-\
3a3b8b485653"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointOnObject", "[", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}], ",", " ", 
    "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{"p2", "+", " ", 
    RowBox[{"t", 
     RowBox[{"(", 
      RowBox[{"p1", "-", "p2"}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438344591112109*^9, 3.438344713012328*^9}, {
   3.43834474368999*^9, 3.4383447476970043`*^9}, {3.438434542756167*^9, 
   3.438434544867216*^9}, {3.4385246040247993`*^9, 3.43852460555048*^9}, 
   3.438531452840191*^9, {3.438531667229896*^9, 3.438531671509264*^9}, {
   3.438697156852768*^9, 3.438697167953197*^9}, {3.438707511229601*^9, 
   3.4387075159733152`*^9}},ExpressionUUID->"187586ab-e1ed-42a0-b8b3-\
b5cf6ade9c67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointOnObject", "[", 
   RowBox[{
    RowBox[{"Ray", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}], ",", " ", 
    "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{"p2", " ", "+", " ", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"t", ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"p1", "-", "p2"}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438344591112109*^9, 3.438344713012328*^9}, {
   3.43834474368999*^9, 3.4383447476970043`*^9}, {3.438434542756167*^9, 
   3.438434544867216*^9}, {3.4385246040247993`*^9, 3.43852460555048*^9}, 
   3.438531452840191*^9, {3.438531667229896*^9, 3.438531671509264*^9}, {
   3.438697159538978*^9, 3.43869717730517*^9}, {3.438707038231195*^9, 
   3.4387070503965673`*^9}, {3.438707208645316*^9, 
   3.438707224084371*^9}},ExpressionUUID->"a8f04fa7-7986-4342-86dd-\
6c22742610f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointAtIntersection", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"h1", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"h2", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p3", ":", 
        RowBox[{"{", 
         RowBox[{"x3_", ",", "y3_"}], "}"}]}], ",", 
       RowBox[{"p4", ":", 
        RowBox[{"{", 
         RowBox[{"x4_", ",", "y4_"}], "}"}]}]}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "x2"}], " ", "y1"}], "+", 
          RowBox[{"x3", " ", "y1"}], "+", 
          RowBox[{"x1", " ", "y2"}], "-", 
          RowBox[{"x3", " ", "y2"}], "-", 
          RowBox[{"x1", " ", "y3"}], "+", 
          RowBox[{"x2", " ", "y3"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "x3"}], " ", "y1"}], "+", 
          RowBox[{"x4", " ", "y1"}], "+", 
          RowBox[{"x3", " ", "y2"}], "-", 
          RowBox[{"x4", " ", "y2"}], "+", 
          RowBox[{"x1", " ", "y3"}], "-", 
          RowBox[{"x2", " ", "y3"}], "-", 
          RowBox[{"x1", " ", "y4"}], "+", 
          RowBox[{"x2", " ", "y4"}]}]]}]}], ",", 
      RowBox[{"r", "=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "x3"}], " ", "y1"}], "+", 
          RowBox[{"x4", " ", "y1"}], "+", 
          RowBox[{"x1", " ", "y3"}], "-", 
          RowBox[{"x4", " ", "y3"}], "-", 
          RowBox[{"x1", " ", "y4"}], "+", 
          RowBox[{"x3", " ", "y4"}]}], 
         RowBox[{
          RowBox[{"x3", " ", "y1"}], "-", 
          RowBox[{"x4", " ", "y1"}], "-", 
          RowBox[{"x3", " ", "y2"}], "+", 
          RowBox[{"x4", " ", "y2"}], "-", 
          RowBox[{"x1", " ", "y3"}], "+", 
          RowBox[{"x2", " ", "y3"}], "+", 
          RowBox[{"x1", " ", "y4"}], "-", 
          RowBox[{"x2", " ", "y4"}]}]]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h1", "===", "LineSegment"}], " ", "&&", " ", 
           RowBox[{"0", "\[LessEqual]", "r", "\[LessEqual]", "1"}]}], ")"}], 
         " ", "||", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h1", "===", "Ray"}], " ", "&&", " ", 
           RowBox[{"r", "\[LessEqual]", "1"}]}], ")"}], " ", "||", " ", 
         RowBox[{"h1", "===", "Line"}]}], ")"}], " ", "&&", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h2", "===", "LineSegment"}], " ", "&&", " ", 
           RowBox[{"0", "\[LessEqual]", "s", "\[LessEqual]", "1"}]}], ")"}], 
         " ", "||", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h2", "===", "Ray"}], " ", "&&", " ", 
           RowBox[{"s", "\[LessEqual]", "1"}]}], ")"}], " ", "||", " ", 
         RowBox[{"h2", "===", "Line"}]}], ")"}]}], ",", 
      RowBox[{"Point", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "x3"}], " ", "y1"}], "+", 
               RowBox[{"x4", " ", "y1"}], "+", 
               RowBox[{"x1", " ", "y3"}], "-", 
               RowBox[{"x4", " ", "y3"}], "-", 
               RowBox[{"x1", " ", "y4"}], "+", 
               RowBox[{"x3", " ", "y4"}]}], ")"}]}], 
            RowBox[{
             RowBox[{"x3", " ", "y1"}], "-", 
             RowBox[{"x4", " ", "y1"}], "-", 
             RowBox[{"x3", " ", "y2"}], "+", 
             RowBox[{"x4", " ", "y2"}], "-", 
             RowBox[{"x1", " ", "y3"}], "+", 
             RowBox[{"x2", " ", "y3"}], "+", 
             RowBox[{"x1", " ", "y4"}], "-", 
             RowBox[{"x2", " ", "y4"}]}]]}], ",", 
          RowBox[{"y1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "x3"}], " ", "y1"}], "+", 
               RowBox[{"x4", " ", "y1"}], "+", 
               RowBox[{"x1", " ", "y3"}], "-", 
               RowBox[{"x4", " ", "y3"}], "-", 
               RowBox[{"x1", " ", "y4"}], "+", 
               RowBox[{"x3", " ", "y4"}]}], ")"}]}], 
            RowBox[{
             RowBox[{"x3", " ", "y1"}], "-", 
             RowBox[{"x4", " ", "y1"}], "-", 
             RowBox[{"x3", " ", "y2"}], "+", 
             RowBox[{"x4", " ", "y2"}], "-", 
             RowBox[{"x1", " ", "y3"}], "+", 
             RowBox[{"x2", " ", "y3"}], "+", 
             RowBox[{"x1", " ", "y4"}], "-", 
             RowBox[{"x2", " ", "y4"}]}]]}]}], "}"}], "//", "N"}], "]"}], ",",
       "$Failed"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090949289904*^9, 3.438090971680419*^9}, {
   3.438103968569306*^9, 3.438103995584474*^9}, {3.438104211420615*^9, 
   3.438104338763379*^9}, {3.438104409765685*^9, 3.4381044124262257`*^9}, {
   3.438104446833692*^9, 3.438104450186722*^9}, {3.438106053352564*^9, 
   3.438106067586561*^9}, 3.438106200263122*^9, {3.4383442604574213`*^9, 
   3.4383442648125763`*^9}, {3.438434529844927*^9, 3.43843453492624*^9}, {
   3.438434669114737*^9, 3.4384346787862377`*^9}, {3.438435484048012*^9, 
   3.4384354938081303`*^9}, {3.438435807008772*^9, 3.438435821910182*^9}, {
   3.43870830087254*^9, 3.438708360355076*^9}, {3.438708416499084*^9, 
   3.438708537025853*^9}, {3.4387087123986807`*^9, 3.438708717224864*^9}, {
   3.438708775957781*^9, 3.43870878557941*^9}, {3.438708834063686*^9, 
   3.438708840996058*^9}},ExpressionUUID->"1cdfe4bc-ce5e-48db-9c36-\
11efeee9e95c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointAtIntersection1", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"c1", ":", 
       RowBox[{"{", 
        RowBox[{"c1x_", ",", "c1y_"}], "}"}]}], ",", "r1_"}], "]"}], ",", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"c2", ":", 
       RowBox[{"{", 
        RowBox[{"c2x_", ",", "c2y_"}], "}"}]}], ",", "r2_"}], "]"}]}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"root", "=", 
      RowBox[{"N", "[", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"c1x", "-", "c2x"}], ")"}], "2"]}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["c1x", "4"], "+", 
            SuperscriptBox["c1y", "4"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["c1x", "3"], " ", "c2x"}], "+", 
            SuperscriptBox["c2x", "4"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["c1y", "3"], " ", "c2y"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["c2y", "2"]}], "+", 
            SuperscriptBox["c2y", "4"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["r1", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2y", "2"], " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["r1", "4"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2y", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "+", 
            SuperscriptBox["r2", "4"], "-", 
            RowBox[{"4", " ", "c1y", " ", "c2y", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c2x", "2"], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "-", 
            RowBox[{"4", " ", "c1x", " ", "c2x", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1y", "2"], "+", 
               SuperscriptBox["c2x", "2"], "-", 
               RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c1x", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1y", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["c2x", "2"]}], "-", 
               RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c1y", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c2x", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}]}], ")"}]}], ")"}]}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "root", "]"}], "===", "Complex"}], ",", "$Failed",
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1x", "4"], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["c1y", "2"]}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["c1x", "3"], " ", "c2x"}], "-", 
               RowBox[{
                SuperscriptBox["c1y", "2"], " ", 
                SuperscriptBox["c2x", "2"]}], "+", 
               RowBox[{"2", " ", "c1x", " ", 
                SuperscriptBox["c2x", "3"]}], "-", 
               SuperscriptBox["c2x", "4"], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["c1x", "2"], " ", "c1y", " ", "c2y"}], "+", 
               RowBox[{"2", " ", "c1y", " ", 
                SuperscriptBox["c2x", "2"], " ", "c2y"}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", 
                SuperscriptBox["r1", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["r2", "2"]}], "-", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", 
                SuperscriptBox["r2", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["r2", "2"]}], "+", 
               RowBox[{"c1y", " ", "root"}], "-", 
               RowBox[{"c2y", " ", "root"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"c1x", "-", "c2x"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["c1x", "2"], "+", 
                 SuperscriptBox["c1y", "2"], "-", 
                 RowBox[{"2", " ", "c1x", " ", "c2x"}], "+", 
                 SuperscriptBox["c2x", "2"], "-", 
                 RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
                 SuperscriptBox["c2y", "2"]}], ")"}]}], ")"}]}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", "c1y"}], "+", 
               SuperscriptBox["c1y", "3"], "-", 
               RowBox[{"2", " ", "c1x", " ", "c1y", " ", "c2x"}], "+", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["c2x", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", "c2y"}], "-", 
               RowBox[{
                SuperscriptBox["c1y", "2"], " ", "c2y"}], "-", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", "c2y"}], "+", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", "c2y"}], "-", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["c2y", "2"]}], "+", 
               SuperscriptBox["c2y", "3"], "-", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"c2y", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["r2", "2"]}], "-", 
               RowBox[{"c2y", " ", 
                SuperscriptBox["r2", "2"]}], "-", "root"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["c1x", "2"], "+", 
                 SuperscriptBox["c1y", "2"], "-", 
                 RowBox[{"2", " ", "c1x", " ", "c2x"}], "+", 
                 SuperscriptBox["c2x", "2"], "-", 
                 RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
                 SuperscriptBox["c2y", "2"]}], ")"}]}], ")"}]}]}]}], "}"}]}], 
        "]"}], "//", "N"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43843472370999*^9, 3.43843475348237*^9}, {
  3.438434886443983*^9, 3.438434900978075*^9}, {3.43843495222731*^9, 
  3.438435026066283*^9}, {3.438435070431456*^9, 3.438435085129595*^9}, {
  3.438435168707837*^9, 3.438435318309105*^9}, {3.4384353528468847`*^9, 
  3.43843545006945*^9}, {3.438435860382575*^9, 3.438435865929481*^9}, {
  3.438435896592725*^9, 3.4384359286706123`*^9}, {3.438435963522635*^9, 
  3.438435963986064*^9}, {3.4386958055963*^9, 3.4386958151462793`*^9}, {
  3.438711966336549*^9, 3.438711966461096*^9}, {3.4387789299821777`*^9, 
  3.438778930166333*^9}},ExpressionUUID->"b245eaf2-de59-4197-8a98-\
5d6ab053e6c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointAtIntersection2", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"c1", ":", 
       RowBox[{"{", 
        RowBox[{"c1x_", ",", "c1y_"}], "}"}]}], ",", "r1_"}], "]"}], ",", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"c2", ":", 
       RowBox[{"{", 
        RowBox[{"c2x_", ",", "c2y_"}], "}"}]}], ",", "r2_"}], "]"}]}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"root", "=", 
      RowBox[{"N", "[", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"c1x", "-", "c2x"}], ")"}], "2"]}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["c1x", "4"], "+", 
            SuperscriptBox["c1y", "4"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["c1x", "3"], " ", "c2x"}], "+", 
            SuperscriptBox["c2x", "4"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["c1y", "3"], " ", "c2y"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["c2y", "2"]}], "+", 
            SuperscriptBox["c2y", "4"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["r1", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2y", "2"], " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["r1", "4"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2y", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "+", 
            SuperscriptBox["r2", "4"], "-", 
            RowBox[{"4", " ", "c1y", " ", "c2y", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c2x", "2"], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "-", 
            RowBox[{"4", " ", "c1x", " ", "c2x", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1y", "2"], "+", 
               SuperscriptBox["c2x", "2"], "-", 
               RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c1x", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1y", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["c2x", "2"]}], "-", 
               RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c1y", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c2x", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}]}], ")"}]}], ")"}]}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "root", "]"}], "===", "Complex"}], ",", "$Failed",
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1x", "4"], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["c1y", "2"]}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["c1x", "3"], " ", "c2x"}], "-", 
               RowBox[{
                SuperscriptBox["c1y", "2"], " ", 
                SuperscriptBox["c2x", "2"]}], "+", 
               RowBox[{"2", " ", "c1x", " ", 
                SuperscriptBox["c2x", "3"]}], "-", 
               SuperscriptBox["c2x", "4"], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["c1x", "2"], " ", "c1y", " ", "c2y"}], "+", 
               RowBox[{"2", " ", "c1y", " ", 
                SuperscriptBox["c2x", "2"], " ", "c2y"}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", 
                SuperscriptBox["r1", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["r2", "2"]}], "-", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", 
                SuperscriptBox["r2", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["r2", "2"]}], "-", 
               RowBox[{"c1y", " ", "root"}], "+", 
               RowBox[{"c2y", " ", "root"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"c1x", "-", "c2x"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["c1x", "2"], "+", 
                 SuperscriptBox["c1y", "2"], "-", 
                 RowBox[{"2", " ", "c1x", " ", "c2x"}], "+", 
                 SuperscriptBox["c2x", "2"], "-", 
                 RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
                 SuperscriptBox["c2y", "2"]}], ")"}]}], ")"}]}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", "c1y"}], "+", 
               SuperscriptBox["c1y", "3"], "-", 
               RowBox[{"2", " ", "c1x", " ", "c1y", " ", "c2x"}], "+", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["c2x", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", "c2y"}], "-", 
               RowBox[{
                SuperscriptBox["c1y", "2"], " ", "c2y"}], "-", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", "c2y"}], "+", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", "c2y"}], "-", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["c2y", "2"]}], "+", 
               SuperscriptBox["c2y", "3"], "-", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"c2y", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["r2", "2"]}], "-", 
               RowBox[{"c2y", " ", 
                SuperscriptBox["r2", "2"]}], "+", "root"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["c1x", "2"], "+", 
                 SuperscriptBox["c1y", "2"], "-", 
                 RowBox[{"2", " ", "c1x", " ", "c2x"}], "+", 
                 SuperscriptBox["c2x", "2"], "-", 
                 RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
                 SuperscriptBox["c2y", "2"]}], ")"}]}], ")"}]}]}]}], "}"}]}], 
        "]"}], "//", "N"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43843472370999*^9, 3.43843475348237*^9}, {
  3.438434886443983*^9, 3.438434900978075*^9}, {3.43843495222731*^9, 
  3.438435026066283*^9}, {3.438435070431456*^9, 3.438435085129595*^9}, {
  3.438435168707837*^9, 3.438435318309105*^9}, {3.4384353528468847`*^9, 
  3.43843545006945*^9}, {3.438435860382575*^9, 3.4384358743232727`*^9}, {
  3.43843593856898*^9, 3.438435970282937*^9}, {3.4386958184704323`*^9, 
  3.4386958210422363`*^9}, {3.438711970662538*^9, 3.438711970959571*^9}, {
  3.4387789333373404`*^9, 
  3.438778933613502*^9}},ExpressionUUID->"4f8cb7fa-29ec-47a2-946c-\
b280a89af8cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Translation", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[",
      "pts_", "]"}], ",", "x_", ",", " ", "y_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"head", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "+", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], ")"}], "&"}], " ", "/@", " ", 
    "pts"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.4387140880416737`*^9}, {
  3.438714382036488*^9, 
  3.438714385081758*^9}},ExpressionUUID->"4609e496-c548-409e-b5eb-\
26d94334640d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Translation", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", " ", "r_"}], "]"}], ",", "x_", ",", " ", "y_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Circle", "[", 
   RowBox[{
    RowBox[{"c", "+", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]}], ",", "r"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.438714112943643*^9}, {
  3.438714389347822*^9, 
  3.4387143963001347`*^9}},ExpressionUUID->"0dfcd439-582a-43b2-92be-\
791abaf0aec4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Translation", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p_", "]"}], ",", "x_", ",", " ", "y_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{"p", "+", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438714120905571*^9, 3.4387141395352087`*^9}, {
  3.438714391685238*^9, 
  3.43871440133753*^9}},ExpressionUUID->"115e0928-5366-4c6e-897c-\
1214f68f6d90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotation", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[",
      "pts_", "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "a_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"head", "[", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", "p0"}], "]"}], " ", "/@", " ", "pts"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.4387140880416737`*^9}, {
   3.438714382036488*^9, 3.438714385081758*^9}, {3.438714468708665*^9, 
   3.438714469434083*^9}, {3.4387145160937138`*^9, 3.43871452998619*^9}, {
   3.438714593150159*^9, 3.43871460100224*^9}, 3.438714829886491*^9, {
   3.438714883886778*^9, 3.4387148888908663`*^9}, 
   3.438714945891643*^9},ExpressionUUID->"03dfd282-6056-4278-9e87-\
2f26e0958266"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotation", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", " ", "r_"}], "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "a_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Circle", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RotationTransform", "[", 
      RowBox[{
       RowBox[{"-", "a"}], ",", "p0"}], "]"}], "[", "c", "]"}], ",", "r"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.438714112943643*^9}, {
   3.438714389347822*^9, 3.4387143963001347`*^9}, 3.438714471636639*^9, {
   3.438714538323835*^9, 3.43871453929872*^9}, {3.4387146122049637`*^9, 
   3.438714616345483*^9}, 3.438714892878724*^9, 
   3.438714947674595*^9},ExpressionUUID->"b23e95c8-480f-4ca0-a5de-\
1f44f0c11979"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotation", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p_", "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "a_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", "p0"}], "]"}], "[", "p", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438714120905571*^9, 3.4387141395352087`*^9}, {
   3.438714391685238*^9, 3.43871440133753*^9}, 3.438714472068523*^9, {
   3.438714541769411*^9, 3.4387145424518337`*^9}, {3.438714624426499*^9, 
   3.438714625721301*^9}, 3.438714893484865*^9, 
   3.438714948978855*^9},ExpressionUUID->"799f8c78-9f07-46a7-b4b9-\
0ef551be866c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "Rotation", "]"}], ":=", 
  RowBox[{"{", "2", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}, {
   3.4387172631559067`*^9, 3.43871727070444*^9}, {3.438717326440857*^9, 
   3.438717327207018*^9}, 
   3.438717371609825*^9},ExpressionUUID->"62558ab4-6ae0-4d90-b530-\
c9de6d0c9273"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintTransform", "[", 
   RowBox[{"Rotation", ",", " ", 
    RowBox[{"{", "a_", "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"_", ",", " ", 
      RowBox[{"Point", "[", "p_", "]"}]}], "}"}]}], "]"}], ":=", 
  RowBox[{"RotationTransform", "[", 
   RowBox[{"a", ",", " ", "p"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4387182325635767`*^9, 3.4387182687935133`*^9}, {
   3.438718685213876*^9, 3.438718704609926*^9}, {3.438718736164422*^9, 
   3.438718738601409*^9}, {3.43871886842973*^9, 3.438718896057866*^9}, {
   3.438769936371955*^9, 3.438769962414604*^9}, {3.438771131651795*^9, 
   3.438771132104506*^9}, 3.438773613926077*^9, {3.438774324579049*^9, 
   3.438774329230919*^9}},ExpressionUUID->"891d544a-a190-46a1-8585-\
f2b2a1dcdf0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Scaling", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[",
      "pts_", "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "f_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"head", "[", 
   RowBox[{
    RowBox[{"ScalingTransform", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "f"}], "}"}], ",", "p0"}], "]"}], " ", "/@", " ", 
    "pts"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.4387140880416737`*^9}, {
   3.438714382036488*^9, 3.438714385081758*^9}, {3.438714468708665*^9, 
   3.438714469434083*^9}, {3.4387145160937138`*^9, 3.43871452998619*^9}, {
   3.438714593150159*^9, 3.43871460100224*^9}, 3.438714829886491*^9, {
   3.438714883886778*^9, 3.4387148888908663`*^9}, 3.438714945891643*^9, {
   3.438715194598452*^9, 3.4387152338042183`*^9}, {3.438715339103388*^9, 
   3.438715340707569*^9}, {3.438715605758421*^9, 
   3.438715606740409*^9}},ExpressionUUID->"3e9b59f2-b989-496d-a908-\
5c3fd724066c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Scaling", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", " ", "r_"}], "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "f_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Circle", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ScalingTransform", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "f"}], "}"}], ",", "p0"}], "]"}], "[", "c", "]"}], 
    ",", 
    RowBox[{"r", " ", "f"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.438714112943643*^9}, {
   3.438714389347822*^9, 3.4387143963001347`*^9}, 3.438714471636639*^9, {
   3.438714538323835*^9, 3.43871453929872*^9}, {3.4387146122049637`*^9, 
   3.438714616345483*^9}, 3.438714892878724*^9, 3.438714947674595*^9, {
   3.4387152000793333`*^9, 3.438715250202952*^9}, 3.438715354728249*^9, {
   3.438715431252986*^9, 3.438715435377099*^9}, 
   3.4387156137205067`*^9},ExpressionUUID->"a2ddf2f0-6fe0-4c11-9f7e-\
35fbb6bdb80c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Scaling", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p_", "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "f_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{
    RowBox[{"ScalingTransform", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "f"}], "}"}], ",", "p0"}], "]"}], "[", "p", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438714120905571*^9, 3.4387141395352087`*^9}, {
   3.438714391685238*^9, 3.43871440133753*^9}, 3.438714472068523*^9, {
   3.438714541769411*^9, 3.4387145424518337`*^9}, {3.438714624426499*^9, 
   3.438714625721301*^9}, 3.438714893484865*^9, 3.438714948978855*^9, {
   3.438715205758357*^9, 3.438715252283049*^9}, 3.438715355303775*^9, 
   3.438715614759626*^9},ExpressionUUID->"cae5cf73-44d5-4645-b17c-\
bba5f2c4338a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "Scaling", "]"}], ":=", 
  RowBox[{"{", "2", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}, {
  3.4387172631559067`*^9, 3.43871727070444*^9}, {3.438717326440857*^9, 
  3.438717327207018*^9}, {3.438717371609825*^9, 
  3.438717383129814*^9}},ExpressionUUID->"0770eb6d-4f68-4287-961a-\
31c2c379cd75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Reflection", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[",
      "pts_", "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"head", "[", 
   RowBox[{
    RowBox[{"ScalingTransform", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"(", 
         RowBox[{"p2", "-", "p1"}], ")"}], "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "p1"}], "]"}], " ", "/@",
     " ", "pts"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.4387140880416737`*^9}, {
   3.438714382036488*^9, 3.438714385081758*^9}, {3.438714468708665*^9, 
   3.438714469434083*^9}, {3.4387145160937138`*^9, 3.43871452998619*^9}, {
   3.438714593150159*^9, 3.43871460100224*^9}, 3.438714829886491*^9, {
   3.438714883886778*^9, 3.4387148888908663`*^9}, 3.438714945891643*^9, {
   3.438715194598452*^9, 3.4387152338042183`*^9}, {3.438715339103388*^9, 
   3.438715340707569*^9}, {3.438715605758421*^9, 3.438715606740409*^9}, {
   3.438715662719646*^9, 3.438715663957364*^9}, {3.4387157793747187`*^9, 
   3.438715818836814*^9}, {3.438716135870492*^9, 3.438716138773836*^9}, 
   3.4387161754676647`*^9},ExpressionUUID->"67e15c03-cc08-4d20-bb80-\
f20723d3e4c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Reflection", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", " ", "r_"}], "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Circle", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ScalingTransform", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{
        RowBox[{"Reverse", "[", 
         RowBox[{"(", 
          RowBox[{"p2", "-", "p1"}], ")"}], "]"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "p1"}], "]"}], "[", 
     "c", "]"}], ",", "r"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.438714112943643*^9}, {
   3.438714389347822*^9, 3.4387143963001347`*^9}, 3.438714471636639*^9, {
   3.438714538323835*^9, 3.43871453929872*^9}, {3.4387146122049637`*^9, 
   3.438714616345483*^9}, 3.438714892878724*^9, 3.438714947674595*^9, {
   3.4387152000793333`*^9, 3.438715250202952*^9}, 3.438715354728249*^9, {
   3.438715431252986*^9, 3.438715435377099*^9}, 3.4387156137205067`*^9, 
   3.43871566700012*^9, {3.438715801349784*^9, 3.438715820388846*^9}, {
   3.4387161440735493`*^9, 3.4387161733749323`*^9}, {3.4387162446416073`*^9, 
   3.43871624521395*^9}},ExpressionUUID->"1ef389da-c52d-4475-abdd-\
f35252d4bdf6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Reflection", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p_", "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{
    RowBox[{"ScalingTransform", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"(", 
         RowBox[{"p2", "-", "p1"}], ")"}], "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "p1"}], "]"}], "[", 
    "p", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438714120905571*^9, 3.4387141395352087`*^9}, {
   3.438714391685238*^9, 3.43871440133753*^9}, 3.438714472068523*^9, {
   3.438714541769411*^9, 3.4387145424518337`*^9}, {3.438714624426499*^9, 
   3.438714625721301*^9}, 3.438714893484865*^9, 3.438714948978855*^9, {
   3.438715205758357*^9, 3.438715252283049*^9}, 3.438715355303775*^9, 
   3.438715614759626*^9, 3.438715667951962*^9, {3.438715802924268*^9, 
   3.438715821164933*^9}, {3.438716122353023*^9, 
   3.43871616724592*^9}},ExpressionUUID->"577d7889-04dc-4f5b-afb7-\
ee2d2be8618b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Locus", "[", "___", "]"}], ":=", "$Failed"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4402722304326344`*^9, 3.440272235953004*^9}, {
  3.440272300510437*^9, 
  3.4402723024284973`*^9}},ExpressionUUID->"acb76590-b579-4c73-9cea-\
f8c38f337085"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "Reflection", "]"}], ":=", 
  RowBox[{"{", "2", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}, {
  3.4387172631559067`*^9, 3.43871727070444*^9}, {3.438717326440857*^9, 
  3.438717327207018*^9}, {3.438717371609825*^9, 3.438717383129814*^9}, {
  3.438718543229227*^9, 
  3.4387185447281847`*^9}},ExpressionUUID->"b7493929-3287-4633-bd65-\
c0b2a6e7baa5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "_", "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4387174400336637`*^9, 
  3.438717443197906*^9}},ExpressionUUID->"3306f775-1927-4d5d-9fe9-\
8a1a0b49f7e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintTransform", "[", "___", "]"}], ":=", " ", 
  "Identity"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717942937068*^9, 3.438717961199134*^9}, {
   3.438769971487522*^9, 3.4387699723827047`*^9}, 
   3.438774337186379*^9},ExpressionUUID->"97fe3292-aaaa-4d15-8bd2-\
711262e6ada7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Drag", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4383731436348352`*^9, 
  3.438373144288158*^9}},ExpressionUUID->"33158139-0bbe-4094-9bb4-\
2295671ce6ad"],

Cell["Drag the selection, resatisfy constraints.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4383731744514227`*^9, 3.438373270096052*^9}, {
   3.438431911026372*^9, 3.438431930415826*^9}, 3.438456585776129*^9, {
   3.438457887503343*^9, 3.4384578879364967`*^9}, {3.438537918466029*^9, 
   3.438537926365324*^9}},ExpressionUUID->"7e67833a-8ef8-4f09-858a-\
07bd9c0d18ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Drag", "[", 
   RowBox[{"model_", ",", " ", "selection_", ",", " ", "t_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newModel", ",", "changedObjects"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newModel", ",", " ", "changedObjects"}], "}"}], " ", "=", " ", 
      RowBox[{"DragSelection", "[", 
       RowBox[{"model", ",", " ", "selection", ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Resatisfy", "[", 
      RowBox[{"newModel", ",", " ", "changedObjects"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438373147840066*^9, 3.438373166746851*^9}, {
   3.438427265744673*^9, 3.438427268135578*^9}, {3.438427396795951*^9, 
   3.438427460981089*^9}, {3.4384275656419783`*^9, 3.438427586166754*^9}, {
   3.4384276319266*^9, 3.438427633926209*^9}, {3.438428130662489*^9, 
   3.438428133237916*^9}, {3.438428200530737*^9, 3.438428208599*^9}, 
   3.438436702090878*^9, {3.438436757316441*^9, 3.438436757779611*^9}, {
   3.4384494282328167`*^9, 3.43844943073433*^9}, {3.438449989975171*^9, 
   3.438449994654148*^9}, {3.438454256879919*^9, 3.438454284562799*^9}, {
   3.43845451931831*^9, 3.438454524586001*^9}, {3.438456415944289*^9, 
   3.438456428396303*^9}, {3.438520725207032*^9, 3.438520784007702*^9}, 
   3.43852083693692*^9, 3.438520890412786*^9, {3.438521359685316*^9, 
   3.4385213810016413`*^9}, {3.438521430985847*^9, 3.4385215321539803`*^9}, {
   3.4385215634054317`*^9, 3.438521564736339*^9}, {3.438521781530594*^9, 
   3.438521789890636*^9}, {3.438535363016131*^9, 3.438535365574844*^9}, {
   3.4387731407432117`*^9, 3.438773245735561*^9}, {3.438773369775028*^9, 
   3.4387733806051073`*^9}},ExpressionUUID->"c92cac20-88c5-4ab9-acd2-\
5b0fa04e0833"]
}, Closed]],

Cell[CellGroupData[{

Cell["DragSelection", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438521612680991*^9, 
  3.438521619455089*^9}},ExpressionUUID->"e509f532-f601-4e68-b880-\
0af7cc3c8334"],

Cell["\<\
Given a model, a selection, and a drag transform, transforms the objects at \
the root of the drag and returns the new model along with the indices of the \
changed objects.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.438521639503167*^9, 
  3.43852168287969*^9}},ExpressionUUID->"358d30c5-cace-4a87-bf99-\
1aa9aa8707bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DragSelection", "[", 
   RowBox[{"model_", ",", " ", "selection_", ",", " ", "transform_"}], "]"}], 
  " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"newModel", "=", "model"}], ",", " ", 
      RowBox[{"transformQueue", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"selection", ",", "transform"}], "}"}], "]"}]}], ",", " ", 
      RowBox[{"changedObjects", "=", 
       RowBox[{"{", "}"}]}], ",", "i", ",", "t"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"transformQueue", " ", "=!=", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Dequeue", " ", "the", " ", "next", " ", "transform"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "t"}], "}"}], " ", "=", " ", 
         RowBox[{"First", "[", "transformQueue", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"transformQueue", " ", "=", " ", 
         RowBox[{"Rest", "[", "transformQueue", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Process", " ", "the", " ", "dequeued", " ", "transform"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"ConstraintFunction", "[", 
           RowBox[{"newModel", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]",
           "PointOnObject", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Project", " ", "transformed", " ", "point", " ", "to", " ", 
            "object", " ", "and", " ", "record", " ", "change"}], " ", "*)"}],
           "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"newModel", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"newModel", ",", " ", 
              RowBox[{"i", "\[Rule]", 
               RowBox[{"ProjectPointToObject", "[", 
                RowBox[{"newModel", ",", " ", "i", ",", " ", "t"}], "]"}]}]}],
              "]"}]}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"changedObjects", ",", " ", "i"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "Null", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Drag", " ", "leaf", " ", "point"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"newModel", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"newModel", ",", " ", 
              RowBox[{"i", "\[Rule]", 
               RowBox[{"DragPoint", "[", 
                RowBox[{"newModel", ",", " ", "i", ",", " ", "t"}], "]"}]}]}],
              "]"}]}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"changedObjects", ",", " ", "i"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"transformQueue", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"transformQueue", ",", " ", "\[IndentingNewLine]", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"objArgs", "=", 
                  RowBox[{"ObjectArguments", "[", 
                   RowBox[{"newModel", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"paramArgs", "=", 
                  RowBox[{"ParameterArguments", "[", 
                   RowBox[{"newModel", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"constraint", "=", 
                  RowBox[{"ConstraintFunction", "[", 
                   RowBox[{"newModel", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"objArgs", "[", 
                   RowBox[{"[", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "objArgs", "]"}], "]"}], ",", 
                    RowBox[{"StationaryObjects", "[", "constraint", "]"}]}], 
                    "]"}], "]"}], "]"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ct", "=", 
                    RowBox[{"ConstraintTransform", "[", 
                    RowBox[{"constraint", ",", " ", "paramArgs", ",", " ", 
                    RowBox[{"First", " ", "/@", " ", 
                    RowBox[{"newModel", "[", 
                    RowBox[{"[", "objArgs", "]"}], "]"}]}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Composition", "[", 
                    RowBox[{"ct", ",", "t", ",", 
                    RowBox[{"InverseFunction", "[", "ct", "]"}]}], "]"}]}], 
                   "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], "]"}]}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newModel", ",", "changedObjects"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438454395016759*^9, 3.438454423806239*^9}, {
   3.438520903220848*^9, 3.438520904490295*^9}, {3.4385218968273907`*^9, 
   3.438521903395979*^9}, {3.438521941068684*^9, 3.438521945449161*^9}, {
   3.438522036300353*^9, 3.438522042068409*^9}, {3.438522094884739*^9, 
   3.4385221284470673`*^9}, {3.438530862349983*^9, 3.438530932856439*^9}, {
   3.438531044523892*^9, 3.4385310741423073`*^9}, {3.4385311150752*^9, 
   3.438531122994628*^9}, {3.438532657055718*^9, 3.438532821077353*^9}, {
   3.4385328523428383`*^9, 3.4385330358244*^9}, {3.438533077917642*^9, 
   3.43853308643274*^9}, {3.4385331242451677`*^9, 3.438533143928087*^9}, {
   3.438533181792913*^9, 3.4385332260177298`*^9}, {3.438533496214142*^9, 
   3.438533499932166*^9}, {3.4385346955343313`*^9, 3.438534749427191*^9}, {
   3.4385348340412407`*^9, 3.4385350359966183`*^9}, {3.438535282349502*^9, 
   3.438535288641403*^9}, {3.438537620965167*^9, 3.43853762546454*^9}, {
   3.438717462450391*^9, 3.438717489239477*^9}, {3.438717525886222*^9, 
   3.4387176300500307`*^9}, {3.438718781311307*^9, 3.438718803180208*^9}, {
   3.438719113222659*^9, 3.438719118189186*^9}, {3.438719184999269*^9, 
   3.438719206463139*^9}, 3.438719294574216*^9, {3.438719342075756*^9, 
   3.438719344566896*^9}, {3.438719382202805*^9, 3.4387194043102083`*^9}, {
   3.4387700174074802`*^9, 3.4387702056900587`*^9}, {3.438770407548265*^9, 
   3.43877041146218*^9}, {3.4387704854170437`*^9, 3.4387705003750134`*^9}, {
   3.4387705661862297`*^9, 3.438770583694401*^9}, {3.438770850284636*^9, 
   3.43877087394666*^9}, {3.4387709187390537`*^9, 3.438770929880892*^9}, {
   3.438770962466469*^9, 3.438770968058309*^9}, {3.438771036808407*^9, 
   3.438771048826766*^9}, {3.4387711506581583`*^9, 3.438771159531652*^9}, 
   3.438771218292756*^9, {3.43877201435741*^9, 3.438772037693255*^9}, 
   3.438772251305087*^9, {3.4387724757722816`*^9, 3.438772477015458*^9}, 
   3.43877268025601*^9, {3.4387736047765923`*^9, 3.438773607462069*^9}, {
   3.438773658804207*^9, 3.4387736615713987`*^9}, {3.4387741620865507`*^9, 
   3.43877423454869*^9}, {3.4387742719038877`*^9, 3.438774274357232*^9}, {
   3.438774338807849*^9, 
   3.438774357131196*^9}},ExpressionUUID->"4365158c-0a02-490a-85ef-\
db30da5a2379"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectPointToObject", "[", 
   RowBox[{"model_", ",", " ", "i_", ",", " ", "t_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"point", " ", "=", " ", 
       RowBox[{"ObjectCache", "[", 
        RowBox[{"model", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{"object", "=", " ", 
       RowBox[{"ObjectCache", "[", 
        RowBox[{"model", "[", 
         RowBox[{"[", 
          RowBox[{"model", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", "newPoint", ",", 
      "newParameter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newPoint", ",", "newParameter"}], "}"}], " ", "=", "  ", 
      RowBox[{"ProjectPoint", "[", 
       RowBox[{
        RowBox[{"TransformObject", "[", 
         RowBox[{"point", ",", "t"}], "]"}], ",", " ", "object"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"model", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "\[Rule]", "newPoint"}], ",", 
         RowBox[{"3", "\[Rule]", 
          RowBox[{"{", "newParameter", "}"}]}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4385336459585867`*^9, 3.438533853369026*^9}, {
   3.438533896615534*^9, 3.4385339656247177`*^9}, {3.438534000450883*^9, 
   3.438534015544526*^9}, {3.43853405349632*^9, 3.4385340598236933`*^9}, 
   3.438534419734954*^9, {3.438534527737135*^9, 
   3.4385345283276167`*^9}},ExpressionUUID->"3afa01f8-91a8-48a1-b27f-\
eeaee1830415"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectPoint", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p_", "]"}], ",", " ", 
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", "r_"}], "]"}]}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newP", " ", "=", " ", 
      RowBox[{"c", " ", "+", " ", 
       RowBox[{"r", " ", 
        RowBox[{"Normalize", "[", 
         RowBox[{"p", "-", "c"}], "]"}]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Point", "[", "newP", "]"}], ",", 
      RowBox[{"ArcTan", "@@", 
       RowBox[{"(", 
        RowBox[{"newP", "-", "c"}], ")"}]}]}], "}"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438534072345861*^9, 3.4385341749670877`*^9}, {
   3.438534208041325*^9, 3.4385342785983343`*^9}, 3.438622646917955*^9, 
   3.4386888351735277`*^9, 3.438689704227324*^9, {3.4386897445872498`*^9, 
   3.438689756966422*^9}, {3.43868986995156*^9, 3.43868992214688*^9}, {
   3.4386905468891907`*^9, 3.438690552245038*^9}, {3.438690665989605*^9, 
   3.438690669989653*^9}, 
   3.438691575262906*^9},ExpressionUUID->"b259897b-e778-4066-a54e-\
fbfc5ba18cfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectPoint", "[", 
   RowBox[{
    RowBox[{"Point", "[", 
     RowBox[{"p0", ":", 
      RowBox[{"{", 
       RowBox[{"x0_", ",", "y0_"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lineLength", ",", "projectedLength", ",", "distance"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lineLength", " ", "=", " ", 
      RowBox[{"Norm", "[", 
       RowBox[{"p1", "-", "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"projectedLength", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p0", "-", "p2"}], ")"}], ".", 
       RowBox[{"Normalize", "[", 
        RowBox[{"p1", "-", "p2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "head", ",", "\[IndentingNewLine]", "LineSegment", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"projectedLength", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"projectedLength", ",", "lineLength"}], "]"}], ",", "0"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "Ray", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"projectedLength", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"projectedLength", ",", "0"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"p2", " ", "+", " ", 
         RowBox[{"projectedLength", " ", 
          RowBox[{"Normalize", "[", 
           RowBox[{"p1", "-", "p2"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"projectedLength", "/", "lineLength"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438534072345861*^9, 3.4385341749670877`*^9}, {
  3.438534208041325*^9, 3.4385342785983343`*^9}, {3.438540431383582*^9, 
  3.438540461234765*^9}, {3.438546233341928*^9, 3.438546237687273*^9}, {
  3.438546276076586*^9, 3.4385462978318157`*^9}, {3.438546371431782*^9, 
  3.4385464751181927`*^9}, {3.4385465166387653`*^9, 3.438546517859047*^9}, {
  3.438546551832374*^9, 3.438546552460445*^9}, {3.4385466317927437`*^9, 
  3.438546640419458*^9}, {3.43861907038883*^9, 3.4386190811435013`*^9}, {
  3.438621868514423*^9, 3.438621883927102*^9}, {3.438707310809873*^9, 
  3.438707316105276*^9}, {3.438707593724432*^9, 3.4387075940537024`*^9}, {
  3.438707988006295*^9, 3.438707988673674*^9}, {3.438708030635283*^9, 
  3.438708032912977*^9}},ExpressionUUID->"7b542433-866e-4dda-9ef7-\
a83873bc1eaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DragPoint", "[", 
   RowBox[{"model_", ",", " ", "i_", ",", " ", "t_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pt", " ", "=", " ", 
      RowBox[{
       RowBox[{"ObjectCache", "[", 
        RowBox[{"model", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"model", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"1", "\[Rule]", 
       RowBox[{"Point", "[", 
        RowBox[{"t", "[", "pt", "]"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4385336459585867`*^9, 3.438533853369026*^9}, {
   3.438533896615534*^9, 3.4385339656247177`*^9}, {3.438534000450883*^9, 
   3.438534015544526*^9}, {3.43853405349632*^9, 3.4385340598236933`*^9}, 
   3.438534419734954*^9, {3.438534527737135*^9, 3.4385345283276167`*^9}, {
   3.438535078804823*^9, 
   3.4385351808870783`*^9}},ExpressionUUID->"64a49027-0bf1-48a3-95e1-\
18630a46c5ce"]
}, Closed]],

Cell[CellGroupData[{

Cell["Resatisfy", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438521630887066*^9, 
  3.4385216332950363`*^9}},ExpressionUUID->"c3c65b54-0420-4f4f-b33d-\
af3761472328"],

Cell["\<\
Given a list of changed objects in a model, resatisfies all the constraints \
in the model.  Objects that do not depend on changed objects are recorded as \
constant, and objects that depend on the changes objects are recalculated.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.438521742911746*^9, 3.438521749334897*^9}, {
  3.438521802271665*^9, 
  3.4385218576632147`*^9}},ExpressionUUID->"e8c4f345-3e74-497a-b14a-\
58236f778b35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Resatisfy", "[", 
   RowBox[{"model_", ",", " ", "changedObjects_"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"First", "[", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{"ResatisfyStep", ",", 
     RowBox[{"{", 
      RowBox[{"model", ",", " ", 
       RowBox[{"DependentObjects", "[", 
        RowBox[{"model", ",", " ", "changedObjects"}], "]"}]}], "}"}]}], 
    "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438454395016759*^9, 3.438454423806239*^9}, {
  3.438520903220848*^9, 3.438520904490295*^9}, {3.4385218968273907`*^9, 
  3.438521903395979*^9}, {3.438521941068684*^9, 3.438521945449161*^9}, {
  3.438522036300353*^9, 3.438522042068409*^9}, {3.438522094884739*^9, 
  3.4385221284470673`*^9}},ExpressionUUID->"c5bd480f-be7c-41b5-a515-\
2c2f236c8afb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ResatisfyStep", "[", 
    RowBox[{"{", 
     RowBox[{"model_", ",", " ", "invalid_"}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newModel", ",", " ", 
       RowBox[{"newlyCompleted", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newModel", " ", "=", " ", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"invalid", ",", "i"}], "]"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"ObjectArguments", "[", 
                RowBox[{"model", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", "invalid"}],
               "]"}], "===", 
             RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"newlyCompleted", ",", "i"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Rest", "[", 
               RowBox[{"model", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"objectArgs", "=", 
                  RowBox[{"model", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"ObjectArguments", "[", 
                    RowBox[{"model", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
                   "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"objectArgs", ",", "$Failed"}], "]"}], ",", 
                  "\[IndentingNewLine]", "$Failed", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ConstraintFunction", "[", 
                    RowBox[{"model", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "@@", 
                   RowBox[{"Join", "[", 
                    RowBox[{"objectArgs", ",", 
                    RowBox[{"ParameterArguments", "[", 
                    RowBox[{"model", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"model", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "model", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"newModel", ",", 
        RowBox[{"Complement", "[", 
         RowBox[{"invalid", ",", "newlyCompleted"}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438436529315956*^9, 3.4384365548182573`*^9}, {
   3.4384365915431633`*^9, 3.438436607499482*^9}, {3.438436680125736*^9, 
   3.43843670026962*^9}, 3.438437093808358*^9, {3.43843713002458*^9, 
   3.438437158622476*^9}, {3.438437379866671*^9, 3.438437527222267*^9}, {
   3.438437559986146*^9, 3.43843760130608*^9}, {3.4384376589266787`*^9, 
   3.438437660933728*^9}, {3.438437691857594*^9, 3.438437801789358*^9}, {
   3.438437866397615*^9, 3.4384379448271437`*^9}, 3.438438435622191*^9, {
   3.438438487151435*^9, 3.438438510331802*^9}, 3.438454376945632*^9, {
   3.438455800929633*^9, 3.4384558363198957`*^9}, {3.438456088867337*^9, 
   3.438456091650423*^9}, {3.438521904537871*^9, 3.438521913142447*^9}, {
   3.4385221362899113`*^9, 3.438522151942874*^9}, {3.4385233060221767`*^9, 
   3.4385234267969313`*^9}, {3.438523651859128*^9, 3.4385236829296837`*^9}, {
   3.438531711652143*^9, 3.438531716627738*^9}, 3.438532200199059*^9, {
   3.438532266734605*^9, 3.4385322679151487`*^9}, 3.438532330163053*^9, {
   3.438712648697019*^9, 3.438712728034172*^9}, {3.438712843878154*^9, 
   3.438712885985324*^9}},ExpressionUUID->"ad3c7562-7540-45f1-8cbb-\
125eca200b72"],

Cell["\<\
Given a model and a list of object indices, returns the list of indices of \
dependent objects in the model.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.438522170583756*^9, 
  3.438522190895473*^9}},ExpressionUUID->"d0639746-fa4f-4d9a-82ed-\
34c04e90305b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DependentObjects", "[", 
   RowBox[{"model_", ",", " ", "selection_"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"selection", "===", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"directDependencies", "=", 
        RowBox[{"DirectlyDependentObjects", "[", 
         RowBox[{"model", ",", " ", "selection"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Union", "[", 
       RowBox[{"directDependencies", ",", 
        RowBox[{"DependentObjects", "[", 
         RowBox[{"model", ",", "directDependencies"}], "]"}]}], "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438522938139916*^9, 3.438523130933619*^9}, {
  3.4387749537286587`*^9, 
  3.438774955170236*^9}},ExpressionUUID->"0f7f0f17-44c5-4aa3-893a-\
ff8950db80a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DirectlyDependentObjects", "[", 
   RowBox[{"model_", ",", " ", "selection_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{"selection", ",", 
          RowBox[{"ObjectArguments", "[", 
           RowBox[{"model", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "i", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "model", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4385224879540567`*^9, 3.438522546177704*^9}, {
   3.438522610382818*^9, 3.438522617027869*^9}, {3.438522668742998*^9, 
   3.4385227706926117`*^9}, 
   3.43853226519698*^9},ExpressionUUID->"c4dcd069-af9b-451e-aedf-\
1bc163c9a059"]
}, Closed]],

Cell[CellGroupData[{

Cell["TransformObject", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4384280281476107`*^9, 3.43842802954537*^9}, 
   3.438428164002721*^9, 
   3.438450411135584*^9},ExpressionUUID->"081e92fe-5197-4ef7-8975-\
54726279b4db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformObject", "[", 
   RowBox[{
    RowBox[{"Point", "[", "pt_", "]"}], ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"Point", "[", 
   RowBox[{"t", "[", "pt", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438428035241374*^9, 3.4384280370835648`*^9}, {
   3.4384280698134937`*^9, 3.438428077674857*^9}, {3.438428164740219*^9, 
   3.438428181703717*^9}, {3.438428222713563*^9, 3.438428247227867*^9}, {
   3.4384282811566763`*^9, 3.4384282818997583`*^9}, 3.4384500153907003`*^9, {
   3.438450152497553*^9, 
   3.438450155860506*^9}},ExpressionUUID->"44272a2a-090b-4c33-a24c-\
2f464958c48d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformObject", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", " ", "r_Integer"}], "]"}], ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"Circle", "[", 
   RowBox[{
    RowBox[{"t", "[", "c", "]"}], ",", " ", 
    RowBox[{"Norm", "[", 
     RowBox[{"ApplyVectorTransform", "[", 
      RowBox[{"t", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "0"}], "}"}]}], "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438428035241374*^9, 3.4384280370835648`*^9}, {
   3.4384280698134937`*^9, 3.438428089171907*^9}, {3.4384281671406717`*^9, 
   3.438428182126685*^9}, {3.438428224519084*^9, 3.438428283011948*^9}, 
   3.438450016672155*^9, {3.4384501617491417`*^9, 3.4384501624014597`*^9}, {
   3.438450351903297*^9, 3.438450402349415*^9}, {3.438450464304923*^9, 
   3.438450465109521*^9}, {3.438450872898567*^9, 
   3.438450897389392*^9}},ExpressionUUID->"cca9f71a-d9b6-4fc5-accf-\
7704927fd927"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformObject", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"LineSegment", "|", "Ray", "|", "Line"}], ")"}]}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"head", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "[", "p1", "]"}], ",", " ", 
     RowBox[{"t", "[", "p2", "]"}]}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438428035241374*^9, 3.4384280370835648`*^9}, {
   3.4384280698134937`*^9, 3.438428112020784*^9}, {3.4384281681246862`*^9, 
   3.438428182536647*^9}, {3.438428224887086*^9, 3.438428284765032*^9}, {
   3.4384283334320173`*^9, 3.438428335748962*^9}, 3.4384500175447683`*^9, {
   3.438450365382085*^9, 
   3.438450370294063*^9}},ExpressionUUID->"c3a23402-6762-4aa9-9130-\
03b0049e7a6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplyVectorTransform", "[", 
   RowBox[{"t_", ",", " ", "v_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TransformationMatrix", "[", "t", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "2"}], ",", 
      RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ".", "v"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438450476727768*^9, 
  3.438450503068975*^9}},ExpressionUUID->"6e30c76c-dbc6-44c4-8987-\
e11263557854"]
}, Closed]],

Cell[CellGroupData[{

Cell["ImportModel", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{
  3.438608395025898*^9, {3.4386100597800283`*^9, 
   3.4386100628554573`*^9}},ExpressionUUID->"7b1fddee-41ff-4e15-a349-\
fa5566fef31d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetGSPObjectArgs", "[", "x_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"\"\<{\>\"", "<>", 
     RowBox[{"StringTake", "[", 
      RowBox[{"x", ",", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}], " ", "+", " ", 
        RowBox[{"First", "[", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"x", ",", 
           RowBox[{"RegularExpression", "[", "\"\<\\\\(.*\\\\)\>\"", "]"}]}], 
          "]"}], "]"}]}]}], "]"}], "<>", "\"\<}\>\""}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4386257325942574`*^9, 3.438625752320064*^9}, {
  3.438625888943213*^9, 
  3.438625927698061*^9}},ExpressionUUID->"ade04a75-3a01-4f64-ab4f-\
cccbd4c93925"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParseGSPObject", "[", "x_String", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"parenPos", ",", "args", ",", "argCount", ",", 
      RowBox[{"head", "=", "\"\<\>\""}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"parenPos", " ", "=", " ", 
      RowBox[{"StringPosition", "[", 
       RowBox[{"x", ",", 
        RowBox[{"RegularExpression", "[", "\"\<\\\\(.*\\\\)\>\"", "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"parenPos", " ", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"args", " ", "=", " ", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<{\>\"", "<>", 
           RowBox[{"StringTake", "[", 
            RowBox[{"x", ",", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}], " ", "+", " ", 
              RowBox[{"First", "[", 
               RowBox[{"StringPosition", "[", 
                RowBox[{"x", ",", 
                 RowBox[{
                 "RegularExpression", "[", "\"\<\\\\(.*\\\\)\>\"", "]"}]}], 
                "]"}], "]"}]}]}], "]"}], "<>", "\"\<}\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"argCount", " ", "=", " ", 
         RowBox[{"Length", "[", "args", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"head", " ", "=", " ", 
         RowBox[{"First", "[", 
          RowBox[{"StringSplit", "[", 
           RowBox[{"x", ",", "\"\<(\>\""}], "]"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"head", "===", "\"\<Point\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", "args", "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Circle\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "CircleCenterRadius", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Circle by radius\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "CircleByRadius", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Point on object\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "PointOnObject", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Last", "[", "args", "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"First", "[", "args", "]"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Segment\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Line\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "LineThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Ray\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "RayThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Midpoint\>\""}], "&&", 
        RowBox[{"argCount", "===", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Intersect\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "PointAtIntersection", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Intersect1\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "PointAtIntersection1", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Intersect2\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "PointAtIntersection2", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Parallel\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Parallel", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Perpendicular\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Perpendicular", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Translation\>\""}], "&&", 
        RowBox[{"argCount", "===", "3"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Translation", ",", 
         RowBox[{"Rest", "[", "args", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"First", "[", "args", "]"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Rotation\>\""}], "&&", 
        RowBox[{"argCount", "===", "3"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"Last", "[", "args", "]"}], "}"}], ",", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"args", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Dilation\>\""}], "&&", 
        RowBox[{"argCount", "===", "3"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Scaling", ",", 
         RowBox[{"{", 
          RowBox[{"Last", "[", "args", "]"}], "}"}], ",", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"args", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Reflection\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", " ", "args"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Locus\>\""}], "&&", 
        RowBox[{"argCount", "===", "4"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Locus", ",", 
         RowBox[{"{", 
          RowBox[{"Last", "[", "args", "]"}], "}"}], ",", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"args", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       "True", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Ignoring unknown object \>\"", ",", "x"}], "]"}], ";", 
         RowBox[{"{", 
          RowBox[{"Null", ",", "\"\<Unknown\>\"", ",", " ", 
           RowBox[{"{", "}"}], ",", " ", 
           RowBox[{"{", "}"}]}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438625965572483*^9, 3.438626036307386*^9}, {
   3.438626069915642*^9, 3.43862609070636*^9}, {3.438626263191293*^9, 
   3.438626387529574*^9}, {3.4386264422435837`*^9, 3.438626446040634*^9}, {
   3.438626488875229*^9, 3.438626563465939*^9}, {3.438626595674614*^9, 
   3.438626661513558*^9}, {3.438627264738575*^9, 3.438627365502234*^9}, {
   3.4386854347234383`*^9, 3.438685451673643*^9}, {3.438685681524713*^9, 
   3.438685698267522*^9}, {3.4386859072094316`*^9, 3.438685911143002*^9}, 
   3.438687875863432*^9, 3.4386886009231367`*^9, 3.438688696886128*^9, {
   3.438695303893209*^9, 3.43869532060747*^9}, {3.43869573413171*^9, 
   3.438695743326112*^9}, {3.438695848055429*^9, 3.438695856867916*^9}, {
   3.4386961504532843`*^9, 3.4386961528551817`*^9}, {3.438696748178623*^9, 
   3.438696764016417*^9}, {3.438709491565168*^9, 3.438709499883596*^9}, {
   3.438714191756833*^9, 3.438714222052285*^9}, {3.438714656749209*^9, 
   3.438714707086837*^9}, {3.438714792983893*^9, 3.438714795837201*^9}, {
   3.438715369011202*^9, 3.438715376325395*^9}, {3.4387161958686247`*^9, 
   3.438716208237472*^9}, 3.438716293760336*^9, {3.440272068208453*^9, 
   3.440272113627598*^9}},ExpressionUUID->"7ea25704-538d-4fa4-86f2-\
bf54c79b3c77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PruneUnknownObjects", "[", "model_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"newModel", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"unknownIndices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"indexMap", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Unknown", " ", "object"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"Null", ",", " ", "\"\<Unknown\>\"", ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"unknownIndices", ",", " ", 
            RowBox[{"First", "[", "#2", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Known", " ", "object", " ", "with", " ", "dependencies", " ", 
            "on", " ", "unknown", " ", "objects"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"ObjectArguments", "[", "#", "]"}], ",", 
             "unknownIndices"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"unknownIndices", ",", " ", 
            RowBox[{"First", "[", "#2", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Keeper", " ", "*)"}], "\[IndentingNewLine]", 
          "True", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"newModel", ",", " ", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ObjectArguments", "[", "#", "]"}], "/.", 
                  "indexMap"}], ")"}]}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"indexMap", ",", " ", 
             RowBox[{
              RowBox[{"First", "[", "#2", "]"}], "\[Rule]", 
              RowBox[{"Length", "[", "newModel", "]"}]}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], ",", " ", "model"}], "]"}], ";",
      "\[IndentingNewLine]", "newModel"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438686280844741*^9, 3.438686283170141*^9}, {
  3.438686777846696*^9, 3.438686852965583*^9}, {3.438686910319765*^9, 
  3.438686966677991*^9}, {3.438687064405774*^9, 
  3.438687631662673*^9}},ExpressionUUID->"391d2d9b-4d7e-4fb9-b712-\
55fd7403fb7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ImportModel", "[", 
    RowBox[{"name_", ",", "opts___"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fileString", ",", "appletString", ",", "width", ",", " ", "height", 
       ",", "constructionString", ",", "gspObjectStrings", ",", "includeSize",
        ",", " ", "model"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"includeSize", " ", "=", " ", 
       RowBox[{
        RowBox[{"IncludeSize", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"IncludeSize", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fileString", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"name", ",", "\"\<String\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"appletString", "=", 
       RowBox[{"First", "[", 
        RowBox[{"StringTake", "[", 
         RowBox[{"fileString", ",", 
          RowBox[{"StringPosition", "[", 
           RowBox[{"fileString", ",", 
            RowBox[{
            "RegularExpression", "[", "\"\<<APPLET.*/APPLET>\>\"", "]"}]}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"width", ",", "height"}], "}"}], " ", "=", " ", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<{\>\"", "<>", "\[IndentingNewLine]", 
         RowBox[{"StringTake", "[", 
          RowBox[{"appletString", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"6", ",", "0"}], "}"}], "+", 
            RowBox[{"First", "[", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"appletString", ",", 
               RowBox[{
               "RegularExpression", "[", "\"\<WIDTH=\\\\d+\>\"", "]"}]}], 
              "]"}], "]"}]}]}], "]"}], "<>", "\[IndentingNewLine]", 
         "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
         RowBox[{"StringTake", "[", 
          RowBox[{"appletString", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"7", ",", "0"}], "}"}], "+", 
            RowBox[{"First", "[", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"appletString", ",", 
               RowBox[{
               "RegularExpression", "[", "\"\<HEIGHT=\\\\d+\>\"", "]"}]}], 
              "]"}], "]"}]}]}], "]"}], "<>", "\"\<}\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"constructionString", "=", 
       RowBox[{"StringTake", "[", 
        RowBox[{"fileString", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"26", ",", 
            RowBox[{"-", "2"}]}], "}"}], "+", 
          RowBox[{"First", "[", 
           RowBox[{"StringPosition", "[", 
            RowBox[{"fileString", ",", 
             RowBox[{
             "RegularExpression", "[", 
              "\"\<NAME=Construction VALUE=\\\".*\\\"\>\"", "]"}]}], "]"}], 
           "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"model", "=", 
       RowBox[{"ParseGSPObject", "/@", " ", 
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"StringReplace", "[", 
           RowBox[{"constructionString", ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"RegularExpression", "[", "\"\<\\[[^]]*\\]\>\"", "]"}],
                "\[Rule]", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"RegularExpression", "[", "\"\<{[^}]*} \>\"", "]"}], 
               "\[Rule]", "\"\<\>\""}], ",", 
              RowBox[{"\"\<\\r\>\"", "\[Rule]", "\"\<\>\""}], ",", 
              RowBox[{"\"\<\\n\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
           "]"}], ",", "\"\<;\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"model", " ", "=", " ", 
       RowBox[{"PruneUnknownObjects", "[", "model", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"model", " ", "=", " ", 
       RowBox[{"construct", "[", "model", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"includeSize", ",", " ", 
        RowBox[{"{", 
         RowBox[{"model", ",", " ", 
          RowBox[{"{", 
           RowBox[{"width", ",", "height"}], "}"}]}], "}"}], ",", " ", 
        "model"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"03f6e480-5f0a-428b-a8b5-5e0bbb5eaef5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tools", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.437743461164487*^9, 
  3.437743462849448*^9}},ExpressionUUID->"7b429448-b4d8-4521-8c13-\
e6082dc4bd8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "selectOn", ",", "selectOff", ",", "pointOn", ",", "pointOff", ",", 
     "circleOn", ",", "circleOff", ",", "lineSegmentOn", ",", 
     "lineSegmentOff"}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJzt1c9JA0EYxuEFKxArSCX2INhAwLMFahMeLEDEUy6WINn15DLBWWbz7p/n
g/AEEobN8P3I4fj88HTTdd3h93V+b8ye566fz/u/PvbzTm7C15fznEYOFXyP
rO3itp8PclWmuhg+/yIXqS5IXZC6IKepC1IXpC7IaeqC1MXS7AqTfq69q4us
pS70klUXWWu70Mt11EXWVl3opa26yDp3F6VJ/+6lq4usmSrKk76PpaiLrJnt
r5/0PV1bXWTNbHm7Sd/fXOoia2abt7vPrdRF1lb7rIu26iLr3Hurl2nqYtvq
Ypq62Kd6uawu9qkuLqsLrtFhj95GtjpfF1yjpS5a9aILrtHaLmp70QXXqP8L
8v9dtDpfF+R8XZTOIbdkbRel75N7sNTFD6lBO2U=
        "], {{0, 33}, {33, 0}}, {0., 1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJzt2kFKw0AUgOGAJxBP0JN4B8ELCK49j15FL+HCpW7EhYjgESSpuGgdSdqX
vEnyPShfugnDMD9dTDdXNxfXJ03TbH4+7fNZN6/nuzbGrHhKXbw8t/NJrtKh
XTzct/NBzsrLbt721AXXbKmLrU976oJrUBekLkhdkIepC1IXY1u698leF4ep
i1iH3pNmr5d/q4tYj/s3gV5qURexRnWhl1x1EevYXehlGnURa1YXpcnej7mq
i1izO+g72ftUu7qINfu8HzvZ+1eLuojVeV6Guog16jzrIlddxDr2udXLNOpi
XupiGnWxDPUSqy6WoS5i1QVr8LSbxz11wTVb6iKrF12wBod2MXYvumAN+r0g
+3eRtR5dkLogdUEe5thd/P9+co7272J7i/pV9O62nfff76X3k3P0Gw9yanc=

        "], {{0, 33}, {33, 0}}, {0., 1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmJmYGBQhGIQO5Rm4O7du////58xYwaQ3UEbgGbFKhqAUStGrRi1
YtSK4WcFAwzQyAoGVDBqBTG2EKN40KaoUStGrRi1glpW3KUlgFjxn8YAaAUD
jQHQCgCFTx0U
        "], {{0, 33}, {33, 0}}, {0, 255},
        ColorFunction->RGBColor],
       BoxForm`ImageTag[
       "Byte", ColorSpace -> "RGB", ImageSize -> Automatic, Interleaving -> 
        True, Magnification -> Automatic],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJzt2rEJwkAAhtEDR3CCTOIOggsI1s6jq+galtqIhYjgCHKJWCgRPSKXcO+H
8JImELivSzVfThejEEL1uOL9uN5x8mowK3htXRz2cVeySH/tYruJu5CDclbv
9KYuWLJtXTTu3tQFS1AXpC5IXZBp6oLUBakLMk1dkLogdUGmqYt+2tV/nrm/
Y6jqIq9dnX+9dKsu8qqLfqqLvOqin+qinzr/edUFqQtSF2SauiB1QeqCTFMX
pC5IXZBp6oLUBakLMs1/d/H5/eQQ/b6L5u/NW6vrVdz5+dz2fnKI3gGs5P6J

        "], {{0, 33}, {33, 0}}, {0., 1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJztnD1OAzEQRlfiBIgT5AwcgDsgcQEkas4Dt6AODSUlBQUFSCiiouEIaNdU
jD4r3r/xjt9I0YuUlTMz9pexvevsrm8vb066rtv9vfr3Z4MdLv6zw7CGTeni
arBXCEPwcd/bt2FSwY9hqS5OB/uEcFP00kX6/AvCKokuIEQXEKILCMcRXcRg
6bryfLCDoXcctRBd+PL+rrc3w5SnJ0O1f66uz/PBsLR95b93XqcSXczLj/fB
DNU4TOPo2VC1U1tcyn8Vb21xKaKLKVTx2vEQOw+WKt58fl4MvfxHF3mq/kq0
8wrm7Xmq/OTrzvp6QReJpfMfb3+jUelF5X/p+Ri6SMzX9/r9j0qV/6V/r1rT
hdo/UXXcy0+Yp+qvufbHWtNF+n67LtjKPglMzM97bf+Wtt+mLmz9jbpeVvcj
vP2qPd6ouvCal9bG1nQx1+9em7qYXme9qMZ56fifq53aqPq3dBxG1UXpvt/a
/bcWtz7OS0m9GMfWxgnxjou3NV0svb8H1yH7UfOS+xcxyP2LdajmpVvxPypV
/pdeJ6KLxNK6HPV+hxd5PqpOXSgmf+3znKqOo5c8eZ42ceu6yJPzF4oqXpUf
lU8v/9HFvFz6vJ5XPeK8HrpYk6Xnu/P1SPH4c99q/19dH3V/G13EYH7devz/
hHjHUQvRBYTL6UK1A2EklupCXQ9hC/wFIYmATA==
        "], {{0, 33}, {33, 0}}, {0., 1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJztnUFKxDAUhgueQDzBnMEDeAfBCwiuXXoWvYVr3bh06cKFCwUZREQEjyBt
7MK++cPUtpOX5HswfDMMhLz38jevSTqzOj0/Pttrmmb1+2rfY1jNdtDZ+mjI
l+fWviCskmN1cXvT2ieEWfGkszdDdAFrptJF4KMhuoA1EF345EVn75OZ2o9c
iS7m5X5nr4ZXl63dG4bvr0fyTnD7duL9sf1PHVd04YuHna0N4+PuwVC149Mv
23/lrze/0MW8DNfLJ0N1fVZxS+3HrseJio+KZ2o/0MVmqnypuiLwwzC1H16o
4hOPp3+9lKqLeJ2grm+M/6X1kks9VqouVPxrq3+8MV6P2Xx562cuuhium/yl
vX9MPS7gZsbv93e/Ppa7LlQd621ehnGqfKn8oos4vc2/+FuGv7noQu3nMk7q
9Hfp/f0ydGHXl1Lnc2rex47/udrxRpVfdBHIfBGIv8wXjBP8TeVv7rpgPaoM
sh41L8P1g/2L3KnypfKLLqbEmf1ub1Tx91YflqoLzkelJeejfOoini/O0y49
/jlPm5cuxupFzS+11WPx+ofnL0rVhWK8HuN5PW9+oQufHK6b9OT57ryILnyS
3wNJS3QBIbqAEF1A+D8urYt4+xDmyO11Ef4F4Fuy3+/pP6v2IcyRShc/kc0W
bg==
        "], {{0, 33}, {33, 0}}, {0., 1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJzt1ssNgCAQRdFJrIReqMDEBmjANiyBGuyJWhBFWfgDBp7RxJeYzOqenSpU
36qGiMT6zHcHmzHGWqu1dveA2Y4YAfuJn3g5Qcs+Tezi1YnTfkXiql+LuOlX
Ie775US0X0ik9EuIxD6bSO/ziKw+g8jt5xKMfhbB6ycSx5dndFLKB4iggL56
chua8DeOCPeTvwcGOU9Y8BxB4DliAkX8ElI=
        "], {{0, 33}, {33, 0}}, {0, 255},
        ColorFunction->RGBColor],
       BoxForm`ImageTag[
       "Byte", ColorSpace -> "RGB", ImageSize -> Automatic, Interleaving -> 
        True, Magnification -> Automatic],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJzt2c1JA1EYhtGBVCBWkErsQbABwXXq0Va0CRcudSMuQhAsQWZGXGS4Q2ZI
7u/5IJxkE7J4HwLJ9n53+7Dpum779+ifXw/3eXNs51zDF+ri472/b7JJl3bx
8tzfgSzKu+G+JuqCLRvqYvRtoi7YgrogdUHqglynLhjTpf8L6IItqAtdtGxu
O9cF7V8XjGOt+9cF7V8XnNf+59VF3dr/OnVRh/Z/XnVRlvYfR13kqf2nVRdp
tf881UUc7b8sdXFe7b8OdbFO+69bXYyGdm7/cbwa7nWiLtKqi7SGukjViy6Y
g0u7uHQvumAO+r4gT+8i1efRBakLUhfkOi/dxfz7kyV6ehfjr/o/QZ8e+9v/
vw69P1miv/4KkBw=
        "], {{0, 33}, {33, 0}}, {0., 1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4374999535166607`*^9, 3.437500061771063*^9}, {
   3.437500092322929*^9, 3.437500097014099*^9}, 3.4375035972588263`*^9, {
   3.437755156598366*^9, 
   3.4377551613108053`*^9}},ExpressionUUID->"3c5ca311-90cf-45cb-9dbf-\
d2e663625529"]
}, Closed]],

Cell[CellGroupData[{

Cell["Model", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4377434765872793`*^9, 
  3.4377434771533318`*^9}},ExpressionUUID->"941c16e2-e565-40e4-b1ab-\
503c7e9eef59"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EmptyModel", "[", "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437500952345409*^9, 3.4375009579593143`*^9}, {
   3.4375023742162037`*^9, 3.437502375418421*^9}, 3.43750359726017*^9, {
   3.437742507292304*^9, 
   3.437742507391426*^9}},ExpressionUUID->"f8082ea8-7cb1-423d-b79b-\
4a5d1a280795"]
}, Closed]],

Cell[CellGroupData[{

Cell["Selection", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4377434808738213`*^9, 
  3.437743482401539*^9}},ExpressionUUID->"efcf4b4b-13c7-484f-a31e-\
07646ff4df28"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EmptySelection", "[", "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437742709437436*^9, 
  3.437742744432748*^9}},ExpressionUUID->"f8d810c2-9c7b-47c6-9fa6-\
8c692cd24013"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddToSelection", "[", 
   RowBox[{"selection_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{"selection", ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", "x", "}"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437501031299095*^9, 3.437501059168251*^9}, {
   3.437502393086014*^9, 3.437502425253414*^9}, {3.437502486972677*^9, 
   3.437502487562374*^9}, 3.437502623388308*^9, 3.437503597264954*^9, {
   3.437503846836093*^9, 3.437503905955579*^9}, {3.437505418591053*^9, 
   3.437505419641109*^9}, {3.4377425470463333`*^9, 3.437742551957768*^9}, {
   3.437742622758005*^9, 3.437742633883368*^9}, {3.437743531793496*^9, 
   3.437743533236932*^9}, {3.437745814900343*^9, 
   3.437745819505034*^9}},ExpressionUUID->"0945eb45-67c7-4618-9af6-\
1021ba941fae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToggleSelection", "[", 
   RowBox[{"selection_", ",", " ", "x_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{"ToggleSelection", "[", 
   RowBox[{"selection", ",", 
    RowBox[{"{", "x", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437501031299095*^9, 3.437501059168251*^9}, {
   3.437502393086014*^9, 3.437502425253414*^9}, {3.437502486972677*^9, 
   3.437502487562374*^9}, 3.437502623388308*^9, 3.437503597264954*^9, {
   3.437503846836093*^9, 3.437503905955579*^9}, {3.437505418591053*^9, 
   3.437505419641109*^9}, {3.437505725212491*^9, 3.43750572701031*^9}, {
   3.437505809021784*^9, 3.437505811490819*^9}, {3.437506149862277*^9, 
   3.437506264269717*^9}, {3.437506379800364*^9, 3.437506447750174*^9}, {
   3.4377426629281607`*^9, 
   3.4377426676448298`*^9}},ExpressionUUID->"dffbdfae-c3ba-47b6-bc26-\
6cef9ed1886a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToggleSelection", "[", 
   RowBox[{"selection_", ",", " ", "x_List"}], "]"}], " ", ":=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{"Complement", "[", 
     RowBox[{"x", ",", "selection"}], "]"}], ",", 
    RowBox[{"Complement", "[", 
     RowBox[{"selection", ",", "x"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437501031299095*^9, 3.437501059168251*^9}, {
   3.437502393086014*^9, 3.437502425253414*^9}, {3.437502486972677*^9, 
   3.437502487562374*^9}, 3.437502623388308*^9, 3.437503597264954*^9, {
   3.437503846836093*^9, 3.437503905955579*^9}, {3.437505418591053*^9, 
   3.437505419641109*^9}, {3.437505725212491*^9, 3.43750572701031*^9}, {
   3.437505809021784*^9, 3.437505811490819*^9}, {3.437506149862277*^9, 
   3.437506264269717*^9}, {3.437506379800364*^9, 3.437506414437051*^9}, 
   3.437742556813877*^9, {3.437742669845852*^9, 
   3.437742685793872*^9}},ExpressionUUID->"50591de2-05b4-42ba-911f-\
199dbdef9ec0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteSelection", "[", 
   RowBox[{"model_", ",", " ", "selection_"}], "]"}], ":=", 
  RowBox[{"Complement", "[", 
   RowBox[{"model", ",", 
    RowBox[{"model", "[", 
     RowBox[{"[", "selection", "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4375077641489763`*^9, 3.437507874648446*^9}, {
  3.4375079046681747`*^9, 3.437507950652317*^9}, {3.437742559374625*^9, 
  3.437742560814587*^9}, {3.437742761291194*^9, 3.437742775417392*^9}, {
  3.438620773640362*^9, 
  3.4386207784928837`*^9}},ExpressionUUID->"b8e486fc-4067-4366-bfad-\
ac664d4ae5e5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Hit Testing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.437743552647397*^9, 
  3.43774355555504*^9}},ExpressionUUID->"c228bf32-5faa-4e63-a761-\
5cda595a7035"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Distance", "[", 
   RowBox[{"pt_", ",", 
    RowBox[{"Point", "[", "p_", "]"}]}], "]"}], ":=", 
  RowBox[{"Norm", "[", 
   RowBox[{"pt", "-", "p"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437504475034955*^9, 3.43750450239821*^9}, 
   3.437742784300452*^9},ExpressionUUID->"19b42c5a-0744-444d-89c3-\
3fb60c618183"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Distance", "[", 
   RowBox[{"pt_", ",", 
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", "r_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"pt", "-", "c"}], "]"}], "-", "r"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437504475034955*^9, 3.43750450239821*^9}, 
   3.437742784300452*^9, {3.438539009852784*^9, 
   3.4385390428652363`*^9}},ExpressionUUID->"753078ca-bd79-4de0-b575-\
eef6a9bbd4a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Distance", "[", 
   RowBox[{
    RowBox[{"p0", ":", 
     RowBox[{"{", 
      RowBox[{"x0_", ",", "y0_"}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lineLength", ",", "projectedLength", ",", "distance"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lineLength", " ", "=", " ", 
      RowBox[{"Norm", "[", 
       RowBox[{"p2", "-", "p1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"projectedLength", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p0", "-", "p2"}], ")"}], ".", 
       RowBox[{"Normalize", "[", 
        RowBox[{"p1", "-", "p2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"distance", " ", "=", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x1", "-", "x2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"y2", "-", "y0"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x2", "-", "x0"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"y1", "-", "y2"}], ")"}]}]}], "]"}], "/", "lineLength"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "head", ",", "\[IndentingNewLine]", "Line", ",", "\[IndentingNewLine]", 
       "\t", "distance", ",", "\[IndentingNewLine]", "LineSegment", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"projectedLength", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"p0", "-", "p2"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"projectedLength", "\[GreaterEqual]", "lineLength"}], ",", 
         RowBox[{"Norm", "[", 
          RowBox[{"p0", "-", "p1"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         "True", ",", "distance"}], "\[IndentingNewLine]", "\t", "]"}], ",", 
       "\[IndentingNewLine]", "Ray", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"projectedLength", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"p0", "-", "p2"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         "True", ",", "distance"}], "\[IndentingNewLine]", "\t", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437504475034955*^9, 3.43750450239821*^9}, 
   3.437742784300452*^9, {3.438539009852784*^9, 3.4385390687200203`*^9}, {
   3.438539358621131*^9, 3.438539367249992*^9}, {3.438539401828496*^9, 
   3.438539415569745*^9}, {3.4385395201245947`*^9, 3.4385398361904383`*^9}, {
   3.43853992219099*^9, 3.438539944398295*^9}, {3.4385399798422937`*^9, 
   3.438540113017658*^9}, 3.43854048216404*^9, {3.438540568597815*^9, 
   3.438540629946218*^9}, 3.438546673730146*^9, 3.438619297424663*^9, 
   3.438707641872541*^9, {3.4387077070081997`*^9, 
   3.4387077509481564`*^9}},ExpressionUUID->"b9646d82-cf6e-4582-8dd4-\
42ee725643b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetHit", "[", 
   RowBox[{"model_", ",", "pt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"distances", ",", "i", ",", 
      RowBox[{"hit", "=", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"minDist", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Scan", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dist", "=", 
            RowBox[{"Distance", "[", 
             RowBox[{"pt", ",", 
              RowBox[{"ObjectCache", "[", "#", "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"i", "++"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"ObjectCache", "[", "#", "]"}], "]"}], "===", 
               "Point"}], "&&", " ", 
              RowBox[{"dist", " ", "<", "minDist"}]}], ",", 
             RowBox[{
              RowBox[{"minDist", "=", "dist"}], ";", 
              RowBox[{"hit", "=", 
               RowBox[{"{", "i", "}"}]}]}]}], "]"}]}]}], "]"}], "&"}], ",", 
       " ", "model"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"hit", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Scan", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"dist", "=", 
               RowBox[{"Distance", "[", 
                RowBox[{"pt", ",", 
                 RowBox[{"ObjectCache", "[", "#", "]"}]}], "]"}]}], "}"}], 
             ",", 
             RowBox[{
              RowBox[{"i", "++"}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", 
                   RowBox[{"ObjectCache", "[", "#", "]"}], "]"}], "=!=", 
                  "Point"}], " ", "&&", " ", 
                 RowBox[{"dist", " ", "<", "minDist"}]}], ",", 
                RowBox[{
                 RowBox[{"minDist", "=", "dist"}], ";", 
                 RowBox[{"hit", "=", 
                  RowBox[{"{", "i", "}"}]}]}]}], "]"}]}]}], "]"}], "&"}], ",",
           " ", "model"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "hit"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437504010305636*^9, 3.437504037564495*^9}, {
   3.437504091555749*^9, 3.437504254463181*^9}, {3.437504299564233*^9, 
   3.437504338552395*^9}, {3.4375044404971027`*^9, 3.4375044694471407`*^9}, {
   3.437504524862914*^9, 3.4375045289379873`*^9}, {3.4375045606512537`*^9, 
   3.437504592555376*^9}, {3.4375046306517897`*^9, 3.437504891306437*^9}, {
   3.437505005719603*^9, 3.437505013131145*^9}, {3.43750507726471*^9, 
   3.437505092457881*^9}, {3.4375051942788*^9, 3.4375051962904577`*^9}, {
   3.437505236804706*^9, 3.4375052730752907`*^9}, {3.43750532546034*^9, 
   3.437505357275324*^9}, {3.437507225646703*^9, 3.437507305101554*^9}, 
   3.4377425623361387`*^9, {3.437742810227942*^9, 3.437742813449511*^9}, {
   3.438542635434086*^9, 3.4385426444060373`*^9}, {3.438543942347558*^9, 
   3.438543986339662*^9}, {3.438544176671698*^9, 3.438544239102388*^9}, {
   3.438544337152508*^9, 3.4385443767202044`*^9}, {3.438544409285563*^9, 
   3.438544459914879*^9}, {3.4385445247736797`*^9, 3.4385445376838512`*^9}, {
   3.4386082103778954`*^9, 3.438608217880265*^9}, 
   3.438608260519602*^9},ExpressionUUID->"2f36908e-7cbf-4dee-ae0f-\
6ee8a6a9ca62"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rendering", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4377435709987288`*^9, 
  3.437743571907508*^9}},ExpressionUUID->"2f37ef95-9f79-466d-ae50-\
5f179d856847"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderSelection", "[", 
   RowBox[{"model_", ",", " ", "selection_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "=", "3"}], ",", 
      RowBox[{"f", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Magenta", ",", 
      RowBox[{"AbsoluteThickness", "[", 
       RowBox[{"2", "d"}], "]"}], ",", 
      RowBox[{"Opacity", "[", ".5", "]"}], ",", 
      RowBox[{"AbsolutePointSize", "[", 
       RowBox[{"4", "d"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"First", " ", "/@", " ", 
         RowBox[{"model", "[", 
          RowBox[{"[", "selection", "]"}], "]"}]}], ")"}], "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"LineSegment", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p2", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p2", "-", "p1"}], ")"}]}]}], ",", 
             RowBox[{"p1", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p1", "-", "p2"}], ")"}]}]}]}], "}"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Ray", "[", 
           RowBox[{"{", 
            RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"p2", ",", 
             RowBox[{"p1", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p1", "-", "p2"}], ")"}]}]}]}], "}"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4375015442784147`*^9, 3.437501555753519*^9}, {
   3.437501674179842*^9, 3.437501735944624*^9}, {3.4375024340156527`*^9, 
   3.437502438767148*^9}, {3.437502731309273*^9, 3.437502737618965*^9}, {
   3.437502775648815*^9, 3.4375028062654057`*^9}, {3.437502999767145*^9, 
   3.437503052796487*^9}, {3.437503088538311*^9, 3.43750309642844*^9}, {
   3.437503210760455*^9, 3.437503239503664*^9}, {3.4375033198236847`*^9, 
   3.437503337725197*^9}, 3.437503597266593*^9, {3.437742563558565*^9, 
   3.4377425646821423`*^9}, {3.437742859798058*^9, 3.437742876515316*^9}, {
   3.437742918801999*^9, 3.437742933730291*^9}, {3.438540723783733*^9, 
   3.4385407308272676`*^9}, {3.4385408491678143`*^9, 3.438540849307715*^9}, {
   3.438540901276237*^9, 3.438540908773099*^9}, {3.438540941758527*^9, 
   3.438540974206924*^9}, {3.438541005713826*^9, 3.438541023932579*^9}, {
   3.438541138915421*^9, 3.438541232409707*^9}, {3.438541265187766*^9, 
   3.438541291374963*^9}, {3.438541355531155*^9, 3.43854143808849*^9}, {
   3.438541471345441*^9, 3.43854162745737*^9}, 3.4385421599381647`*^9, {
   3.4385423588899384`*^9, 3.438542392132148*^9}, {3.438542436484004*^9, 
   3.43854245368261*^9}, 3.438707889976948*^9, {3.4387721182406273`*^9, 
   3.438772147268852*^9}, {3.438772230436761*^9, 3.438772237696795*^9}, 
   3.438772529646627*^9},ExpressionUUID->"58d59097-c172-4d35-85ca-\
d7befe36d342"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EmptyTrace", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", "Red", ",", 
      RowBox[{"Point", "[", 
       RowBox[{"{", "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LineColor", "[", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CircleColor", "[", "]"}], ",", 
      RowBox[{"{", "}"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438777329691296*^9, 3.438777357063755*^9}, {
  3.438777420333824*^9, 
  3.4387774641590443`*^9}},ExpressionUUID->"fc582375-36e2-4214-89a8-\
bb9c162301c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdateTrace", "[", 
   RowBox[{"model_", ",", " ", "tracedObjectIndices_", ",", "trace_"}], "]"}],
   ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "points", ",", " ", "lines", ",", "lineSegments", ",", "rays", ",", " ", 
      "circles", ",", "tracedObjects", ",", " ", "tracePoints", ",", 
      "traceLines", ",", "traceCircles"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tracedObjects", " ", "=", " ", 
      RowBox[{"model", "[", 
       RowBox[{"[", "tracedObjectIndices", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"points", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"tracedObjects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "===", "Point"}], ")"}],
           "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"tracedObjects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "===", "Line"}], ")"}], 
          "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p1", "=", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"p2", "=", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p1", "+", 
             RowBox[{"100", 
              RowBox[{"(", 
               RowBox[{"p1", "-", "p2"}], ")"}]}]}], ",", 
            RowBox[{"p2", "+", 
             RowBox[{"100", 
              RowBox[{"(", 
               RowBox[{"p2", "-", "p1"}], ")"}]}]}]}], "}"}]}], "]"}], "&"}], 
       " ", "/@", " ", "lines"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lineSegments", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"tracedObjects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "===", "LineSegment"}], 
           ")"}], "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rays", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"tracedObjects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "===", "Ray"}], ")"}], 
          "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rays", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p1", "=", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"p2", "=", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p1", "+", 
             RowBox[{"100", 
              RowBox[{"(", 
               RowBox[{"p1", "-", "p2"}], ")"}]}]}], ",", "p2"}], "}"}]}], 
         "]"}], "&"}], " ", "/@", " ", "rays"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"circles", "=", 
      RowBox[{"First", " ", "/@", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"tracedObjects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "===", "Circle"}], 
           ")"}], "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tracePoints", " ", "=", " ", 
      RowBox[{"trace", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"traceLines", "=", " ", 
      RowBox[{"trace", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"traceCircles", "=", " ", 
      RowBox[{"trace", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"trace", ",", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"Join", "[", 
           RowBox[{"tracePoints", ",", "points"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"Join", "[", 
           RowBox[{
           "traceLines", ",", "lines", ",", "lineSegments", ",", "rays"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"-", "1"}]}], "}"}], "\[Rule]", 
          RowBox[{"Join", "[", 
           RowBox[{"traceCircles", ",", "circles"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4387774737218227`*^9, 3.438777605554153*^9}, {
   3.438777737136505*^9, 3.438778048482333*^9}, {3.43877815498564*^9, 
   3.4387781560842743`*^9}, {3.4387782049771967`*^9, 3.4387782615478*^9}, {
   3.438778337644403*^9, 3.4387783407685347`*^9}, {3.4387783911972027`*^9, 
   3.4387783992716513`*^9}, {3.438778438033197*^9, 3.438778442371561*^9}, 
   3.438778483789212*^9, {3.438779371947755*^9, 3.438779439693397*^9}, {
   3.438779474380765*^9, 3.438779556595406*^9}, {3.438779612787764*^9, 
   3.438779616550653*^9}},ExpressionUUID->"0e35eb0f-a183-4acb-ab1d-\
27c00ff50bb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderHighlight", "[", 
   RowBox[{"model_", ",", "selection_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "=", "3"}], ",", 
      RowBox[{"f", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"AbsoluteThickness", "[", "d", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"First", " ", "/@", " ", 
         RowBox[{"model", "[", 
          RowBox[{"[", "selection", "]"}], "]"}]}], ")"}], "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Point", "[", "p_", "]"}], "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{"Circle", "[", 
            RowBox[{"p", ",", 
             RowBox[{"Offset", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d", "+", "2.5"}], ")"}], 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LineSegment", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p2", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p2", "-", "p1"}], ")"}]}]}], ",", 
             RowBox[{"p1", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p1", "-", "p2"}], ")"}]}]}]}], "}"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Ray", "[", 
           RowBox[{"{", 
            RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"p2", ",", 
             RowBox[{"p1", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p1", "-", "p2"}], ")"}]}]}]}], "}"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4375015442784147`*^9, 3.437501555753519*^9}, {
   3.437501674179842*^9, 3.437501735944624*^9}, {3.4375024340156527`*^9, 
   3.437502438767148*^9}, {3.437502731309273*^9, 3.437502737618965*^9}, {
   3.437502775648815*^9, 3.4375028062654057`*^9}, {3.437502999767145*^9, 
   3.437503052796487*^9}, {3.437503088538311*^9, 3.43750309642844*^9}, {
   3.437503210760455*^9, 3.437503239503664*^9}, {3.4375033198236847`*^9, 
   3.437503337725197*^9}, 3.437503597266593*^9, {3.437742563558565*^9, 
   3.4377425646821423`*^9}, {3.437742859798058*^9, 3.437742876515316*^9}, {
   3.437742918801999*^9, 3.437742933730291*^9}, {3.438540723783733*^9, 
   3.4385407308272676`*^9}, {3.4385408491678143`*^9, 3.438540849307715*^9}, {
   3.438540901276237*^9, 3.438540908773099*^9}, {3.438540941758527*^9, 
   3.438540974206924*^9}, {3.438541005713826*^9, 3.438541023932579*^9}, {
   3.438541138915421*^9, 3.438541232409707*^9}, {3.438541265187766*^9, 
   3.438541291374963*^9}, {3.438541355531155*^9, 3.43854143808849*^9}, {
   3.438541471345441*^9, 3.43854162745737*^9}, 3.4385421599381647`*^9, {
   3.4385423588899384`*^9, 3.438542392132148*^9}, {3.438542436484004*^9, 
   3.43854245368261*^9}, {3.438707804149481*^9, 
   3.438707834369779*^9}},ExpressionUUID->"6e50d797-332c-469d-8244-\
1c742e750b8d"]
}, Closed]],

Cell[CellGroupData[{

Cell["RunModel", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.437743596661104*^9, 3.437743603764023*^9}, 
   3.43860504980466*^9, {3.438609899358684*^9, 3.4386098995997972`*^9}, {
   3.438610080754939*^9, 
   3.4386100818558493`*^9}},ExpressionUUID->"ac4475ca-a7eb-4793-81a7-\
e4c002dcefa5"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "RunModel", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4385388963781548`*^9, 3.438538898398457*^9}, {
   3.438542743139359*^9, 3.438542744372753*^9}, 3.438609906526318*^9, 
   3.4386100838304243`*^9, {3.438610150516974*^9, 
   3.43861015208854*^9}},ExpressionUUID->"5553764d-fd35-44f1-bc78-\
846bb0230b01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RunModel", "[", "fileName_String", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"RunModel", "[", 
   RowBox[{"ImportModel", "[", 
    RowBox[{"fileName", ",", 
     RowBox[{"IncludeSize", "\[Rule]", "True"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43861010625784*^9, 
  3.438610135554914*^9}},ExpressionUUID->"735d2f3d-808d-499c-bd47-\
f4fd5e432634"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RunModel", "[", "inputModel_List", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"RunModel", "[", 
   RowBox[{"{", 
    RowBox[{"inputModel", ",", " ", 
     RowBox[{"400", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}]}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438607970066473*^9, 3.4386079868137197`*^9}, {
  3.4386080255192003`*^9, 3.438608061951085*^9}, {3.438609764278529*^9, 
  3.4386097648971577`*^9}, {3.438609907149726*^9, 3.438609907789493*^9}, {
  3.438610084503449*^9, 
  3.438610084950871*^9}},ExpressionUUID->"42cd0506-7ffc-4c63-b019-\
77de1582d931"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RunModel", "[", 
    RowBox[{"{", 
     RowBox[{"inputModel_List", ",", 
      RowBox[{"{", 
       RowBox[{"width_Integer", ",", "height_Integer"}], "}"}]}], "}"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"selection", "=", 
        RowBox[{"EmptySelection", "[", "]"}]}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"the", " ", 
         RowBox[{"selection", " ", "--"}], " ", "a", " ", "list", " ", "of", 
         " ", "object", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mouseDownHit", "=", 
        RowBox[{"EmptySelection", "[", "]"}]}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "the", " ", "object", " ", "hit", " ", "by", " ", "a", " ", 
          "mouse"}], "-", "down"}], " ", "*)"}], "\[IndentingNewLine]", 
       "mouseDownPosition", ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "the", " ", "position", " ", "of", " ", "the", " ", "last", " ", 
          "mouse"}], "-", "down"}], " ", "*)"}], "\[IndentingNewLine]", 
       "mousePosition", ",", 
       RowBox[{"(*", " ", 
        RowBox[{"the", " ", "current", " ", "mouse", " ", "position"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"initialModel", " ", "=", " ", "inputModel"}], ",", 
       "\[IndentingNewLine]", "mouseDownModel", ",", "\[IndentingNewLine]", 
       RowBox[{"model", "=", "inputModel"}], ",", "\[IndentingNewLine]", 
       "mouseDownOnSelection", ",", "\[IndentingNewLine]", 
       "mouseDownShiftKey", ",", "\[IndentingNewLine]", "mouseDidDrag", ",", 
       "\[IndentingNewLine]", "firstDrag", ",", "\[IndentingNewLine]", 
       RowBox[{"displayTransform", "=", 
        RowBox[{"Composition", "[", 
         RowBox[{
          RowBox[{"TranslationTransform", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "height"}], "}"}], "]"}], ",", 
          RowBox[{"ScalingTransform", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"hitTransform", " ", "=", " ", 
        RowBox[{"Composition", "[", 
         RowBox[{
          RowBox[{"ScalingTransform", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
          RowBox[{"TranslationTransform", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "height"}]}], "}"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dragTransform", " ", "=", " ", 
        RowBox[{"ScalingTransform", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"tracedObjects", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"trace", "=", 
        RowBox[{"EmptyTrace", "[", "]"}]}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Column", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Trace\>\"", ",", 
                  RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"tracedObjects", "=", "selection"}], ")"}], "&"}], 
                ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"33", ",", "33"}], "}"}]}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Erase\\nTrace\>\"", ",", 
                  RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"trace", "=", 
                   RowBox[{"EmptyTrace", "[", "]"}]}], ")"}], "&"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"33", ",", "33"}], "}"}]}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], "]"}],
               ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Reset\>\"", ",", 
                  RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"model", "=", "initialModel"}], ";", 
                   RowBox[{"selection", "=", 
                    RowBox[{"EmptySelection", "[", "]"}]}]}], ")"}], "&"}], 
                ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"33", ",", "33"}], "}"}]}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], 
               "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\"\<Center\>\"", 
            ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Framed", "[", 
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"RenderModel", "[", "model", "]"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"RenderSelection", "[", 
                    RowBox[{"model", ",", "selection"}], "]"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Dynamic", "[", "trace", "]"}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "displayTransform"}], 
                "]"}], ",", " ", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "width"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "height"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"width", ",", "height"}], "}"}]}]}], "]"}], "]"}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<MouseDown\>\"", "\[RuleDelayed]", "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"mousePosition", " ", "=", " ", 
                RowBox[{"mouseDownPosition", "=", 
                 RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"mouseDownModel", "=", "model"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"mouseDownHit", "=", 
                RowBox[{"GetHit", "[", 
                 RowBox[{"model", ",", 
                  RowBox[{"hitTransform", "[", "mouseDownPosition", "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"mouseDownOnSelection", "=", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Intersection", "[", 
                   RowBox[{"selection", ",", "mouseDownHit"}], "]"}], "=!=", 
                  RowBox[{"{", "}"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"selection", " ", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"mouseDownHit", "===", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{"EmptySelection", "[", "]"}], " ", ",", 
                  RowBox[{"Union", "[", 
                   RowBox[{"selection", ",", "mouseDownHit"}], "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"firstDrag", "=", "True"}], ";", "\[IndentingNewLine]", 
               RowBox[{"mouseDidDrag", "=", "False"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"mouseDownShiftKey", "=", 
                RowBox[{"CurrentValue", "[", "\"\<ShiftKey\>\"", "]"}]}], 
               ";"}], "\[IndentingNewLine]", ")"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"\"\<MouseUp\>\"", "\[RuleDelayed]", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"!", "mouseDidDrag"}], " ", "&&", " ", 
                 "mouseDownOnSelection"}], ",", "\[IndentingNewLine]", 
                RowBox[{"selection", "=", 
                 RowBox[{"ToggleSelection", "[", 
                  RowBox[{"selection", ",", "mouseDownHit"}], "]"}]}]}], 
               "]"}], "\[IndentingNewLine]", ")"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"\"\<MouseDragged\>\"", "\[RuleDelayed]", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"!", "mouseDownOnSelection"}], " ", "&&", " ", 
                  RowBox[{"!", "mouseDownShiftKey"}]}], ",", 
                 RowBox[{"selection", "=", "mouseDownHit"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"mouseDidDrag", "=", "True"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"firstDrag", "=", "False"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newPosition", "=", 
                   RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"model", " ", "=", " ", 
                   RowBox[{"Drag", "[", 
                    RowBox[{"mouseDownModel", ",", "selection", ",", " ", 
                    RowBox[{"TranslationTransform", "[", 
                    RowBox[{"dragTransform", "[", 
                    RowBox[{"mousePosition", "-", "mouseDownPosition"}], 
                    "]"}], "]"}]}], "]"}]}], ";", 
                  RowBox[{"mousePosition", "=", "newPosition"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"trace", "=", 
                RowBox[{"UpdateTrace", "[", 
                 RowBox[{"model", ",", " ", "tracedObjects", ",", "trace"}], 
                 "]"}]}]}], "\[IndentingNewLine]", ")"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "}"}], "}"}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Top"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4375002663012*^9, 3.4375003812408247`*^9}, {
   3.437500425049573*^9, 3.4375004379709377`*^9}, {3.437500499117703*^9, 
   3.4375005412443542`*^9}, {3.437500633485072*^9, 3.437500684310215*^9}, {
   3.4375008157972507`*^9, 3.437500890994378*^9}, {3.437500935854273*^9, 
   3.437500944198483*^9}, {3.437501068468761*^9, 3.4375011289941473`*^9}, {
   3.43750120300484*^9, 3.437501265658649*^9}, {3.437501305615797*^9, 
   3.437501314372808*^9}, {3.437501346531198*^9, 3.437501351256783*^9}, {
   3.4375014018433857`*^9, 3.437501430843755*^9}, {3.4375014964144783`*^9, 
   3.4375015405653963`*^9}, {3.43750158468701*^9, 3.437501586811016*^9}, {
   3.437501622611259*^9, 3.437501633323935*^9}, {3.437501773859486*^9, 
   3.437501821278665*^9}, {3.437503505648514*^9, 3.437503533304042*^9}, 
   3.43750359726862*^9, {3.437503709281452*^9, 3.437503775818654*^9}, 
   3.437503856451627*^9, {3.437503958814726*^9, 3.437503993272477*^9}, {
   3.437505663366808*^9, 3.437505692817478*^9}, 3.437506664931131*^9, {
   3.437506742281349*^9, 3.4375067589860563`*^9}, {3.437506834432221*^9, 
   3.437506967515657*^9}, {3.437507626342515*^9, 3.437507649812776*^9}, {
   3.437507692785985*^9, 3.4375077103396072`*^9}, {3.437507995665222*^9, 
   3.437507999426758*^9}, {3.437508035210587*^9, 3.4375080431329*^9}, {
   3.437508181457697*^9, 3.437508279159712*^9}, {3.437508355149135*^9, 
   3.437508394687948*^9}, {3.4375084285269327`*^9, 3.4375084853112373`*^9}, {
   3.437508620997967*^9, 3.4375086288354588`*^9}, {3.437508680510249*^9, 
   3.437508705037176*^9}, {3.437508769193334*^9, 3.437508813575808*^9}, {
   3.437508939073612*^9, 3.437508972508745*^9}, {3.437509010899393*^9, 
   3.43750921576213*^9}, {3.437509636363247*^9, 3.4375096471531343`*^9}, 
   3.437510172413702*^9, {3.4377416110776587`*^9, 3.437741648034952*^9}, {
   3.437741707755509*^9, 3.437741715548791*^9}, 3.4377420539184093`*^9, {
   3.4377427280710783`*^9, 3.4377427329879017`*^9}, {3.437743181474278*^9, 
   3.437743187776949*^9}, 3.437743503414969*^9, {3.437744976183159*^9, 
   3.437745041141139*^9}, {3.4377450792492113`*^9, 3.437745112047806*^9}, {
   3.4377451785864897`*^9, 3.437745179608369*^9}, {3.437745232113224*^9, 
   3.4377452605108757`*^9}, {3.4377452939135847`*^9, 
   3.4377453506472187`*^9}, {3.43774541732605*^9, 3.437745427804431*^9}, {
   3.437745498779994*^9, 3.4377455001469307`*^9}, {3.437745546442607*^9, 
   3.437745586805105*^9}, {3.437745619650354*^9, 3.4377456709993753`*^9}, {
   3.437745702705138*^9, 3.437745781476171*^9}, {3.437745881972415*^9, 
   3.4377458986495247`*^9}, {3.437745934183773*^9, 3.4377459349286823`*^9}, {
   3.43774599687715*^9, 3.4377460563661623`*^9}, {3.4377460963196287`*^9, 
   3.437746148865623*^9}, {3.437746183299708*^9, 3.437746212059169*^9}, {
   3.437746253757443*^9, 3.437746255421741*^9}, {3.4377463098093147`*^9, 
   3.4377463531510487`*^9}, {3.437746601364925*^9, 3.437746628433075*^9}, {
   3.4377466592727547`*^9, 3.43774667437673*^9}, {3.43774671196769*^9, 
   3.437746777959824*^9}, {3.437746809231202*^9, 3.4377468129739847`*^9}, {
   3.437753841447445*^9, 3.437753855162889*^9}, {3.437753959147608*^9, 
   3.437754192065774*^9}, {3.437754228691472*^9, 3.437754229369687*^9}, {
   3.4377544067583838`*^9, 3.4377545206856833`*^9}, {3.437755172356642*^9, 
   3.437755192190811*^9}, {3.438003521206401*^9, 3.438003528973238*^9}, {
   3.438003571069901*^9, 3.438003573100868*^9}, 3.438449445972126*^9, {
   3.43844997783937*^9, 3.43844998029587*^9}, {3.4385383830704527`*^9, 
   3.438538385569304*^9}, {3.4385384279804087`*^9, 3.438538433866744*^9}, {
   3.438538746704299*^9, 3.4385387617995367`*^9}, {3.438538837168745*^9, 
   3.438538917699238*^9}, {3.438542531119381*^9, 3.438542569639758*^9}, {
   3.438542749769402*^9, 3.438542751423173*^9}, {3.438542791636469*^9, 
   3.438542832406077*^9}, 3.438542870493827*^9, {3.4385429644169407`*^9, 
   3.4385429827945337`*^9}, {3.438543313866194*^9, 3.43854334288907*^9}, {
   3.438543560832305*^9, 3.4385435923400517`*^9}, 3.4385447166812162`*^9, {
   3.438544780349284*^9, 3.438544804041019*^9}, {3.438545895772765*^9, 
   3.438545896921274*^9}, {3.438607960516882*^9, 3.438607967147827*^9}, {
   3.4386080082672*^9, 3.438608021239819*^9}, {3.438608075111355*^9, 
   3.4386080876400757`*^9}, {3.438609766966124*^9, 3.438609767459737*^9}, 
   3.4386099085763493`*^9, 3.4386100854816713`*^9, {3.4386102229857693`*^9, 
   3.43861022744655*^9}, {3.4386109287044373`*^9, 3.4386109466654587`*^9}, {
   3.438619828016892*^9, 3.438619855612352*^9}, 3.438619908811245*^9, {
   3.438619999602721*^9, 3.438620119756544*^9}, {3.438620156549519*^9, 
   3.438620165784525*^9}, {3.438620379521585*^9, 3.438620410799474*^9}, {
   3.438620493743964*^9, 3.438620512975369*^9}, {3.438620564561726*^9, 
   3.43862057262337*^9}, 3.438620616475009*^9, {3.4386206601120253`*^9, 
   3.438620741187066*^9}, {3.438620802321494*^9, 3.4386208163035927`*^9}, 
   3.438620870446885*^9, {3.4386209283402567`*^9, 3.4386209298945312`*^9}, {
   3.438620985171672*^9, 3.438621012571272*^9}, {3.438621143892762*^9, 
   3.438621145011228*^9}, {3.438621272093696*^9, 3.438621305430963*^9}, 
   3.438621933810597*^9, {3.4386909142888317`*^9, 3.438690993683264*^9}, {
   3.438691288751878*^9, 3.438691299793895*^9}, {3.4386913748405657`*^9, 
   3.438691420312419*^9}, {3.438691472104802*^9, 3.4386915341903353`*^9}, {
   3.4387714321136293`*^9, 3.4387714452488947`*^9}, {3.4387715295818243`*^9, 
   3.438771549675949*^9}, {3.4387715905688334`*^9, 3.438771604607419*^9}, {
   3.438771646179389*^9, 3.4387716467030573`*^9}, {3.438771684913192*^9, 
   3.438771747309639*^9}, {3.438771791428928*^9, 3.438771819823378*^9}, {
   3.4387719095620527`*^9, 3.438771924907256*^9}, {3.438772183027549*^9, 
   3.4387721922791224`*^9}, {3.438772305206767*^9, 3.43877230634093*^9}, {
   3.4387724971204557`*^9, 3.4387724983251743`*^9}, 3.438772684574505*^9, 
   3.438773102705072*^9, {3.438775691688053*^9, 3.4387757942643023`*^9}, {
   3.43877584025244*^9, 3.438775843578343*^9}, {3.438775881684351*^9, 
   3.43877588807141*^9}, {3.438775924679216*^9, 3.4387759942976093`*^9}, {
   3.43877606811917*^9, 3.438776095153096*^9}, {3.438776351084992*^9, 
   3.43877635289363*^9}, {3.438776872159309*^9, 3.438776878693594*^9}, 
   3.43877691166973*^9, {3.438777102532218*^9, 3.438777103615714*^9}, {
   3.438777260226563*^9, 3.438777313387286*^9}, {3.4387775024423723`*^9, 
   3.438777503728923*^9}, {3.438779783708444*^9, 
   3.4387797972982492`*^9}},ExpressionUUID->"96b87a07-20af-4149-a49d-\
4b30016e1f0b"]
}, Closed]]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{981, 847},
WindowMargins->{{Automatic, 179}, {Automatic, 58}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait"},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 341, 5, 98, "Title",ExpressionUUID->"a4640f93-e7dc-406f-8b76-a6edd1874fbb"],
Cell[911, 29, 180, 3, 31, "Subsubtitle",ExpressionUUID->"35e3879c-55b8-4cbd-8f42-505c425429cc"],
Cell[1094, 34, 786, 17, 127, "Text",ExpressionUUID->"54bfb705-efca-40d0-9304-e156eeded9bd"],
Cell[CellGroupData[{
Cell[1905, 55, 179, 3, 67, "Section",ExpressionUUID->"afe4804d-c564-42d4-b268-53fee723c7ba"],
Cell[CellGroupData[{
Cell[2109, 62, 204, 3, 54, "Subsection",ExpressionUUID->"c21d4703-7857-4da5-b570-713c3226d776"],
Cell[2316, 67, 327, 6, 58, "Text",ExpressionUUID->"454b1e5e-bdaa-4907-8d64-4fc42236cd04"],
Cell[2646, 75, 364, 7, 58, "Text",ExpressionUUID->"61ac282b-55f5-4959-aba8-feac89808b56"],
Cell[3013, 84, 402, 8, 58, "Text",ExpressionUUID->"4433b4d9-2f5a-410a-89fb-3471b2b88627"],
Cell[3418, 94, 203, 3, 35, "Text",ExpressionUUID->"9f78930b-1ecb-4c85-b102-7dc9b1dcadf1"],
Cell[3624, 99, 359, 7, 58, "Text",ExpressionUUID->"cc758185-97ed-48a8-9809-828c55421488"],
Cell[3986, 108, 272, 6, 35, "Text",ExpressionUUID->"27709269-2493-44ec-bda6-7b620a52b280"],
Cell[4261, 116, 345, 7, 58, "Text",ExpressionUUID->"6865e6ee-dd6f-4dde-b781-9c10ea65e1ed"],
Cell[4609, 125, 290, 6, 35, "Text",ExpressionUUID->"b4d33bfd-ad14-47f7-94a5-3dd1ab21752a"],
Cell[4902, 133, 297, 6, 35, "Text",ExpressionUUID->"4b4638f1-a79b-432e-9d21-45feab0a7648"],
Cell[5202, 141, 405, 8, 58, "Text",ExpressionUUID->"570b6704-e128-43dc-b524-437c5243e430"],
Cell[5610, 151, 388, 10, 58, "Text",ExpressionUUID->"122611f2-fd99-4b77-9b2c-6588ae1b507e"],
Cell[6001, 163, 322, 7, 58, "Text",ExpressionUUID->"18413670-6ba9-4f63-b8cd-692625a878ce"],
Cell[6326, 172, 788, 15, 104, "Text",ExpressionUUID->"d66b16ad-255f-41e0-94cb-480b6240104f"],
Cell[7117, 189, 321, 7, 35, "Text",ExpressionUUID->"dd90fc41-d187-4b77-b5fc-3a62dffcc31a"]
}, Closed]],
Cell[CellGroupData[{
Cell[7475, 201, 184, 3, 38, "Subsection",ExpressionUUID->"77ca1ac3-c041-447e-b2ae-7c2d5ca324ff"],
Cell[7662, 206, 283, 6, 35, "Text",ExpressionUUID->"ed15fd70-66d7-45b2-836c-d9b40a0e4ca7"],
Cell[7948, 214, 381, 8, 58, "Text",ExpressionUUID->"e0b3a6e8-1ae6-46ec-a6a1-98b30ab0e7d0"]
}, Closed]],
Cell[CellGroupData[{
Cell[8366, 227, 207, 3, 38, "Subsection",ExpressionUUID->"8accb375-fd64-4b06-a57e-eb6d731b395e"],
Cell[8576, 232, 430, 8, 58, "Text",ExpressionUUID->"6f87ce50-0143-4547-9127-e9b6b888552c"],
Cell[9009, 242, 275, 6, 35, "Text",ExpressionUUID->"05a3d56e-3b40-4374-8892-9401a1950a85"]
}, Closed]],
Cell[CellGroupData[{
Cell[9321, 253, 163, 3, 38, "Subsection",ExpressionUUID->"c030f226-b881-4c70-b944-5a46f8f6fc8b"],
Cell[9487, 258, 2860, 66, 383, "Input",ExpressionUUID->"15f00648-abbd-4f5a-ad93-9600234c5da8"]
}, Closed]],
Cell[CellGroupData[{
Cell[12384, 329, 170, 3, 38, "Subsection",ExpressionUUID->"0bb240a4-20f2-4715-b00c-674812fd8d2d"],
Cell[12557, 334, 189, 3, 35, "Text",ExpressionUUID->"c4627b7d-b8bc-4421-8276-0036a4f2bebb"],
Cell[12749, 339, 499, 11, 35, "Text",ExpressionUUID->"076080ac-96ac-43ac-87e9-06e4fa88ed9d"],
Cell[13251, 352, 164, 3, 35, "Text",ExpressionUUID->"bc73f400-8532-4ceb-98bc-f5fe60711706"],
Cell[13418, 357, 586, 11, 35, "Text",ExpressionUUID->"daf973e9-3886-4936-ba56-24576948e08b"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[14053, 374, 150, 3, 53, "Section",ExpressionUUID->"62b865fe-d200-408e-b3e1-624f7870a480"],
Cell[CellGroupData[{
Cell[14228, 381, 153, 3, 54, "Subsection",ExpressionUUID->"4281c50e-90ca-49d6-a3a7-52d47f63273f"],
Cell[CellGroupData[{
Cell[14406, 388, 166, 3, 45, "Subsubsection",ExpressionUUID->"deb8e877-ed04-444f-9fad-40da19f22989"],
Cell[14575, 393, 319, 7, 35, "Text",ExpressionUUID->"2f457843-bab5-4b0f-9c74-e0570fc9f5fc"],
Cell[14897, 402, 245, 6, 35, "Text",ExpressionUUID->"78e011ba-641e-4ba9-9f5f-55ab272d623c"]
}, Closed]],
Cell[CellGroupData[{
Cell[15179, 413, 166, 3, 45, "Subsubsection",ExpressionUUID->"3cd0919e-e4b7-4775-bc3c-87d47fb1617f"],
Cell[15348, 418, 169, 3, 35, "Text",ExpressionUUID->"163a3051-d28c-4c3c-ac8c-e5d027227d00"],
Cell[15520, 423, 181, 3, 35, "Text",ExpressionUUID->"d3e36572-2e09-41e7-8b78-1c4bc929168f"],
Cell[15704, 428, 331, 5, 35, "Text",ExpressionUUID->"64948ef7-191c-4768-9877-57f30682fd3f"],
Cell[16038, 435, 683, 12, 35, "Text",ExpressionUUID->"b98ecdaf-7cea-4315-9ea6-516fa062ca7f"]
}, Closed]],
Cell[CellGroupData[{
Cell[16758, 452, 163, 3, 45, "Subsubsection",ExpressionUUID->"4f046a2a-4af7-49f1-ba0e-b1f9594e6ea7"],
Cell[16924, 457, 174, 3, 35, "Text",ExpressionUUID->"bfc1638b-7890-448e-8a9c-19e2d3172599"],
Cell[17101, 462, 189, 3, 35, "Text",ExpressionUUID->"9f7610d5-42f1-405d-8ded-99bee2f0f462"],
Cell[17293, 467, 202, 3, 35, "Text",ExpressionUUID->"953da44c-b85e-4b82-a72f-8d9f74c96eaf"],
Cell[17498, 472, 252, 6, 35, "Text",ExpressionUUID->"d4e82f2d-0b83-4b1c-904b-d9d0d183562c"],
Cell[17753, 480, 292, 4, 35, "Text",ExpressionUUID->"6f46aa4d-8898-439f-836c-38865abf21ba"],
Cell[18048, 486, 626, 9, 35, "Text",ExpressionUUID->"7cd8b805-0834-422c-86e5-c177a746c106"],
Cell[18677, 497, 332, 5, 35, "Text",ExpressionUUID->"dd8e73eb-47dd-44f5-bb73-e9d39dd0f621"]
}, Closed]],
Cell[19024, 505, 164, 3, 45, "Subsubsection",ExpressionUUID->"c8f6c7d6-86f9-4f28-9fb8-48c5b876f23a"]
}, Closed]],
Cell[CellGroupData[{
Cell[19225, 513, 153, 3, 38, "Subsection",ExpressionUUID->"e2b16141-1d61-44cf-b4a0-c95258c362c0"],
Cell[19381, 518, 226, 4, 35, "Text",ExpressionUUID->"5b8da94d-6d42-43c5-90ae-36716d18f0d1"],
Cell[19610, 524, 185, 3, 35, "Text",ExpressionUUID->"b973376d-e438-49d3-916f-fbe8953f64ef"],
Cell[19798, 529, 622, 10, 81, "Text",ExpressionUUID->"36312e2a-a869-4c42-81b7-3e22f5e8a0bd"],
Cell[20423, 541, 427, 8, 58, "Text",ExpressionUUID->"81e8fb94-4f07-4b32-98c3-a56225d81c69"],
Cell[20853, 551, 237, 4, 35, "Text",ExpressionUUID->"4a4a19f1-afcc-4ca5-a2fc-1a0dc48923a3"],
Cell[21093, 557, 203, 3, 35, "Text",ExpressionUUID->"b672a71a-4686-4ea8-a3dd-ce85142905a5"],
Cell[21299, 562, 204, 3, 35, "Text",ExpressionUUID->"37d72f8c-aab4-4eee-adb5-a5ac8ec7cfc2"],
Cell[21506, 567, 239, 5, 35, "Text",ExpressionUUID->"37969a60-2d5b-4b27-a6a2-3b0d7a8d090a"],
Cell[21748, 574, 214, 3, 35, "Text",ExpressionUUID->"5a8063f6-50e0-486c-8198-d8029b6c3923"],
Cell[21965, 579, 241, 4, 35, "Text",ExpressionUUID->"65333d90-0d6e-43b8-9db6-01c39573d2a4"],
Cell[22209, 585, 245, 4, 35, "Text",ExpressionUUID->"fe85a778-6cb5-423f-9807-f1fc43fee5d8"],
Cell[22457, 591, 614, 9, 35, "Text",ExpressionUUID->"c94ffae6-3fa0-4358-a392-d68e9677971a"],
Cell[23074, 602, 607, 9, 35, "Text",ExpressionUUID->"b0cda947-3b95-4a1f-a6c4-2d27591d361f"],
Cell[23684, 613, 610, 9, 35, "Text",ExpressionUUID->"7a28c988-4497-4f6d-8f33-a86a42c6d775"],
Cell[24297, 624, 271, 6, 35, "Text",ExpressionUUID->"efc1aafe-fa94-4be3-b450-f55b6cf04f3d"],
Cell[24571, 632, 307, 6, 35, "Text",ExpressionUUID->"224759f2-d920-4461-b03a-37722474f198"],
Cell[24881, 640, 319, 5, 35, "Text",ExpressionUUID->"57444c38-1bae-43c0-9e0a-a21bda4ee2c0"],
Cell[25203, 647, 293, 5, 35, "Text",ExpressionUUID->"eef91ff4-4c18-4bb9-a36a-7d237011d78b"],
Cell[25499, 654, 312, 5, 35, "Text",ExpressionUUID->"6ff653cf-77d4-4f10-8a84-7d020a98abe2"],
Cell[25814, 661, 582, 10, 35, "Text",ExpressionUUID->"96a40119-f50a-4e0c-8d74-4dad78256563"],
Cell[26399, 673, 580, 8, 35, "Text",ExpressionUUID->"cd68d6df-72c7-4431-80ea-29125af0a481"],
Cell[26982, 683, 574, 8, 35, "Text",ExpressionUUID->"f9226158-9269-4b59-ba0e-abe4918629ea"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[27605, 697, 155, 3, 53, "Section",ExpressionUUID->"5df35583-9028-4859-92a9-c239f1bc6607"],
Cell[CellGroupData[{
Cell[27785, 704, 162, 3, 54, "Subsection",ExpressionUUID->"74a9e50d-d584-4c76-9cf7-3a021db8b3e3"],
Cell[27950, 709, 292, 7, 35, "Text",ExpressionUUID->"f7b70eca-efbb-4aa2-b47c-61a25a51595a"],
Cell[CellGroupData[{
Cell[28267, 720, 212, 5, 30, "Input",ExpressionUUID->"73efcf0e-3c65-4cef-a4ed-475ffaa14df4"],
Cell[28482, 727, 3073, 99, 237, "Output",ExpressionUUID->"698014f6-8231-412a-9f2c-e2549498c609"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31592, 831, 162, 3, 30, "Input",ExpressionUUID->"e14b0457-c89a-4258-bc09-dc6a6f7e42be"],
Cell[31757, 836, 5012, 121, 595, "Output",ExpressionUUID->"623d3fb0-d596-4fd7-83e5-b3b7a86a1518"]
}, Open  ]],
Cell[36784, 960, 344, 7, 58, "Text",ExpressionUUID->"edb6b627-b1bf-455f-abfe-58baa8631c13"]
}, Closed]],
Cell[CellGroupData[{
Cell[37165, 972, 273, 5, 38, "Subsection",ExpressionUUID->"60aeed7e-784d-470d-ba39-081e28237a46"],
Cell[37441, 979, 196, 3, 35, "Text",ExpressionUUID->"2257bf59-a071-41f4-b6c3-fdb2c5d780d2"],
Cell[CellGroupData[{
Cell[37662, 986, 5917, 157, 346, "Input",ExpressionUUID->"7fde3f30-e911-4aa5-9520-cb82941e6954"],
Cell[43582, 1145, 4946, 120, 323, "Output",ExpressionUUID->"7d52dfb8-bdf7-44c5-8a90-ecaa97ef265d"]
}, {2}]]
}, Closed]],
Cell[CellGroupData[{
Cell[48574, 1271, 324, 6, 38, "Subsection",ExpressionUUID->"7e808c8d-3661-4e1c-92d6-83327e7c3503"],
Cell[48901, 1279, 389, 7, 35, "Text",ExpressionUUID->"3011d9a8-1868-41b8-9564-5424f0602520"],
Cell[CellGroupData[{
Cell[49315, 1290, 10152, 271, 592, "Input",ExpressionUUID->"3fa1b9f9-47dd-4ef1-be31-21312f5d1f1a"],
Cell[59470, 1563, 5015, 121, 419, "Output",ExpressionUUID->"9b2a9dc9-e996-4418-854f-db2a6e964c1d"]
}, {2}]]
}, Closed]],
Cell[CellGroupData[{
Cell[64531, 1690, 217, 4, 38, "Subsection",ExpressionUUID->"87b9af90-7322-4a44-a91c-073978c2f2ef"],
Cell[64751, 1696, 336, 7, 35, "Text",ExpressionUUID->"c9911aab-4b67-4723-8a79-1c5622f41c1c"],
Cell[CellGroupData[{
Cell[65112, 1707, 6758, 180, 515, "Input",ExpressionUUID->"2e94f9c1-f32f-4a40-92b3-9d46301e5c53"],
Cell[71873, 1889, 5013, 121, 367, "Output",ExpressionUUID->"99c02920-fd82-45c4-92ca-a15501026334"]
}, {2}]]
}, Closed]],
Cell[CellGroupData[{
Cell[76932, 2016, 163, 3, 38, "Subsection",ExpressionUUID->"c53f0233-073b-4de6-aa22-0da8e02e64d2"],
Cell[77098, 2021, 438, 9, 58, "Text",ExpressionUUID->"ba8c20c5-2956-4ca1-ab27-cdc055111acd"],
Cell[CellGroupData[{
Cell[77561, 2034, 4028, 111, 220, "Input",ExpressionUUID->"62888c63-8b7b-46a8-be87-3da3929182d4"],
Cell[81592, 2147, 5033, 122, 569, "Output",ExpressionUUID->"c2c4b0d8-637d-4696-bdc2-424ffa4e0aad"]
}, {2}]]
}, Closed]],
Cell[CellGroupData[{
Cell[86671, 2275, 215, 4, 38, "Subsection",ExpressionUUID->"0154ba3b-bea6-4bbe-a822-eb234f9b57b8"],
Cell[86889, 2281, 452, 8, 58, "Text",ExpressionUUID->"37980e0d-b631-4b5b-ad25-591574e9f856"],
Cell[CellGroupData[{
Cell[87366, 2293, 4909, 134, 347, "Input",ExpressionUUID->"3e737c5e-eaab-458d-ae15-8b57fe194187"],
Cell[92278, 2429, 5015, 121, 639, "Output",ExpressionUUID->"7cb2f639-0cd4-4d0c-a759-ce1ede0cba9b"]
}, {2}]]
}, Closed]],
Cell[CellGroupData[{
Cell[97339, 2556, 160, 3, 38, "Subsection",ExpressionUUID->"89c839df-aba0-4848-9fa5-d06c05c02725"],
Cell[97502, 2561, 509, 9, 81, "Text",ExpressionUUID->"e10ae6e8-aff7-4f13-95eb-9e4d8a10cda7"],
Cell[CellGroupData[{
Cell[98036, 2574, 9285, 254, 535, "Input",ExpressionUUID->"b30b1b59-e55d-4acc-a347-eb26bc78936d"],
Cell[107324, 2830, 5014, 121, 455, "Output",ExpressionUUID->"f39dfcad-f632-4e08-a5db-9a9a8eed6e02"]
}, {2}]]
}, Closed]],
Cell[CellGroupData[{
Cell[112384, 2957, 164, 3, 38, "Subsection",ExpressionUUID->"25d5d309-cfb4-480a-99e0-54a4bc3236ed"],
Cell[CellGroupData[{
Cell[112573, 2964, 3210, 88, 242, "Input",ExpressionUUID->"36fed6f7-92ad-49a0-abaa-396d3fc6072c"],
Cell[115786, 3054, 5033, 122, 413, "Output",ExpressionUUID->"38504799-817d-4279-a9e7-ee315b7d08cc"]
}, {2}]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[120877, 3183, 380, 7, 53, "Section",ExpressionUUID->"b15a324c-bf02-4089-b0c0-afd2184401e5",
 InitializationCell->True],
Cell[121260, 3192, 502, 10, 58, "Text",ExpressionUUID->"976f21c0-8bd9-49c8-beb5-db3763b22acf",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[121787, 3206, 191, 4, 54, "Subsection",ExpressionUUID->"3e46b0a7-4343-45f6-92c4-58addb61c489",
 InitializationCell->True],
Cell[121981, 3212, 381, 10, 46, "Input",ExpressionUUID->"7cb06764-13cf-490c-b669-658c66646774",
 InitializationCell->True],
Cell[122365, 3224, 373, 10, 46, "Input",ExpressionUUID->"efa56b83-c40f-40ab-a902-9bf26176fe16",
 InitializationCell->True],
Cell[122741, 3236, 405, 10, 46, "Input",ExpressionUUID->"7354c0d4-04d0-4306-b407-b61e4039df19",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[123183, 3251, 192, 4, 54, "Subsection",ExpressionUUID->"097d0222-a793-47ff-ad98-4b6bc1d5ae57",
 InitializationCell->True],
Cell[123378, 3257, 805, 21, 89, "Input",ExpressionUUID->"a474c1fa-bd3c-429d-af44-78694b882ffc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[124220, 3283, 214, 4, 54, "Subsection",ExpressionUUID->"c51b4bbc-b9d5-4c77-be85-f96e0ff2d7b6",
 InitializationCell->True],
Cell[124437, 3289, 353, 9, 46, "Input",ExpressionUUID->"087c4547-06dc-4bc8-bcab-d0150afcafc0",
 InitializationCell->True],
Cell[124793, 3300, 311, 8, 46, "Input",ExpressionUUID->"fad13ae0-e9dd-49b6-ac3d-1d4c928502b0",
 InitializationCell->True],
Cell[125107, 3310, 362, 9, 46, "Input",ExpressionUUID->"8b918d46-5e29-4c55-a920-3b288cf7359f",
 InitializationCell->True],
Cell[125472, 3321, 356, 9, 46, "Input",ExpressionUUID->"bf6b886e-51a2-4859-ac09-f05be84f7ddb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[125865, 3335, 237, 5, 54, "Subsection",ExpressionUUID->"08332dfc-633f-4947-9567-f11eb49a6c1d",
 InitializationCell->True],
Cell[126105, 3342, 228, 5, 27, "Input",ExpressionUUID->"050634fe-f372-4e85-b182-49d075d91466",
 InitializationCell->True],
Cell[126336, 3349, 2520, 62, 215, "Input",ExpressionUUID->"82104efd-80ac-42f4-8e21-bede00330a40",
 InitializationCell->True],
Cell[128859, 3413, 404, 11, 46, "Input",ExpressionUUID->"bfeac947-0808-44f7-ab96-c83729c0df87",
 InitializationCell->True],
Cell[129266, 3426, 401, 11, 46, "Input",ExpressionUUID->"60bccb19-4ce8-459f-bcbc-9e2e45c0d7c1",
 InitializationCell->True],
Cell[129670, 3439, 225, 5, 46, "Input",ExpressionUUID->"f2b84e2d-ccaa-42fa-ab23-56eb945524f6",
 InitializationCell->True],
Cell[129898, 3446, 1872, 49, 89, "Input",ExpressionUUID->"f75f0efe-d8e2-4a01-84d4-4aac7cc51b6e",
 InitializationCell->True],
Cell[131773, 3497, 1384, 35, 68, "Input",ExpressionUUID->"27aad1ae-6164-42c4-8c80-32fd9d6a49b6",
 InitializationCell->True],
Cell[133160, 3534, 1139, 33, 68, "Input",ExpressionUUID->"1f536b9e-88de-4363-b4b4-a8c3dc8a0237",
 InitializationCell->True],
Cell[134302, 3569, 1040, 29, 46, "Input",ExpressionUUID->"c39fef22-3954-42ea-907d-d18b4bcb8dce",
 InitializationCell->True],
Cell[135345, 3600, 831, 21, 46, "Input",ExpressionUUID->"09c2b85e-4821-40e6-b123-65948288cbf3",
 InitializationCell->True],
Cell[136179, 3623, 774, 17, 46, "Input",ExpressionUUID->"8b1d8174-456d-468a-a7bd-7be786baf78f",
 InitializationCell->True],
Cell[136956, 3642, 710, 16, 46, "Input",ExpressionUUID->"3d58ab1f-181b-4baf-a476-0b4436abf270",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[137703, 3663, 217, 4, 54, "Subsection",ExpressionUUID->"b0531fdd-6932-4834-8c34-1becb308a11a",
 InitializationCell->True],
Cell[137923, 3669, 472, 11, 46, "Input",ExpressionUUID->"b5af88d8-080f-43e6-9e2d-a179de12e93b",
 InitializationCell->True],
Cell[138398, 3682, 2850, 63, 173, "Input",ExpressionUUID->"11b63568-c99d-46cb-b528-0db79929b464",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[141285, 3750, 264, 5, 54, "Subsection",ExpressionUUID->"baadf379-d627-404f-9547-0cd51f7d26ca",
 InitializationCell->True],
Cell[141552, 3757, 410, 10, 46, "Input",ExpressionUUID->"ef7c7bb8-82a4-4f10-801b-9d2ff7a52df0",
 InitializationCell->True],
Cell[141965, 3769, 1766, 37, 131, "Input",ExpressionUUID->"21668f78-58c2-4ffd-9c0b-0e175e5d8dba",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[143768, 3811, 167, 4, 54, "Subsection",ExpressionUUID->"e61045dd-eab7-4de7-bcc4-248e73542f5a",
 InitializationCell->True],
Cell[143938, 3817, 823, 23, 110, "Input",ExpressionUUID->"e4b58f00-a7b1-4144-ae9a-b56c2c0eba86",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[144798, 3845, 190, 4, 54, "Subsection",ExpressionUUID->"a602d4fc-5865-4529-993f-852c964c3255",
 InitializationCell->True],
Cell[144991, 3851, 517, 14, 68, "Input",ExpressionUUID->"186969a9-196a-413f-a9fb-8b55ba9594f1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[145545, 3870, 116, 2, 54, "Subsection",ExpressionUUID->"870daa9f-0855-4409-8c67-c8e3720b5eb1",
 InitializationCell->True],
Cell[145664, 3874, 312, 7, 68, "Input",ExpressionUUID->"75fedcbd-5b15-484e-b96e-c636566d1242",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[146013, 3886, 190, 4, 54, "Subsection",ExpressionUUID->"612bf9e9-ac9c-437b-9d10-485f809714f1",
 InitializationCell->True],
Cell[146206, 3892, 809, 18, 46, "Input",ExpressionUUID->"506eafba-4916-423f-aa0b-23b43817f07f",
 InitializationCell->True],
Cell[147018, 3912, 915, 20, 46, "Input",ExpressionUUID->"019a646e-69a8-4280-91e7-fd586f3e42ba",
 InitializationCell->True],
Cell[147936, 3934, 283, 7, 46, "Input",ExpressionUUID->"906f8468-ef93-4c5f-b108-260f11d96eff",
 InitializationCell->True],
Cell[148222, 3943, 1351, 27, 46, "Input",ExpressionUUID->"762f875d-c85c-4565-a0e1-9cb8fe3d6976",
 InitializationCell->True],
Cell[149576, 3972, 669, 15, 46, "Input",ExpressionUUID->"f4f691fc-fb4a-4852-953a-311b0167f245",
 InitializationCell->True],
Cell[150248, 3989, 682, 15, 46, "Input",ExpressionUUID->"4f1e57ce-03e7-47e5-9146-76d01e9aa521",
 InitializationCell->True],
Cell[150933, 4006, 665, 15, 46, "Input",ExpressionUUID->"07dbc183-3ee8-4baa-a900-89076d6d09f1",
 InitializationCell->True],
Cell[151601, 4023, 240, 6, 46, "Input",ExpressionUUID->"ebdf9603-ae70-4f19-86e8-52110cff458c",
 InitializationCell->True],
Cell[151844, 4031, 781, 18, 46, "Input",ExpressionUUID->"618d495f-0a28-4b71-b69b-21cb7c3cf05c",
 InitializationCell->True],
Cell[152628, 4051, 811, 18, 46, "Input",ExpressionUUID->"157bcc7a-1c89-476d-9f63-26058f5935ca",
 InitializationCell->True],
Cell[153442, 4071, 240, 6, 46, "Input",ExpressionUUID->"6d71b993-210c-4214-9548-839b398d8de7",
 InitializationCell->True],
Cell[153685, 4079, 1589, 40, 110, "Input",ExpressionUUID->"d1d3b90d-fbef-4d65-bae3-c894db7c19e8",
 InitializationCell->True],
Cell[155277, 4121, 327, 8, 46, "Input",ExpressionUUID->"6286b7f6-9597-4868-af6b-e44ce0d88ae9",
 InitializationCell->True],
Cell[155607, 4131, 1771, 38, 68, "Input",ExpressionUUID->"38e49dff-3dec-405e-9bcb-299e34eee9c7",
 InitializationCell->True],
Cell[157381, 4171, 333, 8, 46, "Input",ExpressionUUID->"ed1cd812-63ba-4d05-9d85-fc74393c8ad9",
 InitializationCell->True],
Cell[157717, 4181, 1116, 30, 68, "Input",ExpressionUUID->"98d3b5a5-d3ea-44bb-881e-3a3b8b485653",
 InitializationCell->True],
Cell[158836, 4213, 1032, 26, 43, "Input",ExpressionUUID->"187586ab-e1ed-42a0-b8b3-b5cf6ade9c67",
 InitializationCell->True],
Cell[159871, 4241, 1145, 29, 43, "Input",ExpressionUUID->"a8f04fa7-7986-4342-86dd-6c22742610f5",
 InitializationCell->True],
Cell[161019, 4272, 6608, 171, 268, "Input",ExpressionUUID->"1cdfe4bc-ce5e-48db-9c36-11efeee9e95c",
 InitializationCell->True],
Cell[167630, 4445, 9013, 212, 457, "Input",ExpressionUUID->"b245eaf2-de59-4197-8a98-5d6ab053e6c3",
 InitializationCell->True],
Cell[176646, 4659, 8970, 212, 457, "Input",ExpressionUUID->"4f8cb7fa-29ec-47a2-946c-b280a89af8cc",
 InitializationCell->True],
Cell[185619, 4873, 739, 23, 68, "Input",ExpressionUUID->"4609e496-c548-409e-b5eb-26d94334640d",
 InitializationCell->True],
Cell[186361, 4898, 563, 16, 68, "Input",ExpressionUUID->"0dfcd439-582a-43b2-92be-791abaf0aec4",
 InitializationCell->True],
Cell[186927, 4916, 500, 14, 68, "Input",ExpressionUUID->"115e0928-5366-4c6e-897c-1214f68f6d90",
 InitializationCell->True],
Cell[187430, 4932, 974, 25, 68, "Input",ExpressionUUID->"03dfd282-6056-4278-9e87-2f26e0958266",
 InitializationCell->True],
Cell[188407, 4959, 812, 21, 68, "Input",ExpressionUUID->"b23e95c8-480f-4ca0-a5de-1f44f0c11979",
 InitializationCell->True],
Cell[189222, 4982, 750, 19, 68, "Input",ExpressionUUID->"799f8c78-9f07-46a7-b4b9-0ef551be866c",
 InitializationCell->True],
Cell[189975, 5003, 401, 9, 46, "Input",ExpressionUUID->"62558ab4-6ae0-4d90-b530-c9de6d0c9273",
 InitializationCell->True],
Cell[190379, 5014, 810, 17, 46, "Input",ExpressionUUID->"891d544a-a190-46a1-8585-f2b2a1dcdf0f",
 InitializationCell->True],
Cell[191192, 5033, 1154, 28, 68, "Input",ExpressionUUID->"3e9b59f2-b989-496d-a908-5c3fd724066c",
 InitializationCell->True],
Cell[192349, 5063, 1018, 25, 68, "Input",ExpressionUUID->"a2ddf2f0-6fe0-4c11-9f7e-35fbb6bdb80c",
 InitializationCell->True],
Cell[193370, 5090, 875, 21, 68, "Input",ExpressionUUID->"cae5cf73-44d5-4645-b17c-bba5f2c4338a",
 InitializationCell->True],
Cell[194248, 5113, 421, 9, 46, "Input",ExpressionUUID->"0770eb6d-4f68-4287-961a-31c2c379cd75",
 InitializationCell->True],
Cell[194672, 5124, 1628, 40, 68, "Input",ExpressionUUID->"67e15c03-cc08-4d20-bb80-f20723d3e4c3",
 InitializationCell->True],
Cell[196303, 5166, 1474, 36, 68, "Input",ExpressionUUID->"1ef389da-c52d-4475-abdd-f35252d4bdf6",
 InitializationCell->True],
Cell[197780, 5204, 1299, 33, 68, "Input",ExpressionUUID->"577d7889-04dc-4f5b-afb7-ee2d2be8618b",
 InitializationCell->True],
Cell[199082, 5239, 296, 7, 46, "Input",ExpressionUUID->"acb76590-b579-4c73-9cea-f8c38f337085",
 InitializationCell->True],
Cell[199381, 5248, 475, 10, 46, "Input",ExpressionUUID->"b7493929-3287-4633-bd65-c0b2a6e7baa5",
 InitializationCell->True],
Cell[199859, 5260, 267, 7, 46, "Input",ExpressionUUID->"3306f775-1927-4d5d-9fe9-8a1a0b49f7e1",
 InitializationCell->True],
Cell[200129, 5269, 341, 8, 46, "Input",ExpressionUUID->"97fe3292-aaaa-4d15-8bd2-711262e6ada7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[200507, 5282, 181, 4, 54, "Subsection",ExpressionUUID->"33158139-0bbe-4094-9bb4-2295671ce6ad",
 InitializationCell->True],
Cell[200691, 5288, 384, 6, 35, "Text",ExpressionUUID->"7e67833a-8ef8-4f09-858a-07bd9c0d18ea",
 InitializationCell->True],
Cell[201078, 5296, 1911, 37, 131, "Input",ExpressionUUID->"c92cac20-88c5-4ab9-acd2-5b0fa04e0833",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[203026, 5338, 188, 4, 54, "Subsection",ExpressionUUID->"e509f532-f601-4e68-b880-0af7cc3c8334",
 InitializationCell->True],
Cell[203217, 5344, 349, 8, 58, "Text",ExpressionUUID->"358d30c5-cace-4a87-bf99-1aa9aa8707bb",
 InitializationCell->True],
Cell[203569, 5354, 8157, 160, 761, "Input",ExpressionUUID->"4365158c-0a02-490a-85ef-db30da5a2379",
 InitializationCell->True],
Cell[211729, 5516, 1871, 48, 118, "Input",ExpressionUUID->"3afa01f8-91a8-48a1-b27f-eeaee1830415",
 InitializationCell->True],
Cell[213603, 5566, 1243, 32, 73, "Input",ExpressionUUID->"b259897b-e778-4066-a54e-fbfc5ba18cfe",
 InitializationCell->True],
Cell[214849, 5600, 3064, 73, 278, "Input",ExpressionUUID->"7b542433-866e-4dda-9ef7-a83873bc1eaa",
 InitializationCell->True],
Cell[217916, 5675, 1169, 29, 110, "Input",ExpressionUUID->"64a49027-0bf1-48a3-95e1-18630a46c5ce",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[219122, 5709, 186, 4, 54, "Subsection",ExpressionUUID->"c3c65b54-0420-4f4f-b33d-af3761472328",
 InitializationCell->True],
Cell[219311, 5715, 459, 9, 58, "Text",ExpressionUUID->"e8c4f345-3e74-497a-b14a-58236f778b35",
 InitializationCell->True],
Cell[219773, 5726, 834, 19, 68, "Input",ExpressionUUID->"c5bd480f-be7c-41b5-a515-2c2f236c8afb",
 InitializationCell->True],
Cell[220610, 5747, 4533, 98, 404, "Input",ExpressionUUID->"ad3c7562-7540-45f1-8cbb-125eca200b72",
 InitializationCell->True],
Cell[225146, 5847, 285, 7, 35, "Text",ExpressionUUID->"d0639746-fa4f-4d9a-82ed-34c04e90305b",
 InitializationCell->True],
Cell[225434, 5856, 1008, 26, 131, "Input",ExpressionUUID->"0f7f0f17-44c5-4aa3-893a-ff8950db80a7",
 InitializationCell->True],
Cell[226445, 5884, 1021, 28, 89, "Input",ExpressionUUID->"c4dcd069-af9b-451e-aedf-1bc163c9a059",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[227503, 5917, 240, 5, 54, "Subsection",ExpressionUUID->"081e92fe-5197-4ef7-8975-54726279b4db",
 InitializationCell->True],
Cell[227746, 5924, 652, 14, 46, "Input",ExpressionUUID->"44272a2a-090b-4c33-a24c-2f464958c48d",
 InitializationCell->True],
Cell[228401, 5940, 984, 22, 46, "Input",ExpressionUUID->"cca9f71a-d9b6-4fc5-accf-7704927fd927",
 InitializationCell->True],
Cell[229388, 5964, 928, 23, 48, "Input",ExpressionUUID->"c3a23402-6762-4aa9-9130-03b0049e7a6e",
 InitializationCell->True],
Cell[230319, 5989, 517, 14, 68, "Input",ExpressionUUID->"6e30c76c-dbc6-44c4-8987-e11263557854",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[230873, 6008, 216, 5, 54, "Subsection",ExpressionUUID->"7b1fddee-41ff-4e15-a349-fa5566fef31d",
 InitializationCell->True],
Cell[231092, 6015, 841, 23, 89, "Input",ExpressionUUID->"ade04a75-3a01-4f64-ab4f-cccbd4c93925",
 InitializationCell->True],
Cell[231936, 6040, 9405, 204, 719, "Input",ExpressionUUID->"7ea25704-538d-4fa4-86f2-bf54c79b3c77",
 InitializationCell->True],
Cell[241344, 6246, 3182, 76, 404, "Input",ExpressionUUID->"391d2d9b-4d7e-4fb9-b712-55fd7403fb7e",
 InitializationCell->True],
Cell[244529, 6324, 4704, 110, 677, "Input",ExpressionUUID->"03f6e480-5f0a-428b-a8b5-5e0bbb5eaef5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[249270, 6439, 180, 4, 54, "Subsection",ExpressionUUID->"7b429448-b4d8-4521-8c13-e6082dc4bd8a",
 InitializationCell->True],
Cell[249453, 6445, 7011, 158, 87, "Input",ExpressionUUID->"3c5ca311-90cf-45cb-9dbf-d2e663625529",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[256501, 6608, 184, 4, 54, "Subsection",ExpressionUUID->"941c16e2-e565-40e4-b1ab-503c7e9eef59",
 InitializationCell->True],
Cell[256688, 6614, 399, 10, 46, "Input",ExpressionUUID->"f8082ea8-7cb1-423d-b79b-4a5d1a280795",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[257124, 6629, 186, 4, 54, "Subsection",ExpressionUUID->"efcf4b4b-13c7-484f-a31e-07646ff4df28",
 InitializationCell->True],
Cell[257313, 6635, 277, 8, 46, "Input",ExpressionUUID->"f8d810c2-9c7b-47c6-9fa6-8c692cd24013",
 InitializationCell->True],
Cell[257593, 6645, 858, 17, 46, "Input",ExpressionUUID->"0945eb45-67c7-4618-9af6-1021ba941fae",
 InitializationCell->True],
Cell[258454, 6664, 890, 17, 46, "Input",ExpressionUUID->"dffbdfae-c3ba-47b6-bc26-6cef9ed1886a",
 InitializationCell->True],
Cell[259347, 6683, 1008, 20, 46, "Input",ExpressionUUID->"50591de2-05b4-42ba-911f-199dbdef9ec0",
 InitializationCell->True],
Cell[260358, 6705, 620, 14, 46, "Input",ExpressionUUID->"b8e486fc-4067-4366-bfad-ac664d4ae5e5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[261015, 6724, 185, 4, 54, "Subsection",ExpressionUUID->"c228bf32-5faa-4e63-a761-5cda595a7035",
 InitializationCell->True],
Cell[261203, 6730, 377, 10, 46, "Input",ExpressionUUID->"19b42c5a-0744-444d-89c3-3fb60c618183",
 InitializationCell->True],
Cell[261583, 6742, 515, 14, 46, "Input",ExpressionUUID->"753078ca-bd79-4de0-b575-eef6a9bbd4a0",
 InitializationCell->True],
Cell[262101, 6758, 3591, 84, 467, "Input",ExpressionUUID->"b9646d82-cf6e-4582-8dd4-42ee725643b6",
 InitializationCell->True],
Cell[265695, 6844, 3866, 89, 320, "Input",ExpressionUUID->"2f36908e-7cbf-4dee-ae0f-6ee8a6a9ca62",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[269598, 6938, 186, 4, 54, "Subsection",ExpressionUUID->"2f37ef95-9f79-466d-ae50-5f179d856847",
 InitializationCell->True],
Cell[269787, 6944, 3533, 77, 236, "Input",ExpressionUUID->"58d59097-c172-4d35-85ca-d7befe36d342",
 InitializationCell->True],
Cell[273323, 7023, 882, 23, 152, "Input",ExpressionUUID->"fc582375-36e2-4214-89a8-bb9c162301c0",
 InitializationCell->True],
Cell[274208, 7048, 6702, 176, 446, "Input",ExpressionUUID->"0e35eb0f-a183-4acb-ab1d-27c00ff50bb9",
 InitializationCell->True],
Cell[280913, 7226, 3734, 84, 257, "Input",ExpressionUUID->"6e50d797-332c-469d-8244-1c742e750b8d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[284684, 7315, 309, 6, 54, "Subsection",ExpressionUUID->"ac4475ca-a7eb-4793-81a7-e4c002dcefa5",
 InitializationCell->True],
Cell[284996, 7323, 369, 7, 46, "Input",ExpressionUUID->"5553764d-fd35-44f1-bc78-846bb0230b01",
 InitializationCell->True],
Cell[285368, 7332, 428, 11, 68, "Input",ExpressionUUID->"735d2f3d-808d-499c-bd47-f4fd5e432634",
 InitializationCell->True],
Cell[285799, 7345, 658, 16, 68, "Input",ExpressionUUID->"42cd0506-7ffc-4c63-b019-77de1582d931",
 InitializationCell->True],
Cell[286460, 7363, 18033, 337, 1349, "Input",ExpressionUUID->"96b87a07-20af-4149-a49d-4b30016e1f0b",
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

