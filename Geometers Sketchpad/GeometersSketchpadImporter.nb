(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    302985,       7719]
NotebookOptionsPosition[    287418,       7227]
NotebookOutlinePosition[    287927,       7248]
CellTagsIndexPosition[    287884,       7245]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Geometer's Sketchpad Importer", "Title",
 CellChangeTimes->{{3.437418864478209*^9, 3.437418869776973*^9}, 
   3.437503596805079*^9, {3.437756288419866*^9, 3.437756299549172*^9}, {
   3.438608655894864*^9, 3.438608666861088*^9}, {3.438609060451026*^9, 
   3.438609060525852*^9}}],

Cell["Christopher Carlson  2008.12.18", "Subsubtitle",
 CellChangeTimes->{{3.438608671272461*^9, 3.438608684133127*^9}}],

Cell[TextData[{
 "This notebook started as an effort to divine how Geometer's Sketchpad \
works.  \n\nTo test my understanding, I attempted to model Geometer's \
Sketchpad's behavior in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ".\n\nThat effort ended with an import function that will import \
functioning, interactive GSP models into ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.437418861475746*^9, 3.437418910713726*^9}, 
   3.4375035968055153`*^9, {3.437756308919491*^9, 3.43775631037309*^9}, {
   3.43860868842948*^9, 3.438608765284113*^9}, {3.4386087996194344`*^9, 
   3.438608838293095*^9}, {3.438609073115988*^9, 3.4386091298950357`*^9}, 
   3.438609730268125*^9}],

Cell[CellGroupData[{

Cell["Notes", "Section",
 CellChangeTimes->{{3.4374189143888474`*^9, 3.4374189150011673`*^9}, 
   3.4375035968058453`*^9}],

Cell[CellGroupData[{

Cell["Notes on GSP's constraint strategy", "Subsection",
 CellChangeTimes->{{3.43748829308663*^9, 3.437488310543231*^9}, 
   3.437503596806115*^9}],

Cell["\<\
The geometry of a configuration depends only on the absolute position of the \
mouse, not on drag history (in contrast to Geometry Expressions' behavior).\
\>", "Text",
 CellChangeTimes->{{3.437418934362493*^9, 3.437418945405807*^9}, 
   3.437503596806973*^9}],

Cell["\<\
When dragging a point on a circle, the position of the point is the \
projection of the point onto the circle, ie, the intersection of the line \
from the center to the point with the circle.\
\>", "Text",
 CellChangeTimes->{{3.437418934362493*^9, 3.437418966473217*^9}, 
   3.437503596807192*^9}],

Cell["\<\
Drag any point on a chord, drag outside the circle, and the chord collapses \
to a single point on the line parallel to the chord and passing through the \
center of the circle.\
\>", "Text",
 CellChangeTimes->{{3.437418934362493*^9, 3.437418966473217*^9}, {
   3.437485260963027*^9, 3.437485265382053*^9}, 3.4375035968074102`*^9}],

Cell["A line is represented by two points.", "Text",
 CellChangeTimes->{{3.437486633354917*^9, 3.437486646200882*^9}, 
   3.4375035968076267`*^9}],

Cell["\<\
A point on a line is represented by the parametric position relative to the \
two points that define the line.  If the points are moved, the point on the \
line moves proportionally.\
\>", "Text",
 CellChangeTimes->{{3.437486648377199*^9, 3.4374866856172523`*^9}, 
   3.4375035968078423`*^9}],

Cell["\<\
Dragging a point-on-a-line changes is parametric position on the line.  The \
line never drags.\
\>", "Text",
 CellChangeTimes->{{3.437486772259726*^9, 3.4374868225376463`*^9}, 
   3.4375035968080597`*^9}],

Cell["\<\
A point on a circle is represented by its angular position on the circle.  If \
the circle is rotated by dragging its center, the orientation of the point is \
unchanged.\
\>", "Text",
 CellChangeTimes->{{3.437486720275817*^9, 3.4374867489054937`*^9}, 
   3.437503596808277*^9}],

Cell["\<\
Dragging a point on a circle gives the projection of the mouse position onto \
the circle.  The circle never drags.\
\>", "Text",
 CellChangeTimes->{{3.437486854811822*^9, 3.437486884689814*^9}, 
   3.4375035968084917`*^9}],

Cell["\<\
If multiple objects are dragged and the constraints are too complex to solve, \
the whole object translates as a rigid body.\
\>", "Text",
 CellChangeTimes->{{3.437487130805071*^9, 3.437487160723154*^9}, 
   3.437503596808707*^9}],

Cell["\<\
Limiting constraints to constructions ensures that the resulting constraint \
structure has no loops.  Allowing the addition of arbitrary constraints (as a \
constraint language might permit) would require a strategy for dealing with \
constraint loops.\
\>", "Text",
 CellChangeTimes->{{3.4380053359325523`*^9, 3.438005399818878*^9}}],

Cell[TextData[{
 "Limiting constraints to constructions also ensures that no object depends \
on other objects in more than one way: you can't construct a point that lies \
on a line ",
 StyleBox["and",
  FontSlant->"Italic"],
 " lies on a circle."
}], "Text",
 CellChangeTimes->{{3.4380061509879837`*^9, 3.438006209795884*^9}}],

Cell["\<\
Limiting constraints to constructions means that in the resulting constraint \
graph, (1) only one multiedge emanates from any object node, and (2) there \
are no cycles.\
\>", "Text",
 CellChangeTimes->{{3.438007075135098*^9, 3.4380071108604097`*^9}}],

Cell[TextData[{
 "It is painful in GSP to construct a line segment with a fixed length.  To \
construct a line segment with a fixed length ",
 StyleBox["and direction",
  FontSlant->"Italic"],
 ", you translate a copy of a point from itself by a fixed distance, then \
construct a line segment between the points.  To construct a line segment \
with a fixed length, but not direction, you have to construct a circle with a \
fixed radius using the procedure I just described, then construct a point on \
the circle, and finally, a line between the center of the circle and the \
point on the circle."
}], "Text",
 CellChangeTimes->{{3.438005409069469*^9, 3.438005503035543*^9}, {
  3.43800556619033*^9, 3.4380056643953667`*^9}}],

Cell["\<\
GSP often throws up its hands and translates an entire object if it has to \
solve contstraints in two directions at once.\
\>", "Text",
 CellChangeTimes->{{3.438015578362389*^9, 3.438015589711089*^9}, {
  3.438015635994972*^9, 3.438015655295184*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other notes", "Subsection",
 CellChangeTimes->{{3.437488314007719*^9, 3.437488315278981*^9}, 
   3.4375035968089247`*^9}],

Cell["\<\
In order to make an intelligent choice of constraint system, we have to know \
what we intend to do with it.\
\>", "Text",
 CellChangeTimes->{{3.437488324567244*^9, 3.437488349607049*^9}, 
   3.4375035968092337`*^9}],

Cell["\<\
GSP has many auxilliary features that make it attractive in education: \
animations, scripts, traces, buttons, styling of objects and text, import of \
images, tabbed views, links.\
\>", "Text",
 CellChangeTimes->{{3.4386943490642357`*^9, 3.438694378239416*^9}, {
  3.438694804966608*^9, 3.438694809960903*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparison to Geometry Expressions", "Subsection",
 CellChangeTimes->{{3.437487973200356*^9, 3.4374879789656477`*^9}, 
   3.437503596809452*^9}],

Cell["\<\
A chain of fixed-length line segments is a pain to construct.  You can't drag \
the whole chain; just individual segments.  And since the end segments are \
not symmetric (one goes from radius to center, one from center to radius), \
they drag differently. \
\>", "Text",
 CellChangeTimes->{{3.437488017544271*^9, 3.437488103718504*^9}, 
   3.437503596809752*^9}],

Cell["\<\
If you were to construct a grid in GSP, it would not have the nice drag \
property that it does in GE.\
\>", "Text",
 CellChangeTimes->{{3.437488226742606*^9, 3.437488256694997*^9}, 
   3.437503597228457*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["GSP Constraints", "Subsection",
 CellChangeTimes->{{3.438458491323599*^9, 3.438458497400552*^9}}],

Cell[BoxData[GridBox[{
   {"Constraint", "Inputs", "Outputs", 
    RowBox[{"Drag", "\[IndentingNewLine]", "Backpropagation"}], 
    RowBox[{"Backpropagation", "\[IndentingNewLine]", "Stop"}]},
   {"CenterPointCircle", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Point"}], "}"}], "Circle", "yes", "no"},
   {"PointPointLine", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Point"}], "}"}], "Line", "yes", "no"},
   {"PointOnLine", "Line", "Point", "no", "yes"},
   {"PointOnCircle", "Circle", "Point", "no", "yes"},
   {"Midpoint", "Line", "Point", "yes", "no"},
   {"AngleBisector", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Point", ",", "Point"}], "}"}], "Line", "yes", 
    "no"},
   {"ArcThroughThreePoints", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Point", ",", "Point"}], "}"}], "Arc", "yes", "no"},
   {"ParallelLine", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Line"}], "}"}], "Line", 
    RowBox[{
     RowBox[{"Point", ":", "yes"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "no"}]}], 
    RowBox[{
     RowBox[{"Point", ":", "no"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "yes"}]}]},
   {"PerpendicularLine", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Line"}], "}"}], "Line", 
    RowBox[{
     RowBox[{"Point", ":", "yes"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "no"}]}], 
    RowBox[{
     RowBox[{"Point", ":", "no"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "yes"}]}]},
   {"CenterRadiusCircle", 
    RowBox[{"{", 
     RowBox[{"Point", ",", "Line"}], "}"}], "Circle", 
    RowBox[{
     RowBox[{"Point", ":", "yes"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "no"}]}], 
    RowBox[{
     RowBox[{"Point", ":", "no"}], "\[IndentingNewLine]", 
     RowBox[{"Line", ":", "yes"}]}]},
   {"Translate", "Object", "Object", 
    RowBox[{"yes", ":", " ", 
     RowBox[{
      SuperscriptBox["t", 
       RowBox[{"-", "1"}]], ".", "d"}]}], "no"},
   {"Rotate", "Object", "Object", "\[Placeholder]", "\[Placeholder]"},
   {"Dialate", "Object", "Object", "\[Placeholder]", "\[Placeholder]"},
   {"Reflect", "Object", "Object", "\[Placeholder]", "\[Placeholder]"}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}}]], "Input",
 CellChangeTimes->{{3.438458545949321*^9, 3.438458618742032*^9}, {
  3.438458671543292*^9, 3.438458699718639*^9}, {3.438458775229303*^9, 
  3.438458806999043*^9}, {3.438458876544417*^9, 3.438458927826297*^9}, {
  3.438459101188678*^9, 3.438459107426815*^9}, {3.438459232988752*^9, 
  3.4384592534430017`*^9}, {3.4384593814258547`*^9, 3.438459424723297*^9}, {
  3.438459494965974*^9, 3.438459611186418*^9}, {3.438459653989311*^9, 
  3.4384596671398163`*^9}, {3.438459700071013*^9, 3.4384597337424507`*^9}, {
  3.438512001086767*^9, 3.438512032973083*^9}, {3.438512067558947*^9, 
  3.43851206765161*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Sources of GSP Files", "Subsection",
 CellChangeTimes->{{3.438694611931305*^9, 3.4386946158964777`*^9}}],

Cell["custom tools, basic techniques, basic sketches:", "Text",
 CellChangeTimes->{{3.440274633736216*^9, 3.440274634991269*^9}}],

Cell[TextData[{
 ButtonBox["http://pt3.ed.asu.edu/Summer2002_sketchpad_PC.html",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://pt3.ed.asu.edu/Summer2002_sketchpad_PC.html"], None},
  ButtonNote->"http://pt3.ed.asu.edu/Summer2002_sketchpad_PC.html"],
 " "
}], "Text",
 CellChangeTimes->{{3.438694701384265*^9, 3.43869472111769*^9}, {
  3.438694814124386*^9, 3.4386948180005627`*^9}, {3.440274631025137*^9, 
  3.44027463126367*^9}}],

Cell["Mechanical linkages:", "Text",
 CellChangeTimes->{{3.440274623145095*^9, 3.4402746257593203`*^9}}],

Cell[TextData[ButtonBox["http://www.mfdabbs.pwp.blueyonder.co.uk/Maths_Pages/\
SketchPad_Files/Mechanical_Linkages/Mechanical_Linkages.html",
 BaseStyle->"Hyperlink",
 ButtonData->{
   URL["http://www.mfdabbs.pwp.blueyonder.co.uk/Maths_Pages/SketchPad_Files/\
Mechanical_Linkages/Mechanical_Linkages.html"], None},
 ButtonNote->
  "http://www.mfdabbs.pwp.blueyonder.co.uk/Maths_Pages/SketchPad_Files/\
Mechanical_Linkages/Mechanical_Linkages.html"]], "Text",
 CellChangeTimes->{{3.440274610010356*^9, 3.4402746179319773`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["To Do", "Section",
 CellChangeTimes->{{3.438608858071232*^9, 3.438608859613888*^9}}],

Cell[CellGroupData[{

Cell["To Do", "Subsection",
 CellChangeTimes->{{3.438091004198845*^9, 3.438091005100202*^9}}],

Cell[CellGroupData[{

Cell["High Priority", "Subsubsection",
 CellChangeTimes->{{3.4386095148292522`*^9, 3.438609525687325*^9}}],

Cell["\<\
- the drag algorithm should drag rigidly if there is more than one path to an \
object (through affine transforms)\
\>", "Text",
 CellChangeTimes->{{3.443902639187002*^9, 3.4439026939548492`*^9}, {
  3.4440743501384773`*^9, 3.4440743575615883`*^9}}],

Cell["\<\
- however, if you drag a line between a point and its reflection, the \
reflection line drags\
\>", "Text",
 CellChangeTimes->{{3.4440743631866407`*^9, 3.444074380929549*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Medium Priority", "Subsubsection",
 CellChangeTimes->{{3.438609527959704*^9, 3.438609530358839*^9}}],

Cell["- implement hidden attibute", "Text",
 CellChangeTimes->{{3.438708923468072*^9, 3.438708927292131*^9}}],

Cell["- read trace attribute from html file", "Text",
 CellChangeTimes->{{3.438780222233177*^9, 3.4387802282788477`*^9}}],

Cell["- implement loci", "Text",
 CellChangeTimes->{{3.438595713029784*^9, 3.4385957299276123`*^9}, {
   3.438599933792951*^9, 3.438599985652996*^9}, 3.438603580677176*^9, {
   3.4386094320741577`*^9, 3.438609437657764*^9}, 3.4386094746065283`*^9, 
   3.438705108049123*^9}],

Cell["\<\
- check out what happens and what is supposed to happen when multiple objects \
are dragged\
\>", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609451998703*^9}, {3.43871316196135*^9, 3.438713163228207*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Low Priority", "Subsubsection",
 CellChangeTimes->{{3.438609531599647*^9, 3.438609533294582*^9}}],

Cell["- parse files with multiple tabs", "Text",
 CellChangeTimes->{{3.438695034372682*^9, 3.438695040729445*^9}}],

Cell["- implement GSP's concept of \"script tools\"", "Text",
 CellChangeTimes->{{3.438632342850834*^9, 3.4386323532503767`*^9}}],

Cell["- example of merging back-propagation paths that conflict?", "Text",
 CellChangeTimes->{{3.438431952071487*^9, 3.4384319709245663`*^9}}],

Cell["\<\
- what alternative strategy could be used to accomodate multiple drags on one \
back propagation path?\
\>", "Text",
 CellChangeTimes->{{3.438457918666637*^9, 3.438457955688493*^9}}],

Cell["- replace separate parameter with PointOnObject[p]?", "Text",
 CellChangeTimes->{{3.438595713029784*^9, 3.4385957299276123`*^9}, {
   3.438599933792951*^9, 3.438599985652996*^9}, 3.438603580677176*^9, 
   3.4386094320741577`*^9}],

Cell["- add rotation and dialation drag tools", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609449063109*^9}, {3.438705140281457*^9, 3.4387051423646812`*^9}}],

Cell["- unify GSP and model constraint syntaxes", "Text",
 CellChangeTimes->{{3.438595713029784*^9, 3.4385957299276123`*^9}, {
   3.438599933792951*^9, 3.438599985652996*^9}, 3.438603580677176*^9, {
   3.4386094320741577`*^9, 3.438609434665965*^9}, 3.438609472174828*^9}]
}, Open  ]],

Cell["Unprioritized", "Subsubsection",
 CellChangeTimes->{{3.438609546810713*^9, 3.438609549854766*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Done", "Subsection",
 CellChangeTimes->{{3.43860941307299*^9, 3.4386094134063168`*^9}}],

Cell["\t- add all remaining constraints", "Text",
 CellChangeTimes->{{3.438705047644321*^9, 3.438705052172261*^9}, 
   3.438712937822775*^9, 3.4387802008339033`*^9}],

Cell["\t- add trace objects", "Text",
 CellChangeTimes->{{3.438713146326548*^9, 3.43871314909976*^9}, 
   3.438780202374798*^9}],

Cell["\<\
\t- make transform constraints work inversely: ConstraintTransform has to be \
fed not only the argument parameter, but also the argument objects: make the \
constraint-specific functions nicer, eg: ConstraintTransform[Rotation, -1.3, \
Point[{0,0}]] and prepare the arguments in the drag function.\
\>", "Text",
 CellChangeTimes->{{3.43870506178053*^9, 3.4387050726124277`*^9}, {
   3.4387166806787024`*^9, 3.438716682018908*^9}, {3.438719521448056*^9, 
   3.438719600399932*^9}, {3.438774340889319*^9, 3.438774342015444*^9}, 
   3.4387743953459263`*^9}],

Cell["\<\
\t- in Pantograph, circle radius line moves when circle is dragged; \
constraint should mark which arguments get dragged and which don't; ditto \
with ParabolicLocus parallel lines\
\>", "Text",
 CellChangeTimes->{{3.438709034782337*^9, 3.438709074252451*^9}, {
  3.438711753068943*^9, 3.438711762369153*^9}, {3.4387178206455803`*^9, 
  3.438717846192676*^9}}],

Cell["\t- correct line and point-on-line constraints", "Text",
 CellChangeTimes->{{3.438705031051297*^9, 3.438705044396523*^9}, 
   3.438709221464746*^9, 3.438712937822109*^9}],

Cell["\t- accommodate failed constructions", "Text",
 CellChangeTimes->{{3.4380910098760777`*^9, 3.438091018028192*^9}, 
   3.438712920084017*^9}],

Cell["\t- ignore unrecognized file elements", "Text",
 CellChangeTimes->{{3.438622369410424*^9, 3.438622393903256*^9}, 
   3.4387050903891163`*^9}],

Cell["\<\
\t- when dragging CenterOnCircleChain, centers depart from circles\
\>", "Text",
 CellChangeTimes->{{3.438611669722814*^9, 3.438611679090208*^9}, 
   3.438618288605113*^9}],

Cell["\t- reverse sense of point on circle parameter", "Text",
 CellChangeTimes->{{3.4386113157571917`*^9, 3.4386113242423687`*^9}, 
   3.43861858264824*^9}],

Cell["\t- correct ProjectPoint and GetHit for line types", "Text",
 CellChangeTimes->{{3.438546762703796*^9, 3.438546791188651*^9}, 
   3.438609430450466*^9, 3.438619369370061*^9}],

Cell["\t- test points on line segments", "Text",
 CellChangeTimes->{{3.438546762703796*^9, 3.438546791188651*^9}, 
   3.438609430450466*^9, 3.438609469814547*^9, 3.438619372158087*^9}],

Cell["\t- should be able to mouse-down and immediately drag", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609447782826*^9}, 3.438621355952017*^9}],

Cell["\t- can't drag line in endpointOnLineChain", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.4386094511109343`*^9}, 3.4386219847305183`*^9}],

Cell["\t- sometimes objects can't be hit after a drag", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609449726831*^9}, 3.4386193791023293`*^9}],

Cell["\<\
\t- what about constructions that result in more than one object (like \
intersection of circles)?\
\>", "Text",
 CellChangeTimes->{{3.438091022115841*^9, 3.438091036861925*^9}, 
   3.438456763668036*^9}],

Cell["\<\
\t- clean up image size, plot range, and hit-testing issues in manipulate \
environment\
\>", "Text",
 CellChangeTimes->{{3.4386034950033216`*^9, 3.438603552711946*^9}, {
   3.438608583666483*^9, 3.438608592573007*^9}, 3.438609423788*^9}],

Cell["\t- import plot range along with GSP html information", "Text",
 CellChangeTimes->{{3.4386034950033216`*^9, 3.438603552711946*^9}, {
   3.438608583666483*^9, 3.438608592573007*^9}, {3.438609423788*^9, 
   3.4386094257219887`*^9}, 3.438609461398863*^9}],

Cell["\t- how are loci implemented?", "Text",
 CellChangeTimes->{{3.4386034950033216`*^9, 3.438603552711946*^9}, {
   3.438608583666483*^9, 3.438608592573007*^9}, {3.438609423788*^9, 
   3.438609427154249*^9}, 3.438609465966515*^9}],

Cell["\t- import GSP files?", "Text",
 CellChangeTimes->{{3.438595713029784*^9, 3.4385957299276123`*^9}, {
   3.438599933792951*^9, 3.438599985652996*^9}, 3.438603580677176*^9, {
   3.4386094320741577`*^9, 3.438609436290324*^9}, 3.438609473318781*^9}],

Cell["\<\
\t- points should draw and hit-test in front of everything else\
\>", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, 3.438609445663458*^9}],

Cell["\t- nothing should change if you drag nothing", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609447039068*^9}}],

Cell["\t- hit precision depends on plot range", "Text",
 CellChangeTimes->{{3.43854340802561*^9, 3.438543460337886*^9}, 
   3.4385436391569033`*^9, {3.438544811540904*^9, 3.438544830706738*^9}, {
   3.4385448902527533`*^9, 3.438544896274893*^9}, {3.438545011662376*^9, 
   3.4385450328389072`*^9}, {3.4385451528242197`*^9, 3.438545169683345*^9}, {
   3.438545509616426*^9, 3.438545516619615*^9}, 3.438545860937675*^9, {
   3.438608620237731*^9, 3.43860864810541*^9}, {3.438609445663458*^9, 
   3.438609450542713*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.438780276026884*^9, 3.4387802770478163`*^9}}],

Cell[CellGroupData[{

Cell["Import Example", "Subsection",
 CellChangeTimes->{{3.534601769623968*^9, 3.534601782995954*^9}}],

Cell["\<\
These examples are run directly from Geometer's Sketchpad output files with \
commands like this:\
\>", "Text",
 CellChangeTimes->{{3.4387809347761*^9, 3.43878097191805*^9}, {
  3.43878307599527*^9, 3.438783087315271*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "ImportModel", "[", 
   "\"\</Users/carlson/Documents/Constraint Experiments/CircleLocus.html\>\"",
    "]"}], "//", "PrettyPrintModel"}]], "Input",
 CellChangeTimes->{{3.438780954458498*^9, 3.4387809591206713`*^9}, {
  3.440272332302925*^9, 3.440272340019784*^9}, {3.440272373081066*^9, 
  3.440272406325091*^9}, {3.4440709049153337`*^9, 3.444070911542508*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"527", ",", "397"}], "}"}], "]"}], "", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}]},
    {"2", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"586", ",", "377"}], "}"}], "]"}], "", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}]},
    {"3", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"527", ",", "397"}], "}"}], ",", 
       SqrtBox["3881"]}], "]"}], "CircleCenterRadius", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]},
    {"4", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"561.9997758996814`", ",", "345.4634529001788`"}], "}"}], 
      "]"}], "PointOnObject", 
     RowBox[{"{", 
      RowBox[{"-", "0.974218`"}], "}"}], 
     RowBox[{"{", "3", "}"}]},
    {"5", 
     RowBox[{"LineSegment", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"561.9997758996814`", ",", "345.4634529001788`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"527", ",", "397"}], "}"}]}], "}"}], "]"}], 
     "LineSegmentThroughPoints", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", 
      RowBox[{"4", ",", "1"}], "}"}]},
    {"6", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"420", ",", "216"}], "}"}], "]"}], "", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}]},
    {"7", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"420", ",", "216"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"368.4634529001788`", ",", "181.00022410031863`"}], "}"}]}], 
       "}"}], "]"}], "Perpendicular", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}]},
    {"8", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"251", ",", "212"}], "}"}], "]"}], "", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}]},
    {"9", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"251", ",", "212"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"285.99977589968137`", ",", "160.46345290017882`"}], "}"}]}],
        "}"}], "]"}], "Perpendicular", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", 
      RowBox[{"7", ",", "8"}], "}"}]},
    {"10", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{"302.483452333205`", ",", "136.19153272190562`"}], "}"}], 
      "]"}], "PointAtIntersection", 
     RowBox[{"{", "}"}], 
     RowBox[{"{", 
      RowBox[{"7", ",", "9"}], "}"}]},
    {"11", "$Failed", "Locus", 
     RowBox[{"{", "300", "}"}], 
     RowBox[{"{", 
      RowBox[{"10", ",", "4", ",", "3"}], "}"}]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.440272333735977*^9, 3.440272340457645*^9}, 
   3.440272376759589*^9, 3.4402724072774897`*^9, 3.4434641575652103`*^9, 
   3.443986022087583*^9, 3.53460142932056*^9}]
}, Closed]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "RunModel", "[", 
   "\"\</Users/carlson/Documents/Constraint \
Experiments/Linkages/CardioidLinkage.html\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{3.5346018211989393`*^9},
 EmphasizeSyntaxErrors->True],

Cell["\<\
To avoid having to bundle the input files with this file, I've pre-imported \
the models and included them directly in the RunModel commands.\
\>", "Text",
 CellChangeTimes->{{3.4387810114149733`*^9, 3.4387810434469337`*^9}, {
  3.438783055980522*^9, 3.438783066467317*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Line Segment Pentagon", "Subsection",
 CellChangeTimes->{
  3.4387813594968348`*^9, {3.438781825643661*^9, 3.4387818273045683`*^9}, {
   3.438782245538156*^9, 3.4387822480333967`*^9}, 3.534601855559547*^9}],

Cell["Each endpoint is constrained to lie on a line segment.", "Text",
 CellChangeTimes->{{3.438782312725662*^9, 3.438782334395122*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lineSegmentPentagon", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"162", ",", "147"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"254", ",", "63"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"254", ",", "63"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"162", ",", "147"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"218.859772`", ",", "95.084556`"}], "}"}], "]"}], ",", 
         "PointOnObject", ",", 
         RowBox[{"{", "0.618041`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"302", ",", "152"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"302", ",", "152"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"218.859772`", ",", "95.084556`"}], "}"}]}], "}"}], 
          "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"280.84247477856`", ",", "137.51615781088`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "0.74552`", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"238", ",", "225"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"238", ",", "225"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"280.84247477856`", ",", "137.51615781088`"}], "}"}]}], 
           "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "7"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"257.1320354344372`", ",", "185.93260304513126`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "0.553433`", "}"}], ",", 
         RowBox[{"{", "9", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"130", ",", "193"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"130", ",", "193"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"257.1320354344372`", ",", "185.93260304513126`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"11", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"200.3664374246421`", ",", "189.08825939205275`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "0.446509`", "}"}], ",", 
         RowBox[{"{", "12", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"179.285604`", ",", "131.217492`"}], "}"}], "]"}], ",", 
         "PointOnObject", ",", 
         RowBox[{"{", "0.187887`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"179.285604`", ",", "131.217492`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"200.3664374246421`", ",", "189.08825939205275`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"14", ",", "13"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"449", ",", "294"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "lineSegmentPentagon", "]"}]}], "Input",
 CellChangeTimes->{{3.438781113286737*^9, 3.438781132732469*^9}, {
   3.438781304820574*^9, 3.438781308400848*^9}, {3.438781559954962*^9, 
   3.438781563692922*^9}, {3.4387816224097853`*^9, 3.438781635255231*^9}, {
   3.438781794935876*^9, 3.438781810786272*^9}, {3.438782234130805*^9, 
   3.438782258847501*^9}, 3.438782292728421*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$9132 = \
$CellContext`selection$9132)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$9132 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$9132 = \
$CellContext`initialModel$9132; $CellContext`selection$9132 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$9132], StandardForm, 
            Graphics],
           ImageSizeCache->{{126.5, 345.5}, {-83.5, 85.5}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$9132, \
$CellContext`selection$9132], StandardForm, Graphics],
           ImageSizeCache->{{240.75735931288068`, 
            346.2426406871193}, {-2.242640687119305, 78.24264068711932}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$9132, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          294}}],
        ImageSize->{449, 294},
        PlotRange->{{0, 449}, {0, 294}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$9132 = \
($CellContext`mouseDownPosition$9132 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$9132 = \
$CellContext`model$9132; $CellContext`mouseDownHit$9132 = \
$CellContext`GetHit[$CellContext`model$9132, 
            $CellContext`hitTransform$9132[$CellContext`mouseDownPosition$\
9132]]; $CellContext`mouseDownOnSelection$9132 = 
          Intersection[$CellContext`selection$9132, \
$CellContext`mouseDownHit$9132] =!= {}; $CellContext`selection$9132 = 
          If[$CellContext`mouseDownHit$9132 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$9132, \
$CellContext`mouseDownHit$9132]]; $CellContext`firstDrag$9132 = 
          True; $CellContext`mouseDidDrag$9132 = 
          False; $CellContext`mouseDownShiftKey$9132 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$9132], \
$CellContext`mouseDownOnSelection$9132], $CellContext`selection$9132 = \
$CellContext`ToggleSelection[$CellContext`selection$9132, \
$CellContext`mouseDownHit$9132]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$9132], 
            
            Not[$CellContext`mouseDownShiftKey$9132]], \
$CellContext`selection$9132 = $CellContext`mouseDownHit$9132]; \
$CellContext`mouseDidDrag$9132 = True; $CellContext`firstDrag$9132 = False; 
         With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$9132 = \
$CellContext`Drag[$CellContext`mouseDownModel$9132, \
$CellContext`selection$9132, 
              TranslationTransform[
               $CellContext`dragTransform$9132[$CellContext`mousePosition$\
9132 - $CellContext`mouseDownPosition$9132]]]; \
$CellContext`mousePosition$9132 = $CellContext`newPosition$]; \
$CellContext`trace$9132 = $CellContext`UpdateTrace[$CellContext`model$9132, \
$CellContext`tracedObjects$9132, $CellContext`trace$9132]), PassEventsDown -> 
        Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.534601484001046*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Affine Transform Chain", "Subsection",
 CellChangeTimes->{
  3.4387813594968348`*^9, {3.438781825643661*^9, 3.4387818273045683`*^9}, {
   3.438782245538156*^9, 3.4387822480333967`*^9}, {3.438782431415038*^9, 
   3.438782435837041*^9}, 3.534601857453163*^9}],

Cell["\<\
This model is a chain of affine transforms of the leftmost line-circle-points \
motif: a translation, a rotation, a scaling, and a reflection.\
\>", "Text",
 CellChangeTimes->{{3.438782312725662*^9, 3.438782334395122*^9}, {
  3.4387825110356913`*^9, 3.438782544391594*^9}, {3.438782583313381*^9, 
  3.438782618417037*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"affineTransformChain", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"139", ",", "176"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"172", ",", "130"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"139", ",", "176"}], "}"}], ",", 
           SqrtBox["3205"]}], "]"}], ",", "CircleCenterRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"190", ",", "225"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"190", ",", "225"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"139", ",", "176"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"280.73199999999997`", ",", "176"}], "}"}], "]"}], ",", 
         "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "1", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"313.73199999999997`", ",", "130"}], "}"}], "]"}], ",", 
         "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"280.73199999999997`", ",", "176"}], "}"}], ",", 
           SqrtBox["3205"]}], "]"}], ",", "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"331.73199999999997`", ",", "225"}], "}"}], "]"}], ",", 
         "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"331.73199999999997`", ",", "225"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"280.73199999999997`", ",", "176"}], "}"}]}], "}"}], 
          "]"}], ",", "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "5", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"238.99966672242397`", ",", "315.7321799864379`"}], "}"}], 
          "]"}], ",", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.5708`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"284.9995455063452`", ",", "348.7323489536501`"}], "}"}], 
          "]"}], ",", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.5708`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"238.99966672242397`", ",", "315.7321799864379`"}], "}"}],
            ",", 
           SqrtBox["3205"]}], "]"}], ",", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.5708`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"189.99947938929427`", ",", "366.73199999904386`"}], "}"}],
           "]"}], ",", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.5708`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"189.99947938929427`", ",", "366.73199999904386`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"238.99966672242397`", ",", "315.7321799864379`"}], 
             "}"}]}], "}"}], "]"}], ",", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.5708`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"300.8212531515858`", ",", "255.2440297514193`"}], "}"}], 
          "]"}], ",", "Scaling", ",", 
         RowBox[{"{", "0.333333`", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"11", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"316.1545307462666`", ",", "266.244075073767`"}], "}"}], 
          "]"}], ",", "Scaling", ",", 
         RowBox[{"{", "0.333333`", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"300.8212531515858`", ",", "255.2440297514193`"}], "}"}], 
           ",", "18.870887602051074`"}], "]"}], ",", "Scaling", ",", 
         RowBox[{"{", "0.333333`", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"13", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"284.4878737072716`", ",", "272.2439527556813`"}], "}"}], 
          "]"}], ",", "Scaling", ",", 
         RowBox[{"{", "0.333333`", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"14", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"284.4878737072716`", ",", "272.2439527556813`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"300.8212531515858`", ",", "255.2440297514193`"}], 
             "}"}]}], "}"}], "]"}], ",", "Scaling", ",", 
         RowBox[{"{", "0.333333`", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"15", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"360.7159087021013`", ",", "192.9046943825154`"}], "}"}], 
          "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"16", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"372.32024337623767`", ",", "207.78588437726654`"}], "}"}],
           "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"17", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"360.7159087021013`", ",", "192.9046943825154`"}], "}"}], 
           ",", "18.870887602051074`"}], "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"18", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"377.0491632575668`", ",", "175.90465138700665`"}], "}"}], 
          "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"19", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"377.0491632575668`", ",", "175.90465138700665`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"360.7159087021013`", ",", "192.9046943825154`"}], 
             "}"}]}], "}"}], "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"20", ",", "10"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"620", ",", "390"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "affineTransformChain", "]"}]}], "Input",
 CellChangeTimes->{{3.438781113286737*^9, 3.438781132732469*^9}, {
   3.438781304820574*^9, 3.438781308400848*^9}, {3.438781559954962*^9, 
   3.438781563692922*^9}, {3.4387816224097853`*^9, 3.438781635255231*^9}, {
   3.438781794935876*^9, 3.438781810786272*^9}, {3.438782234130805*^9, 
   3.438782258847501*^9}, 3.438782292728421*^9, {3.4387824387884912`*^9, 
   3.438782473196824*^9}, {3.438782534081546*^9, 3.43878253569343*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$13445 = \
$CellContext`selection$13445)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$13445 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$13445 = \
$CellContext`initialModel$13445; $CellContext`selection$13445 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$13445], StandardForm, 
            Graphics],
           
           ImageSizeCache->{{117.97306701875425`, 
            396.6236677113205}, {-217.75921214397187`, 102.02693298124575`}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$13445, \
$CellContext`selection$13445], StandardForm, Graphics],
           
           ImageSizeCache->{{116.38728058112736`, 
            235.61271941887264`}, {-15.612719418872658`, 
            103.61271941887264`}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$13445, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          390}}],
        ImageSize->{620, 390},
        PlotRange->{{0, 620}, {0, 390}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$13445 = \
($CellContext`mouseDownPosition$13445 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$13445 = \
$CellContext`model$13445; $CellContext`mouseDownHit$13445 = \
$CellContext`GetHit[$CellContext`model$13445, 
            $CellContext`hitTransform$13445[$CellContext`mouseDownPosition$\
13445]]; $CellContext`mouseDownOnSelection$13445 = 
          Intersection[$CellContext`selection$13445, \
$CellContext`mouseDownHit$13445] =!= {}; $CellContext`selection$13445 = 
          If[$CellContext`mouseDownHit$13445 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$13445, \
$CellContext`mouseDownHit$13445]]; $CellContext`firstDrag$13445 = 
          True; $CellContext`mouseDidDrag$13445 = 
          False; $CellContext`mouseDownShiftKey$13445 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$13445], \
$CellContext`mouseDownOnSelection$13445], $CellContext`selection$13445 = \
$CellContext`ToggleSelection[$CellContext`selection$13445, \
$CellContext`mouseDownHit$13445]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$13445], 
            
            Not[$CellContext`mouseDownShiftKey$13445]], \
$CellContext`selection$13445 = $CellContext`mouseDownHit$13445]; \
$CellContext`mouseDidDrag$13445 = True; $CellContext`firstDrag$13445 = False; 
         With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$13445 = \
$CellContext`Drag[$CellContext`mouseDownModel$13445, \
$CellContext`selection$13445, 
              TranslationTransform[
               $CellContext`dragTransform$13445[$CellContext`mousePosition$\
13445 - $CellContext`mouseDownPosition$13445]]]; \
$CellContext`mousePosition$13445 = $CellContext`newPosition$]; \
$CellContext`trace$13445 = $CellContext`UpdateTrace[$CellContext`model$13445, \
$CellContext`tracedObjects$13445, $CellContext`trace$13445]), PassEventsDown -> 
        Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.534601524752548*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Centroid Construction", "Subsection",
 CellChangeTimes->{
  3.438781163234713*^9, {3.438781364990996*^9, 3.438781367678492*^9}, 
   3.438781528342391*^9}],

Cell["\<\
Drag the centroid of the inscribed triangle.  When the centroid coincides \
with the center of the circle, the triangle is equilateral.\
\>", "Text",
 CellChangeTimes->{{3.4387813700314713`*^9, 3.438781370662834*^9}, {
  3.438781479382165*^9, 3.438781518305943*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"centroidConstruction", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"231", ",", "168"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"327", ",", "235"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"231", ",", "168"}], "}"}], ",", 
           SqrtBox["13705"]}], "]"}], ",", "CircleCenterRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"114.20541404207701`", ",", "176.0015430335241`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "3.07319`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"285.9162396056885`", ",", "64.6113805703422`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1.08253`"}], "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"285.9162396056885`", ",", "64.6113805703422`"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"114.20541404207701`", ",", "176.0015430335241`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"345.169034939983`", ",", "193.89269126361603`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "0.22302`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"345.169034939983`", ",", "193.89269126361603`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"285.9162396056885`", ",", "64.6113805703422`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "5"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"200.06082682388273`", ",", "120.30646180193315`"}], "}"}],
           "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"315.54263727283575`", ",", "129.2520359169791`"}], "}"}], 
          "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "8", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"345.169034939983`", ",", "193.89269126361603`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"200.06082682388273`", ",", "120.30646180193315`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"114.20541404207701`", ",", "176.0015430335241`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"315.54263727283575`", ",", "129.2520359169791`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "10"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"248.4302295292494`", ",", "144.83520495582746`"}], "}"}], 
          "]"}], ",", "PointAtIntersection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", "11"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"345.169034939983`", ",", "193.89269126361603`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"114.20541404207701`", ",", "176.0015430335241`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"229.68722449103`", ",", "184.94711714857004`"}], "}"}], 
          "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "14", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"285.9162396056885`", ",", "64.6113805703422`"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"229.68722449103`", ",", "184.94711714857004`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "15"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"481", ",", "338"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "centroidConstruction", "]"}]}], "Input",
 CellChangeTimes->{{3.438781322833305*^9, 3.438781334906537*^9}, {
  3.4387814630497093`*^9, 3.438781466729137*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$16401 = \
$CellContext`selection$16401)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$16401 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$16401 = \
$CellContext`initialModel$16401; $CellContext`selection$16401 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$16401], StandardForm, 
            Graphics],
           
           ImageSizeCache->{{152.1685650594089, 
            321.45058418010024`}, {-109.45058418010025`, 59.45058418010025}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$16401, \
$CellContext`selection$16401], StandardForm, Graphics],
           
           ImageSizeCache->{{271.20777943943483`, 
            283.20777943943483`}, {-34.60530770891427, \
-22.605307708914268`}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$16401, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          338}}],
        ImageSize->{481, 338},
        PlotRange->{{0, 481}, {0, 338}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$16401 = \
($CellContext`mouseDownPosition$16401 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$16401 = \
$CellContext`model$16401; $CellContext`mouseDownHit$16401 = \
$CellContext`GetHit[$CellContext`model$16401, 
            $CellContext`hitTransform$16401[$CellContext`mouseDownPosition$\
16401]]; $CellContext`mouseDownOnSelection$16401 = 
          Intersection[$CellContext`selection$16401, \
$CellContext`mouseDownHit$16401] =!= {}; $CellContext`selection$16401 = 
          If[$CellContext`mouseDownHit$16401 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$16401, \
$CellContext`mouseDownHit$16401]]; $CellContext`firstDrag$16401 = 
          True; $CellContext`mouseDidDrag$16401 = 
          False; $CellContext`mouseDownShiftKey$16401 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$16401], \
$CellContext`mouseDownOnSelection$16401], $CellContext`selection$16401 = \
$CellContext`ToggleSelection[$CellContext`selection$16401, \
$CellContext`mouseDownHit$16401]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$16401], 
            
            Not[$CellContext`mouseDownShiftKey$16401]], \
$CellContext`selection$16401 = $CellContext`mouseDownHit$16401]; \
$CellContext`mouseDidDrag$16401 = True; $CellContext`firstDrag$16401 = False; 
         With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$16401 = \
$CellContext`Drag[$CellContext`mouseDownModel$16401, \
$CellContext`selection$16401, 
              TranslationTransform[
               $CellContext`dragTransform$16401[$CellContext`mousePosition$\
16401 - $CellContext`mouseDownPosition$16401]]]; \
$CellContext`mousePosition$16401 = $CellContext`newPosition$]; \
$CellContext`trace$16401 = $CellContext`UpdateTrace[$CellContext`model$16401, \
$CellContext`tracedObjects$16401, $CellContext`trace$16401]), PassEventsDown -> 
        Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.534601534374297*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Parabolic Locus", "Subsection",
 CellChangeTimes->{{3.438780699603301*^9, 3.438780704968943*^9}}],

Cell["\<\
Select the highest point, press \"Trace\".  Then drag the point at the \
intersection of the horizontal and vertical lines.  The traced point has a \
parabolic path.  Drag any other part of the construction to make other \
parabolic paths.\
\>", "Text",
 CellChangeTimes->{{3.438780298768556*^9, 3.438780339153075*^9}, {
  3.438780719294024*^9, 3.438780801379127*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"parabolicLocusModel", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"221", ",", "318"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"476.051`", ",", "315"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"476.051`", ",", "315"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"221", ",", "318"}], "}"}]}], "}"}], "]"}], ",", 
         "LineThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"326", ",", "262"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"417.866725472`", ",", "315.684384`"}], "}"}], "]"}], ",", 
         "PointOnObject", ",", 
         RowBox[{"{", "0.771872`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"417.866725472`", ",", "315.684384`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"326", ",", "262"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"371.933362736`", ",", "288.842192`"}], "}"}], "]"}], ",", 
         "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"371.933362736`", ",", "288.842192`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"425.617746736`", ",", "196.97546652800003`"}], "}"}]}], 
           "}"}], "]"}], ",", "Perpendicular", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "7"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"417.866725472`", ",", "315.684384`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"414.866725472`", ",", "60.633384000000035`"}], "}"}]}], 
           "}"}], "]"}], ",", "Perpendicular", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "5"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"416.6509152215499`", ",", "212.31984393748394`"}], "}"}], 
          "]"}], ",", "PointAtIntersection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "8"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"689", ",", "540"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{"RunModel", "[", "parabolicLocusModel", "]"}]}], "Input",
 CellChangeTimes->{{3.438780660339003*^9, 3.4387806714200373`*^9}, 
   3.438780876415847*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$22718 = \
$CellContext`selection$22718)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$22718 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$22718 = \
$CellContext`initialModel$22718; $CellContext`selection$22718 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$22718], StandardForm, 
            Graphics],
           
           ImageSizeCache->{{-254870.41421356238`, 
            255490.41421356238`}, {-255129.41421356238`, 
            255231.41421356238`}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$22718, \
$CellContext`selection$22718], StandardForm, Graphics],
           
           ImageSizeCache->{{345.5878031896866, 
            357.5878031896866}, {-83.00524832457404, -71.00524832457404}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$22718, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          540}}],
        ImageSize->{689, 540},
        PlotRange->{{0, 689}, {0, 540}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$22718 = \
($CellContext`mouseDownPosition$22718 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$22718 = \
$CellContext`model$22718; $CellContext`mouseDownHit$22718 = \
$CellContext`GetHit[$CellContext`model$22718, 
            $CellContext`hitTransform$22718[$CellContext`mouseDownPosition$\
22718]]; $CellContext`mouseDownOnSelection$22718 = 
          Intersection[$CellContext`selection$22718, \
$CellContext`mouseDownHit$22718] =!= {}; $CellContext`selection$22718 = 
          If[$CellContext`mouseDownHit$22718 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$22718, \
$CellContext`mouseDownHit$22718]]; $CellContext`firstDrag$22718 = 
          True; $CellContext`mouseDidDrag$22718 = 
          False; $CellContext`mouseDownShiftKey$22718 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$22718], \
$CellContext`mouseDownOnSelection$22718], $CellContext`selection$22718 = \
$CellContext`ToggleSelection[$CellContext`selection$22718, \
$CellContext`mouseDownHit$22718]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$22718], 
            
            Not[$CellContext`mouseDownShiftKey$22718]], \
$CellContext`selection$22718 = $CellContext`mouseDownHit$22718]; \
$CellContext`mouseDidDrag$22718 = True; $CellContext`firstDrag$22718 = False; 
         With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$22718 = \
$CellContext`Drag[$CellContext`mouseDownModel$22718, \
$CellContext`selection$22718, 
              TranslationTransform[
               $CellContext`dragTransform$22718[$CellContext`mousePosition$\
22718 - $CellContext`mouseDownPosition$22718]]]; \
$CellContext`mousePosition$22718 = $CellContext`newPosition$]; \
$CellContext`trace$22718 = $CellContext`UpdateTrace[$CellContext`model$22718, \
$CellContext`tracedObjects$22718, $CellContext`trace$22718]), PassEventsDown -> 
        Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.5346015581339397`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Elliptical Locus", "Subsection",
 CellChangeTimes->{{3.438780699603301*^9, 3.438780704968943*^9}, {
  3.4387810965878696`*^9, 3.438781098248816*^9}}],

Cell["\<\
Select the midpoint of the short line segment, press \"Trace\".  Then drag \
the point on the circle.  The traced point has an elliptical path.  Drag any \
other part of the construction to make other paths.\
\>", "Text",
 CellChangeTimes->{{3.438780298768556*^9, 3.438780339153075*^9}, {
  3.438780719294024*^9, 3.438780801379127*^9}, {3.438781177336316*^9, 
  3.438781203683172*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ellipticalLocusModel", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"194", ",", "246"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"159", ",", "298"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"194", ",", "246"}], "}"}], ",", 
           SqrtBox["3929"]}], "]"}], ",", "CircleCenterRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"134.69134341084742`", ",", "266.285050002156`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "2.81204`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"276.42334341084745`", ",", "266.285050002156`"}], "}"}], 
          "]"}], ",", "Translation", ",", 
         RowBox[{"{", 
          RowBox[{"141.732`", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "4", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"330", ",", "374"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"448", ",", "206"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"448", ",", "206"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"330", ",", "374"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "6"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"449.50338157775934`", ",", "387.85317204796314`"}], "}"}],
           "]"}], ",", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "8"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"449.50338157775934`", ",", "387.85317204796314`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"134.69134341084742`", ",", "266.285050002156`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"292.0973624943034`", ",", "327.06911102505956`"}], "}"}], 
          "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "10", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"276.42334341084745`", ",", "266.285050002156`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"292.0973624943034`", ",", "327.06911102505956`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "11"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"284.26035295257543`", ",", "296.6770805136078`"}], "}"}], 
          "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "12", "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"722", ",", "610"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "ellipticalLocusModel", "]"}]}], "Input",
 CellChangeTimes->{{3.438781140125218*^9, 3.4387811468632603`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$36880 = \
$CellContext`selection$36880)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$36880 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$36880 = \
$CellContext`initialModel$36880; $CellContext`selection$36880 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$36880], StandardForm, 
            Graphics],
           
           ImageSizeCache->{{124.35479898580189`, 
            451.9142135623731}, {-0.6452010141981077, 191.00089975725479`}}], 
          
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$36880, \
$CellContext`selection$36880], StandardForm, Graphics],
           ImageSizeCache->{{174., 186.}, {49., 61.}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$36880, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          610}}],
        ImageSize->{722, 610},
        PlotRange->{{0, 722}, {0, 610}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$36880 = \
($CellContext`mouseDownPosition$36880 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$36880 = \
$CellContext`model$36880; $CellContext`mouseDownHit$36880 = \
$CellContext`GetHit[$CellContext`model$36880, 
            $CellContext`hitTransform$36880[$CellContext`mouseDownPosition$\
36880]]; $CellContext`mouseDownOnSelection$36880 = 
          Intersection[$CellContext`selection$36880, \
$CellContext`mouseDownHit$36880] =!= {}; $CellContext`selection$36880 = 
          If[$CellContext`mouseDownHit$36880 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$36880, \
$CellContext`mouseDownHit$36880]]; $CellContext`firstDrag$36880 = 
          True; $CellContext`mouseDidDrag$36880 = 
          False; $CellContext`mouseDownShiftKey$36880 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$36880], \
$CellContext`mouseDownOnSelection$36880], $CellContext`selection$36880 = \
$CellContext`ToggleSelection[$CellContext`selection$36880, \
$CellContext`mouseDownHit$36880]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$36880], 
            
            Not[$CellContext`mouseDownShiftKey$36880]], \
$CellContext`selection$36880 = $CellContext`mouseDownHit$36880]; \
$CellContext`mouseDidDrag$36880 = True; $CellContext`firstDrag$36880 = False; 
         With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$36880 = \
$CellContext`Drag[$CellContext`mouseDownModel$36880, \
$CellContext`selection$36880, 
              TranslationTransform[
               $CellContext`dragTransform$36880[$CellContext`mousePosition$\
36880 - $CellContext`mouseDownPosition$36880]]]; \
$CellContext`mousePosition$36880 = $CellContext`newPosition$]; \
$CellContext`trace$36880 = $CellContext`UpdateTrace[$CellContext`model$36880, \
$CellContext`tracedObjects$36880, $CellContext`trace$36880]), PassEventsDown -> 
        Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.5346016308087263`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Pantograph", "Subsection",
 CellChangeTimes->{{3.438782678582665*^9, 3.4387826799457283`*^9}}],

Cell["\<\
Click the point and the center of the right circle and the point to its right \
on the horizontal line to select both points.  Press \"Trace\" to trace them. \
 Then click the background to deselect everything, and drag the point at the \
center of the right circle.  You'll see a functioning pantograph.\
\>", "Text",
 CellChangeTimes->{{3.4387829156510344`*^9, 3.438782980781434*^9}, {
  3.4387831125372753`*^9, 3.4387831967091312`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pantograph", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"25", ",", "27"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"107.018`", ",", "28"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"107.018`", ",", "28"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"25", ",", "27"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"134", ",", "265"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"252", ",", "265"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Ray", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"252", ",", "265"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"134", ",", "265"}], "}"}]}], "}"}], "]"}], ",", 
         "RayThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"134", ",", "265"}], "}"}], ",", "82.02409599623759`"}], 
          "]"}], ",", "CircleByRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"252", ",", "265"}], "}"}], ",", "82.02409599623759`"}], 
          "]"}], ",", "CircleByRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"192.99999999999972`", ",", "208.017964901207`"}], "}"}], 
          "]"}], ",", "PointAtIntersection1", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "8"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Ray", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"192.99999999999972`", ",", "208.017964901207`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"134", ",", "265"}], "}"}]}], "}"}], "]"}], ",", 
         "RayThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"252", ",", "265"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"192.99999999999972`", ",", "208.017964901207`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"298.4961299999992`", ",", "106.13009740210819`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "2.78807`", "}"}], ",", 
         RowBox[{"{", "10", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"298.4961299999992`", ",", "106.13009740210819`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"192.99999999999972`", ",", "208.017964901207`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"353.82619851647706`", ",", "159.56772293133784`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"294.8261985164768`", ",", "102.58568783254483`"}], 
             "}"}]}], "}"}], "]"}], ",", "Parallel", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"11", ",", "12"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"249.94754596658834`", ",", "266.9822543689919`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"190.94754596658862`", ",", "323.9642894677849`"}], 
             "}"}]}], "}"}], "]"}], ",", "Parallel", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", "5"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"357.4961299999995`", ",", "163.11213250090123`"}], "}"}], 
          "]"}], ",", "PointAtIntersection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"14", ",", "15"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"462.99226`", ",", "265.`"}], "}"}], "]"}], ",", 
         "PointAtIntersection", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "14"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"192.99999999999972`", ",", "208.017964901207`"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"134", ",", "265"}], "}"}]}], "}"}], "]"}], ",", 
         "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"298.4961299999992`", ",", "106.13009740210819`"}], "}"}], 
          "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "13", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"357.4961299999995`", ",", "163.11213250090123`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"298.4961299999992`", ",", "106.13009740210819`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"16", ",", "19"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"252", ",", "265"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"357.4961299999995`", ",", "163.11213250090123`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "16"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"462.99226`", ",", "265.`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"357.4961299999995`", ",", "163.11213250090123`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"17", ",", "16"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"617", ",", "425"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "pantograph", "]"}]}], "Input",
 CellChangeTimes->{{3.438782682299424*^9, 3.438782713224702*^9}, {
  3.4387828633694344`*^9, 3.4387828870484657`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$46675 = \
$CellContext`selection$46675)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$46675 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$46675 = \
$CellContext`initialModel$46675; $CellContext`selection$46675 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$46675], StandardForm, 
            Graphics],
           
           ImageSizeCache->{{-53624.41421356237, 
            107231.41421356237`}, {-41013.41421356237, 40896.41421356237}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$46675, \
$CellContext`selection$46675], StandardForm, Graphics],
           
           ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
            4.503599627370496*^15, -4.503599627370496*^15}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$46675, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          425}}],
        ImageSize->{617, 425},
        PlotRange->{{0, 617}, {0, 425}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$46675 = \
($CellContext`mouseDownPosition$46675 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$46675 = \
$CellContext`model$46675; $CellContext`mouseDownHit$46675 = \
$CellContext`GetHit[$CellContext`model$46675, 
            $CellContext`hitTransform$46675[$CellContext`mouseDownPosition$\
46675]]; $CellContext`mouseDownOnSelection$46675 = 
          Intersection[$CellContext`selection$46675, \
$CellContext`mouseDownHit$46675] =!= {}; $CellContext`selection$46675 = 
          If[$CellContext`mouseDownHit$46675 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$46675, \
$CellContext`mouseDownHit$46675]]; $CellContext`firstDrag$46675 = 
          True; $CellContext`mouseDidDrag$46675 = 
          False; $CellContext`mouseDownShiftKey$46675 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$46675], \
$CellContext`mouseDownOnSelection$46675], $CellContext`selection$46675 = \
$CellContext`ToggleSelection[$CellContext`selection$46675, \
$CellContext`mouseDownHit$46675]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$46675], 
            
            Not[$CellContext`mouseDownShiftKey$46675]], \
$CellContext`selection$46675 = $CellContext`mouseDownHit$46675]; \
$CellContext`mouseDidDrag$46675 = True; $CellContext`firstDrag$46675 = False; 
         With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$46675 = \
$CellContext`Drag[$CellContext`mouseDownModel$46675, \
$CellContext`selection$46675, 
              TranslationTransform[
               $CellContext`dragTransform$46675[$CellContext`mousePosition$\
46675 - $CellContext`mouseDownPosition$46675]]]; \
$CellContext`mousePosition$46675 = $CellContext`newPosition$]; \
$CellContext`trace$46675 = $CellContext`UpdateTrace[$CellContext`model$46675, \
$CellContext`tracedObjects$46675, $CellContext`trace$46675]), PassEventsDown -> 
        Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.534601655753376*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Hyperbolic Trace", "Subsection",
 CellChangeTimes->{{3.438796893952669*^9, 3.438796898328253*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hyperbolicTrace", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"186", ",", "179"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"220", ",", "229"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"186", ",", "179"}], "}"}], ",", 
           RowBox[{"2", " ", 
            SqrtBox["914"]}]}], "]"}], ",", "CircleCenterRadius", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"243.37122841716868`", ",", "198.09298692989282`"}], "}"}],
           "]"}], ",", "PointOnObject", ",", 
         RowBox[{"{", "0.321268`", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"376", ",", "173"}], "}"}], "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LineSegment", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"376", ",", "173"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"243.37122841716868`", ",", "198.09298692989282`"}], 
             "}"}]}], "}"}], "]"}], ",", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"309.68561420858435`", ",", "185.54649346494642`"}], "}"}],
           "]"}], ",", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"309.68561420858435`", ",", "185.54649346494642`"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"284.59262727869157`", ",", "52.9177218821151`"}], 
             "}"}]}], "}"}], "]"}], ",", "Perpendicular", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "7"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"478", ",", "384"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RunModel", "[", "hyperbolicTrace", "]"}]}], "Input",
 CellChangeTimes->{{3.438796841249798*^9, 3.4387969056085787`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[GridBox[{
        {
         ButtonBox[
          StyleBox["\<\"Trace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`tracedObjects$48809 = \
$CellContext`selection$48809)& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {
         ButtonBox[
          StyleBox["\<\"Erase\\nTrace\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`trace$48809 = \
$CellContext`EmptyTrace[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]},
        {"\<\"\"\>"},
        {
         ButtonBox[
          StyleBox["\<\"Reset\"\>",
           StripOnInput->False,
           FontSize->8],
          Appearance->"Palette",
          
          ButtonFunction:>(($CellContext`model$48809 = \
$CellContext`initialModel$48809; $CellContext`selection$48809 = \
$CellContext`EmptySelection[])& ),
          Evaluator->Automatic,
          ImageSize->{33, 33},
          Method->"Preemptive"]}
       },
       GridBoxAlignment->{"Columns" -> {{"Center"}}, "Rows" -> {{"Center"}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{0}}}],
      "Column"], 
     TagBox[
      FrameBox[
       GraphicsBox[GeometricTransformationBox[{
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderModel[$CellContext`model$48809], StandardForm, 
            Graphics],
           
           ImageSizeCache->{{-24810.414213562384`, 
            25404.414213562384`}, {-132626.41421356238`, 
            132767.41421356238`}}], 
          DynamicBox[Typeset`ToBoxes[
            $CellContext`RenderSelection[$CellContext`model$48809, \
$CellContext`selection$48809], StandardForm, Graphics],
           
           ImageSizeCache->{{4.503599627370496*^15, -4.503599627370496*^15}, {
            4.503599627370496*^15, -4.503599627370496*^15}}], 
          
          DynamicBox[
           Typeset`ToBoxes[$CellContext`trace$48809, StandardForm, Graphics],
           ImageSizeCache->{{0., 0.}, {0., 0.}}]}, {{{1, 0}, {0, -1}}, {0, 
          384}}],
        ImageSize->{478, 384},
        PlotRange->{{0, 478}, {0, 384}}],
       StripOnInput->False],
      EventHandlerTag[{
       "MouseDown" :> ($CellContext`mousePosition$48809 = \
($CellContext`mouseDownPosition$48809 = 
           MousePosition[
            "Graphics"]); $CellContext`mouseDownModel$48809 = \
$CellContext`model$48809; $CellContext`mouseDownHit$48809 = \
$CellContext`GetHit[$CellContext`model$48809, 
            $CellContext`hitTransform$48809[$CellContext`mouseDownPosition$\
48809]]; $CellContext`mouseDownOnSelection$48809 = 
          Intersection[$CellContext`selection$48809, \
$CellContext`mouseDownHit$48809] =!= {}; $CellContext`selection$48809 = 
          If[$CellContext`mouseDownHit$48809 === {}, 
            $CellContext`EmptySelection[], 
            
            Union[$CellContext`selection$48809, \
$CellContext`mouseDownHit$48809]]; $CellContext`firstDrag$48809 = 
          True; $CellContext`mouseDidDrag$48809 = 
          False; $CellContext`mouseDownShiftKey$48809 = 
          CurrentValue["ShiftKey"]; Null), "MouseUp" :> If[
          And[
           
           Not[$CellContext`mouseDidDrag$48809], \
$CellContext`mouseDownOnSelection$48809], $CellContext`selection$48809 = \
$CellContext`ToggleSelection[$CellContext`selection$48809, \
$CellContext`mouseDownHit$48809]], "MouseDragged" :> (If[
           And[
            Not[$CellContext`mouseDownOnSelection$48809], 
            
            Not[$CellContext`mouseDownShiftKey$48809]], \
$CellContext`selection$48809 = $CellContext`mouseDownHit$48809]; \
$CellContext`mouseDidDrag$48809 = True; $CellContext`firstDrag$48809 = False; 
         With[{$CellContext`newPosition$ = 
            MousePosition[
             "Graphics"]}, $CellContext`model$48809 = \
$CellContext`Drag[$CellContext`mouseDownModel$48809, \
$CellContext`selection$48809, 
              TranslationTransform[
               $CellContext`dragTransform$48809[$CellContext`mousePosition$\
48809 - $CellContext`mouseDownPosition$48809]]]; \
$CellContext`mousePosition$48809 = $CellContext`newPosition$]; \
$CellContext`trace$48809 = $CellContext`UpdateTrace[$CellContext`model$48809, \
$CellContext`tracedObjects$48809, $CellContext`trace$48809]), PassEventsDown -> 
        Automatic, PassEventsUp -> True}]]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Rows" -> {{Top}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.534601673705892*^9}]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.438018909659019*^9, 3.438018915812456*^9}, {
  3.438105967704818*^9, 3.438105968085754*^9}, {3.4381090446417017`*^9, 
  3.438109045006662*^9}, {3.43845797037278*^9, 3.438457977728137*^9}, {
  3.438604923864585*^9, 3.438604927381139*^9}}],

Cell["\<\
As a consequence of GSP's strict enforcement of constructions-only, each \
object has associated with it a single relation on other objects.  Therefore \
a constrained structure can be expressed as a list of objects, one relation \
per object.  Leaves are always points.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4380189297685347`*^9, 3.4380190789813833`*^9}, {
  3.438082899620655*^9, 3.4380829051634407`*^9}}],

Cell[CellGroupData[{

Cell["SyntaxInformation", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.43853799340493*^9, 3.438538000853655*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "[", "LineSegment", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "___", "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438109217805357*^9, 3.438109240773151*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "[", "Ray", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "___", "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438109217805357*^9, 3.438109243756527*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "[", "LabelObjects", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", "___", "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438109217805357*^9, 3.438109243756527*^9}, 
   3.438373104310891*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Debug Utilities", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438772837790268*^9, 3.4387728399541693`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DebugPrint", "[", "x___", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"NotebookWrite", "[", 
        RowBox[{
         RowBox[{"MessagesNotebook", "[", "]"}], ",", 
         RowBox[{"ToBoxes", "[", "#", "]"}]}], "]"}], "&"}], " ", "/@", " ", 
      RowBox[{"{", "x", "}"}]}], ";", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"MessagesNotebook", "[", "]"}], ",", "\"\<\\n\>\""}], "]"}]}], 
    ")"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438772841883924*^9, 3.438772861636322*^9}, {
  3.438772905977544*^9, 3.4387729318467827`*^9}, {3.438772990184876*^9, 
  3.438773009360928*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Model and Object Projection Functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438531982888589*^9, 3.4385319902873793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ObjectCache", "[", "object_", "]"}], ":=", 
  RowBox[{"object", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438531992493202*^9, 3.438532006067556*^9}, {
  3.438532454894484*^9, 3.438532464667429*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintFunction", "[", "object_", "]"}], ":=", 
  RowBox[{"object", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438531992493202*^9, 3.438532006067556*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParameterArguments", "[", "object_", "]"}], ":=", 
  RowBox[{"object", "[", 
   RowBox[{"[", "3", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438531992493202*^9, 3.438532006067556*^9}, {
  3.438532056542345*^9, 3.4385321240989447`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ObjectArguments", "[", "object_", "]"}], ":=", 
  RowBox[{"object", "[", 
   RowBox[{"[", "4", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438531992493202*^9, 3.438532006067556*^9}, {
  3.438532056542345*^9, 3.43853209549907*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["RenderModel", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438083390418531*^9, 3.438083392139024*^9}, {
  3.438537971394278*^9, 3.4385379727652884`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "RenderModel", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4383627530995626`*^9, 3.4383627554268417`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderModel", "[", 
   RowBox[{"model_List", ",", " ", "opts___"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "labelObjects", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"labelObjects", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"LabelObjects", "/.", 
         RowBox[{"{", "opts", "}"}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{"LabelObjects", "\[Rule]", "False"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"LineColor", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RenderObject", "[", 
           RowBox[{"#1", ",", "labelObjects", ",", "#2"}], "]"}], "&"}], ",", 
         " ", 
         RowBox[{"Select", "[", 
          RowBox[{"model", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "=!=", "Point"}], 
             ")"}], "&"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RenderObject", "[", 
           RowBox[{"#1", ",", "labelObjects", ",", "#2"}], "]"}], "&"}], ",", 
         " ", 
         RowBox[{"Select", "[", 
          RowBox[{"model", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "Point"}], 
             ")"}], "&"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438082931943461*^9, 3.4380829448283567`*^9}, {
  3.438082992728578*^9, 3.438083016877119*^9}, {3.438083942817164*^9, 
  3.438083951421555*^9}, {3.4380839898699007`*^9, 3.43808399274966*^9}, {
  3.43836047104292*^9, 3.43836048181789*^9}, {3.4383623209637403`*^9, 
  3.438362363483638*^9}, {3.4383624629197483`*^9, 3.438362498196526*^9}, {
  3.4383626020087976`*^9, 3.4383626050204763`*^9}, {3.438362783113497*^9, 
  3.4383628029016314`*^9}, {3.438543819541912*^9, 3.4385438741928473`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LineColor", "[", "]"}], ":=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.0067750057221332115`", ",", "0.`", ",", "0.4`"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083907329523*^9, 3.438083911765191*^9}, {
  3.4380840592175426`*^9, 3.438084062872446*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CircleColor", "[", "]"}], ":=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.1322194247348745`", ",", "0.6`", ",", "0.`"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083913541498*^9, 3.438083924235567*^9}, {
  3.438084057226754*^9, 3.438084065368415*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "RenderObject", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438084961719989*^9, 3.438084967220899*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Point", "[", "pt_", "]"}], ",", "___"}], "}"}], ",", 
    "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"FaceForm", "[", "Red", "]"}], ",", 
    RowBox[{"EdgeForm", "[", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"AbsoluteThickness", "[", "1", "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Disk", "[", 
     RowBox[{"pt", ",", 
      RowBox[{"Offset", "[", 
       RowBox[{"2.5", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"labelObject", ",", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"i", ",", "14"}], "]"}], ",", 
        RowBox[{"Offset", "[", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], ",", "pt"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083019167383*^9, 3.438083057534326*^9}, {
  3.438083955728963*^9, 3.438083981127119*^9}, {3.4380840240337973`*^9, 
  3.4380840311988373`*^9}, {3.438084900369686*^9, 3.438084902477441*^9}, {
  3.4381029227616463`*^9, 3.438102925097144*^9}, {3.438105985407544*^9, 
  3.438105985838964*^9}, {3.438362390662531*^9, 3.438362393652244*^9}, {
  3.438362432009324*^9, 3.438362451011517*^9}, {3.4383625119049664`*^9, 
  3.438362564654516*^9}, {3.438362883178219*^9, 3.438362957367488*^9}, {
  3.438363098160565*^9, 3.438363105741858*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LineSegment", "[", 
       RowBox[{"{", 
        RowBox[{"pt1_", ",", "pt2_"}], "}"}], "]"}], ",", "___"}], "}"}], ",",
     "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"pt1", ",", "pt2"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"labelObject", ",", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"i", ",", "14", ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pt1", "+", "pt2"}], ")"}], "/", "2"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083042605836*^9, 3.4380830650534067`*^9}, {
   3.438083099206868*^9, 3.438083106083701*^9}, {3.438084906054965*^9, 
   3.4380849080062838`*^9}, {3.438102889029818*^9, 3.438102893328597*^9}, 
   3.438106048045034*^9, 3.438362398406337*^9, {3.4383624431349163`*^9, 
   3.438362453927163*^9}, {3.4383629786886053`*^9, 3.4383630207264233`*^9}, {
   3.438363057041162*^9, 3.4383630732860403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"pt1_", ",", "pt2_"}], "}"}], "]"}], ",", "___"}], "}"}], ",",
     "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", "1000"}], "}"}], ",", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pt1", " ", "+", 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"pt1", "-", "pt2"}], ")"}]}]}], ",", " ", 
       RowBox[{"pt2", "+", 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"pt2", "-", "pt1"}], ")"}]}]}]}], "}"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380830675336437`*^9, 3.438083167972753*^9}, 
   3.438083632826252*^9, {3.438084909887355*^9, 3.4380849118306932`*^9}, {
   3.438102896306999*^9, 3.438102898793536*^9}, 3.438106093590179*^9, 
   3.4383624001856613`*^9, {3.438362444016089*^9, 3.438362454527946*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ray", "[", 
       RowBox[{"{", 
        RowBox[{"pt1_", ",", "pt2_"}], "}"}], "]"}], ",", "___"}], "}"}], ",",
     "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", "1000"}], "}"}], ",", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{"pt2", ",", " ", 
       RowBox[{"pt1", "+", 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"pt1", "-", "pt2"}], ")"}]}]}]}], "}"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380830675336437`*^9, 3.4380832094624434`*^9}, {
   3.438084913519136*^9, 3.438084915630823*^9}, {3.4381029010019407`*^9, 
   3.438102903785225*^9}, 3.438106113668552*^9, 3.438362401377495*^9, {
   3.438362444513053*^9, 3.438362454862693*^9}, {3.438706803127452*^9, 
   3.438706811819936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{"c_", ",", " ", "r_"}], "]"}], ",", "___"}], "}"}], ",", 
    "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"CircleColor", "[", "]"}], ",", 
    RowBox[{"Circle", "[", 
     RowBox[{"c", ",", "r"}], "]"}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083218209655*^9, 3.438083237725712*^9}, {
   3.438083997846736*^9, 3.438084001517963*^9}, {3.4380849180869904`*^9, 
   3.438084920205586*^9}, {3.438102906179286*^9, 3.438102908913003*^9}, 
   3.4381061270138083`*^9, 3.438362402752002*^9, {3.438362445047752*^9, 
   3.438362455159017*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$Failed", ",", " ", "_", ",", " ", "_", ",", " ", "_"}], "}"}], 
    ",", "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43808523874478*^9, 3.4380852480851583`*^9}, {
   3.438102917760668*^9, 3.43810291855978*^9}, 3.4383624045758533`*^9, {
   3.438362445621202*^9, 3.438362455447281*^9}, {3.43869694270827*^9, 
   3.438696964425024*^9}, {3.4386970446836443`*^9, 3.438697044920106*^9}, 
   3.438697103265123*^9, {3.438712531497179*^9, 3.438712544657778*^9}, {
   3.4387126286588383`*^9, 3.438712629853561*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderObject", "[", 
   RowBox[{"x_", ",", "labelObject_", ",", 
    RowBox[{"{", "i_", "}"}]}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<can't render \>\"", ",", " ", "x"}], "]"}], ";", 
    RowBox[{"{", "}"}]}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43808523874478*^9, 3.4380852480851583`*^9}, {
   3.438102917760668*^9, 3.43810291855978*^9}, 3.4383624045758533`*^9, {
   3.438362445621202*^9, 3.438362455447281*^9}, {3.43869694270827*^9, 
   3.438696964425024*^9}, {3.4386970446836443`*^9, 3.438697044920106*^9}, 
   3.438697103265123*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["DrawConstraintGraph", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438086748650729*^9, 3.438086751315278*^9}, 
   3.438538035060328*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DrawConstraintGraph", "[", "model_", "]"}], ":=", 
  RowBox[{"LayeredGraphPlot", "[", 
   RowBox[{
    RowBox[{"ToConstraintGraph", "[", "model", "]"}], ",", 
    RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4381093681965322`*^9, 3.4381093834253073`*^9}, {
  3.43810943550134*^9, 3.4381094359293013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToConstraintGraph", "[", "model_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "VertexLabel", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"VertexLabel", "[", "i_", "]"}], ":=", 
      RowBox[{
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\< (\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Head", "[", 
         RowBox[{"ObjectCache", "[", 
          RowBox[{"model", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], "<>", 
       "\"\<)\>\"", "<>", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ConstraintFunction", "[", 
           RowBox[{"model", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "===", "Null"}], ",", 
         "\"\<\>\"", ",", 
         RowBox[{"\"\<\\n\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"ConstraintFunction", "[", 
            RowBox[{"model", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}]}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"VertexLabel", "[", "i", "]"}], "->", 
             RowBox[{"VertexLabel", "[", "#", "]"}]}], "&"}], " ", "/@", " ", 
           
           RowBox[{"ObjectArguments", "[", 
            RowBox[{"model", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "model", "]"}]}], "}"}]}], "]"}], ",", 
       "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380857091301622`*^9, 3.438085721844913*^9}, {
   3.438085770032125*^9, 3.438085816461973*^9}, {3.438085884104425*^9, 
   3.438085920910079*^9}, 3.438085968493471*^9, {3.4380860460425463`*^9, 
   3.438086090783574*^9}, {3.43808612543486*^9, 3.4380861255756407`*^9}, {
   3.4380861570483437`*^9, 3.438086176615988*^9}, 3.4380862094475822`*^9, {
   3.438086305674684*^9, 3.4380863472241583`*^9}, {3.438086389853154*^9, 
   3.438086401096963*^9}, {3.438086772010807*^9, 3.438086787495275*^9}, {
   3.43808704080932*^9, 3.438087042913713*^9}, 3.438087080701858*^9, {
   3.438087143765677*^9, 3.4380872002165003`*^9}, {3.438102993378148*^9, 
   3.438103012052706*^9}, {3.438106166310463*^9, 3.438106181660595*^9}, {
   3.4383451692887383`*^9, 3.438345209219219*^9}, {3.438345262423024*^9, 
   3.438345302105421*^9}, {3.438532170299592*^9, 3.438532180499082*^9}, {
   3.438532248201169*^9, 3.438532253901506*^9}, {3.438532488333029*^9, 
   3.438532498720368*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["DrawIndexGraph", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438086748650729*^9, 3.438086751315278*^9}, {
   3.4381092709335337`*^9, 3.438109271518366*^9}, 3.438538040435007*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DrawIndexGraph", "[", "model_", "]"}], ":=", 
  RowBox[{"LayeredGraphPlot", "[", 
   RowBox[{
    RowBox[{"ToIndexGraph", "[", "model", "]"}], ",", 
    RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4381093681965322`*^9, 3.438109440401617*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToIndexGraph", "[", "model_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "VertexLabel", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"VertexLabel", "[", "i_", "]"}], ":=", "i"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"i", "->", 
           RowBox[{"ObjectArguments", "[", 
            RowBox[{"model", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "model", "]"}]}], "}"}]}], "]"}], ",", 
       "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380857091301622`*^9, 3.438085721844913*^9}, {
   3.438085770032125*^9, 3.438085816461973*^9}, {3.438085884104425*^9, 
   3.438085920910079*^9}, 3.438085968493471*^9, {3.4380860460425463`*^9, 
   3.438086090783574*^9}, {3.43808612543486*^9, 3.4380861255756407`*^9}, {
   3.4380861570483437`*^9, 3.438086176615988*^9}, 3.4380862094475822`*^9, {
   3.438086305674684*^9, 3.4380863472241583`*^9}, {3.438086389853154*^9, 
   3.438086401096963*^9}, {3.438086772010807*^9, 3.438086787495275*^9}, {
   3.43808704080932*^9, 3.438087042913713*^9}, 3.438087080701858*^9, {
   3.438087143765677*^9, 3.4380872002165003`*^9}, {3.438102993378148*^9, 
   3.438103012052706*^9}, {3.438106166310463*^9, 3.438106181660595*^9}, {
   3.438109273772092*^9, 3.43810928383263*^9}, {3.438109401987691*^9, 
   3.4381094172533827`*^9}, 3.438532259235633*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["PrettyPrintModel", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{3.438533434630862*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PrettyPrintModel", "[", "model_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", "=", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"#", ",", 
           RowBox[{"i", "++"}]}], "]"}], "&"}], " ", "/@", " ", "model"}], 
       ",", 
       RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
       RowBox[{"Dividers", "\[Rule]", "Automatic"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438533312285843*^9, 3.438533411461409*^9}, 
   3.438533442978717*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["LeafIndices", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4384368631821957`*^9, 3.4384368647518806`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LeafIndices", "[", "model_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"First", " ", "/@", " ", 
   RowBox[{"Position", "[", 
    RowBox[{"model", ",", " ", 
     RowBox[{"{", 
      RowBox[{"_", ",", "Null", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], ",", "1"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438436873074225*^9, 3.438436878996484*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Construct", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4381052292313223`*^9, 3.4381052408776827`*^9}, {
  3.438344416736085*^9, 3.438344423168009*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Construct", "[", "model_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Resatisfy", "[", 
   RowBox[{"model", ",", " ", 
    RowBox[{"LeafIndices", "[", "model", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438523825632718*^9, 3.43852382786045*^9}, {
  3.438523893721911*^9, 3.43852389486084*^9}, {3.4385249057526083`*^9, 
  3.4385249062460613`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Constraints", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4381052573045473`*^9, 3.4381052585757217`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CircleCenterRadius", "[", 
   RowBox[{
    RowBox[{"Point", "[", "c_", "]"}], ",", 
    RowBox[{"Point", "[", "r_", "]"}]}], "]"}], ":=", 
  RowBox[{"Circle", "[", 
   RowBox[{"c", ",", 
    RowBox[{"Norm", "[", 
     RowBox[{"r", "-", "c"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090283488566*^9, 3.438090302510235*^9}, {
  3.4380919818185596`*^9, 3.438091991159019*^9}, {3.4381053962053757`*^9, 
  3.4381054026806393`*^9}, {3.438105438430071*^9, 3.4381054471047583`*^9}, {
  3.438105993946743*^9, 3.438105995436957*^9}, {3.438344175764976*^9, 
  3.438344178977532*^9}, {3.4384344973570023`*^9, 3.4384344992901783`*^9}, {
  3.438435711885648*^9, 3.4384357386682863`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CircleByRadius", "[", 
   RowBox[{
    RowBox[{"Point", "[", "c_", "]"}], ",", 
    RowBox[{"LineSegment", "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Circle", "[", 
   RowBox[{"c", ",", 
    RowBox[{"Norm", "[", 
     RowBox[{"p2", "-", "p1"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090283488566*^9, 3.438090302510235*^9}, {
  3.4380919818185596`*^9, 3.438091991159019*^9}, {3.4381053962053757`*^9, 
  3.4381054026806393`*^9}, {3.438105438430071*^9, 3.4381054471047583`*^9}, {
  3.438105993946743*^9, 3.438105995436957*^9}, {3.438344175764976*^9, 
  3.438344178977532*^9}, {3.4384344973570023`*^9, 3.4384344992901783`*^9}, {
  3.438435711885648*^9, 3.4384357386682863`*^9}, {3.438695701129149*^9, 
  3.438695726040936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "CircleByRadius", "]"}], ":=", 
  RowBox[{"{", "2", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointOnObject", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", "r_"}], "]"}], ",", "a_"}], "]"}], ":=", 
  RowBox[{"Point", "[", 
   RowBox[{"c", "+", 
    RowBox[{"r", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "a", "]"}], ",", 
       RowBox[{"Sin", "[", "a", "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090322736787*^9, 3.43809032590158*^9}, {
   3.4380906046390657`*^9, 3.4380906618780403`*^9}, {3.4380906985946712`*^9, 
   3.438090770348379*^9}, {3.438092006258031*^9, 3.438092014327174*^9}, {
   3.438092130268738*^9, 3.438092132415217*^9}, 3.438106129245789*^9, {
   3.438344181730592*^9, 3.438344185065558*^9}, {3.438434501594719*^9, 
   3.438434503346094*^9}, {3.4384357131546087`*^9, 3.438435740641636*^9}, {
   3.4385314433358088`*^9, 3.4385314457134666`*^9}, {3.4385316590474377`*^9, 
   3.438531662019321*^9}, {3.4386185069437523`*^9, 3.438618508908032*^9}, {
   3.438688652203985*^9, 3.438688654193203*^9}, {3.438688748308526*^9, 
   3.4386887500812197`*^9}, {3.4386893620604773`*^9, 3.43868939456242*^9}, 
   3.438689795001113*^9, {3.4386905294153767`*^9, 3.438690540752809*^9}, {
   3.438690653592551*^9, 3.438690659244639*^9}, 3.438691568642468*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LineThroughPoints", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p1_", "]"}], ",", 
    RowBox[{"Point", "[", "p2_", "]"}]}], "]"}], ":=", 
  RowBox[{"Line", "[", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090799841749*^9, 3.4380908291748238`*^9}, {
  3.438103498147629*^9, 3.438103507577651*^9}, {3.43810599697622*^9, 
  3.438105998043755*^9}, {3.4383441938346863`*^9, 3.4383441961048603`*^9}, {
  3.438434506162348*^9, 3.438434507657571*^9}, {3.438435715433539*^9, 
  3.438435742177422*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LineSegmentThroughPoints", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p1_", "]"}], ",", 
    RowBox[{"Point", "[", "p2_", "]"}]}], "]"}], ":=", 
  RowBox[{"LineSegment", "[", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090799841749*^9, 3.4380908291748238`*^9}, {
  3.438103498147629*^9, 3.438103507577651*^9}, {3.43810599697622*^9, 
  3.438105998043755*^9}, {3.4383441938346863`*^9, 3.438344210897807*^9}, {
  3.43843450965022*^9, 3.4384345113135977`*^9}, {3.438435721842711*^9, 
  3.438435744018032*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RayThroughPoints", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p1_", "]"}], ",", 
    RowBox[{"Point", "[", "p2_", "]"}]}], "]"}], ":=", 
  RowBox[{"Ray", "[", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090799841749*^9, 3.4380908291748238`*^9}, {
  3.438103498147629*^9, 3.438103507577651*^9}, {3.43810599697622*^9, 
  3.438105998043755*^9}, {3.4383441938346863`*^9, 3.438344221146179*^9}, {
  3.438434513666067*^9, 3.438434515104746*^9}, {3.438435725357511*^9, 
  3.438435745873458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", "Midpoint", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.458557738801639*^9, 3.458557765263216*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Midpoint", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p1_", "]"}], ",", 
    RowBox[{"Point", "[", "p2_", "]"}]}], "]"}], ":=", 
  RowBox[{"Point", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p1", "+", "p2"}], ")"}], "/", "2"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380908978602123`*^9, 3.438090940430127*^9}, {
  3.4381036826202*^9, 3.438103685128295*^9}, {3.438103760216571*^9, 
  3.438103764378023*^9}, {3.438103835396172*^9, 3.43810383706501*^9}, {
  3.438105999317615*^9, 3.4381059999822474`*^9}, {3.438344229375052*^9, 
  3.438344234337702*^9}, {3.438434517169834*^9, 3.438434518617797*^9}, {
  3.438435726781746*^9, 3.438435747313993*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Midpoint", "[", 
   RowBox[{"LineSegment", "[", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], "]"}], ":=", 
  RowBox[{"Point", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p1", "+", "p2"}], ")"}], "/", "2"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380908978602123`*^9, 3.438090940430127*^9}, {
   3.4381036826202*^9, 3.438103685128295*^9}, {3.438103760216571*^9, 
   3.438103809240643*^9}, {3.4381038397857237`*^9, 3.438103841704974*^9}, 
   3.4381060510024853`*^9, {3.438344237530786*^9, 3.4383442397380333`*^9}, {
   3.438434520682266*^9, 3.438434522177658*^9}, {3.438435727492681*^9, 
   3.438435749313114*^9}, {3.43869624595479*^9, 3.438696268803076*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Protect", "[", "Midpoint", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4585577456664457`*^9, 3.458557767187742*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Parallel", "[", 
   RowBox[{
    RowBox[{"line", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}], "[", 
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], ",", 
    RowBox[{"point", ":", 
     RowBox[{"Point", "[", "p0_", "]"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", 
      RowBox[{"p0", "-", 
       RowBox[{
        RowBox[{"ProjectPoint", "[", 
         RowBox[{"point", ",", " ", "line"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", "+", "v"}], ",", 
       RowBox[{"p2", "+", "v"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380908978602123`*^9, 3.438090940430127*^9}, {
   3.4381036826202*^9, 3.438103685128295*^9}, {3.438103760216571*^9, 
   3.438103809240643*^9}, {3.4381038397857237`*^9, 3.438103841704974*^9}, 
   3.4381060510024853`*^9, {3.438344237530786*^9, 3.4383442397380333`*^9}, {
   3.438434520682266*^9, 3.438434522177658*^9}, {3.438435727492681*^9, 
   3.438435749313114*^9}, {3.438696219897235*^9, 3.4386962320632067`*^9}, {
   3.4386962718918953`*^9, 3.4386962767477283`*^9}, {3.438696311916209*^9, 
   3.438696368919881*^9}, {3.4386965220842333`*^9, 3.438696679257002*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "Parallel", "]"}], ":=", 
  RowBox[{"{", "1", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}, {
  3.4387172631559067`*^9, 3.43871727070444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Perpendicular", "[", 
   RowBox[{
    RowBox[{"line", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}], "[", 
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], ",", 
    RowBox[{"point", ":", 
     RowBox[{"Point", "[", "p0_", "]"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Line", "[", 
   RowBox[{"{", 
    RowBox[{"p0", ",", " ", 
     RowBox[{"p0", "+", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], " ", 
       RowBox[{"Reverse", "[", 
        RowBox[{"p2", "-", "p1"}], "]"}]}]}]}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380908978602123`*^9, 3.438090940430127*^9}, {
   3.4381036826202*^9, 3.438103685128295*^9}, {3.438103760216571*^9, 
   3.438103809240643*^9}, {3.4381038397857237`*^9, 3.438103841704974*^9}, 
   3.4381060510024853`*^9, {3.438344237530786*^9, 3.4383442397380333`*^9}, {
   3.438434520682266*^9, 3.438434522177658*^9}, {3.438435727492681*^9, 
   3.438435749313114*^9}, {3.438696219897235*^9, 3.4386962320632067`*^9}, {
   3.4386962718918953`*^9, 3.4386962767477283`*^9}, {3.438696311916209*^9, 
   3.438696368919881*^9}, {3.4386965220842333`*^9, 3.438696679257002*^9}, {
   3.438709398677662*^9, 3.438709400433139*^9}, {3.4387094699118156`*^9, 
   3.438709477512945*^9}, {3.4387095390292463`*^9, 3.438709548073902*^9}, {
   3.4387096106518097`*^9, 3.438709613910988*^9}, {3.438709655412723*^9, 
   3.43870965765736*^9}, {3.438709754070725*^9, 3.4387097626742363`*^9}, {
   3.438711080387611*^9, 3.4387110855160007`*^9}, {3.438711661920292*^9, 
   3.438711675381195*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "Perpendicular", "]"}], ":=", 
  RowBox[{"{", "1", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}, {
  3.4387172631559067`*^9, 3.438717279859502*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointOnObject", "[", 
   RowBox[{
    RowBox[{"LineSegment", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}], ",", " ", 
    "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{"p2", "+", " ", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{"t", ",", "1"}], "]"}], ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"p1", "-", "p2"}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438344591112109*^9, 3.438344713012328*^9}, {
   3.43834474368999*^9, 3.4383447476970043`*^9}, {3.438434542756167*^9, 
   3.438434544867216*^9}, {3.4385246040247993`*^9, 3.43852460555048*^9}, 
   3.438531452840191*^9, {3.438531667229896*^9, 3.438531671509264*^9}, {
   3.43870749831164*^9, 3.4387075083012753`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointOnObject", "[", 
   RowBox[{
    RowBox[{"Line", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}], ",", " ", 
    "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{"p2", "+", " ", 
    RowBox[{"t", 
     RowBox[{"(", 
      RowBox[{"p1", "-", "p2"}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438344591112109*^9, 3.438344713012328*^9}, {
   3.43834474368999*^9, 3.4383447476970043`*^9}, {3.438434542756167*^9, 
   3.438434544867216*^9}, {3.4385246040247993`*^9, 3.43852460555048*^9}, 
   3.438531452840191*^9, {3.438531667229896*^9, 3.438531671509264*^9}, {
   3.438697156852768*^9, 3.438697167953197*^9}, {3.438707511229601*^9, 
   3.4387075159733152`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointOnObject", "[", 
   RowBox[{
    RowBox[{"Ray", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}], ",", " ", 
    "t_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{"p2", " ", "+", " ", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"t", ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"p1", "-", "p2"}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438344591112109*^9, 3.438344713012328*^9}, {
   3.43834474368999*^9, 3.4383447476970043`*^9}, {3.438434542756167*^9, 
   3.438434544867216*^9}, {3.4385246040247993`*^9, 3.43852460555048*^9}, 
   3.438531452840191*^9, {3.438531667229896*^9, 3.438531671509264*^9}, {
   3.438697159538978*^9, 3.43869717730517*^9}, {3.438707038231195*^9, 
   3.4387070503965673`*^9}, {3.438707208645316*^9, 3.438707224084371*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointAtIntersection", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"h1", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"h2", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p3", ":", 
        RowBox[{"{", 
         RowBox[{"x3_", ",", "y3_"}], "}"}]}], ",", 
       RowBox[{"p4", ":", 
        RowBox[{"{", 
         RowBox[{"x4_", ",", "y4_"}], "}"}]}]}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "x2"}], " ", "y1"}], "+", 
          RowBox[{"x3", " ", "y1"}], "+", 
          RowBox[{"x1", " ", "y2"}], "-", 
          RowBox[{"x3", " ", "y2"}], "-", 
          RowBox[{"x1", " ", "y3"}], "+", 
          RowBox[{"x2", " ", "y3"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "x3"}], " ", "y1"}], "+", 
          RowBox[{"x4", " ", "y1"}], "+", 
          RowBox[{"x3", " ", "y2"}], "-", 
          RowBox[{"x4", " ", "y2"}], "+", 
          RowBox[{"x1", " ", "y3"}], "-", 
          RowBox[{"x2", " ", "y3"}], "-", 
          RowBox[{"x1", " ", "y4"}], "+", 
          RowBox[{"x2", " ", "y4"}]}]]}]}], ",", 
      RowBox[{"r", "=", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "x3"}], " ", "y1"}], "+", 
          RowBox[{"x4", " ", "y1"}], "+", 
          RowBox[{"x1", " ", "y3"}], "-", 
          RowBox[{"x4", " ", "y3"}], "-", 
          RowBox[{"x1", " ", "y4"}], "+", 
          RowBox[{"x3", " ", "y4"}]}], 
         RowBox[{
          RowBox[{"x3", " ", "y1"}], "-", 
          RowBox[{"x4", " ", "y1"}], "-", 
          RowBox[{"x3", " ", "y2"}], "+", 
          RowBox[{"x4", " ", "y2"}], "-", 
          RowBox[{"x1", " ", "y3"}], "+", 
          RowBox[{"x2", " ", "y3"}], "+", 
          RowBox[{"x1", " ", "y4"}], "-", 
          RowBox[{"x2", " ", "y4"}]}]]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h1", "===", "LineSegment"}], " ", "&&", " ", 
           RowBox[{"0", "\[LessEqual]", "r", "\[LessEqual]", "1"}]}], ")"}], 
         " ", "||", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h1", "===", "Ray"}], " ", "&&", " ", 
           RowBox[{"r", "\[LessEqual]", "1"}]}], ")"}], " ", "||", " ", 
         RowBox[{"h1", "===", "Line"}]}], ")"}], " ", "&&", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h2", "===", "LineSegment"}], " ", "&&", " ", 
           RowBox[{"0", "\[LessEqual]", "s", "\[LessEqual]", "1"}]}], ")"}], 
         " ", "||", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"h2", "===", "Ray"}], " ", "&&", " ", 
           RowBox[{"s", "\[LessEqual]", "1"}]}], ")"}], " ", "||", " ", 
         RowBox[{"h2", "===", "Line"}]}], ")"}]}], ",", 
      RowBox[{"Point", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x1"}], "+", "x2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "x3"}], " ", "y1"}], "+", 
               RowBox[{"x4", " ", "y1"}], "+", 
               RowBox[{"x1", " ", "y3"}], "-", 
               RowBox[{"x4", " ", "y3"}], "-", 
               RowBox[{"x1", " ", "y4"}], "+", 
               RowBox[{"x3", " ", "y4"}]}], ")"}]}], 
            RowBox[{
             RowBox[{"x3", " ", "y1"}], "-", 
             RowBox[{"x4", " ", "y1"}], "-", 
             RowBox[{"x3", " ", "y2"}], "+", 
             RowBox[{"x4", " ", "y2"}], "-", 
             RowBox[{"x1", " ", "y3"}], "+", 
             RowBox[{"x2", " ", "y3"}], "+", 
             RowBox[{"x1", " ", "y4"}], "-", 
             RowBox[{"x2", " ", "y4"}]}]]}], ",", 
          RowBox[{"y1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "y1"}], "+", "y2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "x3"}], " ", "y1"}], "+", 
               RowBox[{"x4", " ", "y1"}], "+", 
               RowBox[{"x1", " ", "y3"}], "-", 
               RowBox[{"x4", " ", "y3"}], "-", 
               RowBox[{"x1", " ", "y4"}], "+", 
               RowBox[{"x3", " ", "y4"}]}], ")"}]}], 
            RowBox[{
             RowBox[{"x3", " ", "y1"}], "-", 
             RowBox[{"x4", " ", "y1"}], "-", 
             RowBox[{"x3", " ", "y2"}], "+", 
             RowBox[{"x4", " ", "y2"}], "-", 
             RowBox[{"x1", " ", "y3"}], "+", 
             RowBox[{"x2", " ", "y3"}], "+", 
             RowBox[{"x1", " ", "y4"}], "-", 
             RowBox[{"x2", " ", "y4"}]}]]}]}], "}"}], "//", "N"}], "]"}], ",",
       "$Failed"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438090949289904*^9, 3.438090971680419*^9}, {
   3.438103968569306*^9, 3.438103995584474*^9}, {3.438104211420615*^9, 
   3.438104338763379*^9}, {3.438104409765685*^9, 3.4381044124262257`*^9}, {
   3.438104446833692*^9, 3.438104450186722*^9}, {3.438106053352564*^9, 
   3.438106067586561*^9}, 3.438106200263122*^9, {3.4383442604574213`*^9, 
   3.4383442648125763`*^9}, {3.438434529844927*^9, 3.43843453492624*^9}, {
   3.438434669114737*^9, 3.4384346787862377`*^9}, {3.438435484048012*^9, 
   3.4384354938081303`*^9}, {3.438435807008772*^9, 3.438435821910182*^9}, {
   3.43870830087254*^9, 3.438708360355076*^9}, {3.438708416499084*^9, 
   3.438708537025853*^9}, {3.4387087123986807`*^9, 3.438708717224864*^9}, {
   3.438708775957781*^9, 3.43870878557941*^9}, {3.438708834063686*^9, 
   3.438708840996058*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointAtIntersection1", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"c1", ":", 
       RowBox[{"{", 
        RowBox[{"c1x_", ",", "c1y_"}], "}"}]}], ",", "r1_"}], "]"}], ",", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"c2", ":", 
       RowBox[{"{", 
        RowBox[{"c2x_", ",", "c2y_"}], "}"}]}], ",", "r2_"}], "]"}]}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"root", "=", 
      RowBox[{"N", "[", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"c1x", "-", "c2x"}], ")"}], "2"]}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["c1x", "4"], "+", 
            SuperscriptBox["c1y", "4"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["c1x", "3"], " ", "c2x"}], "+", 
            SuperscriptBox["c2x", "4"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["c1y", "3"], " ", "c2y"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["c2y", "2"]}], "+", 
            SuperscriptBox["c2y", "4"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["r1", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2y", "2"], " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["r1", "4"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2y", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "+", 
            SuperscriptBox["r2", "4"], "-", 
            RowBox[{"4", " ", "c1y", " ", "c2y", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c2x", "2"], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "-", 
            RowBox[{"4", " ", "c1x", " ", "c2x", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1y", "2"], "+", 
               SuperscriptBox["c2x", "2"], "-", 
               RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c1x", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1y", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["c2x", "2"]}], "-", 
               RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c1y", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c2x", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}]}], ")"}]}], ")"}]}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "root", "]"}], "===", "Complex"}], ",", "$Failed",
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1x", "4"], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["c1y", "2"]}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["c1x", "3"], " ", "c2x"}], "-", 
               RowBox[{
                SuperscriptBox["c1y", "2"], " ", 
                SuperscriptBox["c2x", "2"]}], "+", 
               RowBox[{"2", " ", "c1x", " ", 
                SuperscriptBox["c2x", "3"]}], "-", 
               SuperscriptBox["c2x", "4"], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["c1x", "2"], " ", "c1y", " ", "c2y"}], "+", 
               RowBox[{"2", " ", "c1y", " ", 
                SuperscriptBox["c2x", "2"], " ", "c2y"}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", 
                SuperscriptBox["r1", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["r2", "2"]}], "-", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", 
                SuperscriptBox["r2", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["r2", "2"]}], "+", 
               RowBox[{"c1y", " ", "root"}], "-", 
               RowBox[{"c2y", " ", "root"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"c1x", "-", "c2x"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["c1x", "2"], "+", 
                 SuperscriptBox["c1y", "2"], "-", 
                 RowBox[{"2", " ", "c1x", " ", "c2x"}], "+", 
                 SuperscriptBox["c2x", "2"], "-", 
                 RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
                 SuperscriptBox["c2y", "2"]}], ")"}]}], ")"}]}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", "c1y"}], "+", 
               SuperscriptBox["c1y", "3"], "-", 
               RowBox[{"2", " ", "c1x", " ", "c1y", " ", "c2x"}], "+", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["c2x", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", "c2y"}], "-", 
               RowBox[{
                SuperscriptBox["c1y", "2"], " ", "c2y"}], "-", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", "c2y"}], "+", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", "c2y"}], "-", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["c2y", "2"]}], "+", 
               SuperscriptBox["c2y", "3"], "-", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"c2y", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["r2", "2"]}], "-", 
               RowBox[{"c2y", " ", 
                SuperscriptBox["r2", "2"]}], "-", "root"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["c1x", "2"], "+", 
                 SuperscriptBox["c1y", "2"], "-", 
                 RowBox[{"2", " ", "c1x", " ", "c2x"}], "+", 
                 SuperscriptBox["c2x", "2"], "-", 
                 RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
                 SuperscriptBox["c2y", "2"]}], ")"}]}], ")"}]}]}]}], "}"}]}], 
        "]"}], "//", "N"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43843472370999*^9, 3.43843475348237*^9}, {
  3.438434886443983*^9, 3.438434900978075*^9}, {3.43843495222731*^9, 
  3.438435026066283*^9}, {3.438435070431456*^9, 3.438435085129595*^9}, {
  3.438435168707837*^9, 3.438435318309105*^9}, {3.4384353528468847`*^9, 
  3.43843545006945*^9}, {3.438435860382575*^9, 3.438435865929481*^9}, {
  3.438435896592725*^9, 3.4384359286706123`*^9}, {3.438435963522635*^9, 
  3.438435963986064*^9}, {3.4386958055963*^9, 3.4386958151462793`*^9}, {
  3.438711966336549*^9, 3.438711966461096*^9}, {3.4387789299821777`*^9, 
  3.438778930166333*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PointAtIntersection2", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"c1", ":", 
       RowBox[{"{", 
        RowBox[{"c1x_", ",", "c1y_"}], "}"}]}], ",", "r1_"}], "]"}], ",", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"c2", ":", 
       RowBox[{"{", 
        RowBox[{"c2x_", ",", "c2y_"}], "}"}]}], ",", "r2_"}], "]"}]}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"root", "=", 
      RowBox[{"N", "[", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"c1x", "-", "c2x"}], ")"}], "2"]}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["c1x", "4"], "+", 
            SuperscriptBox["c1y", "4"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["c1x", "3"], " ", "c2x"}], "+", 
            SuperscriptBox["c2x", "4"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["c1y", "3"], " ", "c2y"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["c2y", "2"]}], "+", 
            SuperscriptBox["c2y", "4"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["r1", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2y", "2"], " ", 
             SuperscriptBox["r1", "2"]}], "+", 
            SuperscriptBox["r1", "4"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2x", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["c2y", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["r1", "2"], " ", 
             SuperscriptBox["r2", "2"]}], "+", 
            SuperscriptBox["r2", "4"], "-", 
            RowBox[{"4", " ", "c1y", " ", "c2y", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c2x", "2"], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "-", 
            RowBox[{"4", " ", "c1x", " ", "c2x", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1y", "2"], "+", 
               SuperscriptBox["c2x", "2"], "-", 
               RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c1x", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1y", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["c2x", "2"]}], "-", 
               RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
               SuperscriptBox["c2y", "2"], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["c1y", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c2x", "2"], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               SuperscriptBox["r1", "2"], "-", 
               SuperscriptBox["r2", "2"]}], ")"}]}]}], ")"}]}], ")"}]}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "root", "]"}], "===", "Complex"}], ",", "$Failed",
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1x", "4"], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["c1y", "2"]}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["c1x", "3"], " ", "c2x"}], "-", 
               RowBox[{
                SuperscriptBox["c1y", "2"], " ", 
                SuperscriptBox["c2x", "2"]}], "+", 
               RowBox[{"2", " ", "c1x", " ", 
                SuperscriptBox["c2x", "3"]}], "-", 
               SuperscriptBox["c2x", "4"], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["c1x", "2"], " ", "c1y", " ", "c2y"}], "+", 
               RowBox[{"2", " ", "c1y", " ", 
                SuperscriptBox["c2x", "2"], " ", "c2y"}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["c2y", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", 
                SuperscriptBox["r1", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", 
                SuperscriptBox["r2", "2"]}], "-", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", 
                SuperscriptBox["r2", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", 
                SuperscriptBox["r2", "2"]}], "-", 
               RowBox[{"c1y", " ", "root"}], "+", 
               RowBox[{"c2y", " ", "root"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"c1x", "-", "c2x"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["c1x", "2"], "+", 
                 SuperscriptBox["c1y", "2"], "-", 
                 RowBox[{"2", " ", "c1x", " ", "c2x"}], "+", 
                 SuperscriptBox["c2x", "2"], "-", 
                 RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
                 SuperscriptBox["c2y", "2"]}], ")"}]}], ")"}]}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", "c1y"}], "+", 
               SuperscriptBox["c1y", "3"], "-", 
               RowBox[{"2", " ", "c1x", " ", "c1y", " ", "c2x"}], "+", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["c2x", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["c1x", "2"], " ", "c2y"}], "-", 
               RowBox[{
                SuperscriptBox["c1y", "2"], " ", "c2y"}], "-", 
               RowBox[{"2", " ", "c1x", " ", "c2x", " ", "c2y"}], "+", 
               RowBox[{
                SuperscriptBox["c2x", "2"], " ", "c2y"}], "-", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["c2y", "2"]}], "+", 
               SuperscriptBox["c2y", "3"], "-", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"c2y", " ", 
                SuperscriptBox["r1", "2"]}], "+", 
               RowBox[{"c1y", " ", 
                SuperscriptBox["r2", "2"]}], "-", 
               RowBox[{"c2y", " ", 
                SuperscriptBox["r2", "2"]}], "+", "root"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["c1x", "2"], "+", 
                 SuperscriptBox["c1y", "2"], "-", 
                 RowBox[{"2", " ", "c1x", " ", "c2x"}], "+", 
                 SuperscriptBox["c2x", "2"], "-", 
                 RowBox[{"2", " ", "c1y", " ", "c2y"}], "+", 
                 SuperscriptBox["c2y", "2"]}], ")"}]}], ")"}]}]}]}], "}"}]}], 
        "]"}], "//", "N"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43843472370999*^9, 3.43843475348237*^9}, {
  3.438434886443983*^9, 3.438434900978075*^9}, {3.43843495222731*^9, 
  3.438435026066283*^9}, {3.438435070431456*^9, 3.438435085129595*^9}, {
  3.438435168707837*^9, 3.438435318309105*^9}, {3.4384353528468847`*^9, 
  3.43843545006945*^9}, {3.438435860382575*^9, 3.4384358743232727`*^9}, {
  3.43843593856898*^9, 3.438435970282937*^9}, {3.4386958184704323`*^9, 
  3.4386958210422363`*^9}, {3.438711970662538*^9, 3.438711970959571*^9}, {
  3.4387789333373404`*^9, 3.438778933613502*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Translation", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[",
      "pts_", "]"}], ",", "x_", ",", " ", "y_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"head", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "+", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], ")"}], "&"}], " ", "/@", " ", 
    "pts"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.4387140880416737`*^9}, {
  3.438714382036488*^9, 3.438714385081758*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Translation", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", " ", "r_"}], "]"}], ",", "x_", ",", " ", "y_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Circle", "[", 
   RowBox[{
    RowBox[{"c", "+", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]}], ",", "r"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.438714112943643*^9}, {
  3.438714389347822*^9, 3.4387143963001347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Translation", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p_", "]"}], ",", "x_", ",", " ", "y_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{"p", "+", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438714120905571*^9, 3.4387141395352087`*^9}, {
  3.438714391685238*^9, 3.43871440133753*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotation", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[",
      "pts_", "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "a_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"head", "[", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", "p0"}], "]"}], " ", "/@", " ", "pts"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.4387140880416737`*^9}, {
   3.438714382036488*^9, 3.438714385081758*^9}, {3.438714468708665*^9, 
   3.438714469434083*^9}, {3.4387145160937138`*^9, 3.43871452998619*^9}, {
   3.438714593150159*^9, 3.43871460100224*^9}, 3.438714829886491*^9, {
   3.438714883886778*^9, 3.4387148888908663`*^9}, 3.438714945891643*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotation", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", " ", "r_"}], "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "a_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Circle", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RotationTransform", "[", 
      RowBox[{
       RowBox[{"-", "a"}], ",", "p0"}], "]"}], "[", "c", "]"}], ",", "r"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.438714112943643*^9}, {
   3.438714389347822*^9, 3.4387143963001347`*^9}, 3.438714471636639*^9, {
   3.438714538323835*^9, 3.43871453929872*^9}, {3.4387146122049637`*^9, 
   3.438714616345483*^9}, 3.438714892878724*^9, 3.438714947674595*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rotation", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p_", "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "a_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", "p0"}], "]"}], "[", "p", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438714120905571*^9, 3.4387141395352087`*^9}, {
   3.438714391685238*^9, 3.43871440133753*^9}, 3.438714472068523*^9, {
   3.438714541769411*^9, 3.4387145424518337`*^9}, {3.438714624426499*^9, 
   3.438714625721301*^9}, 3.438714893484865*^9, 3.438714948978855*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "Rotation", "]"}], ":=", 
  RowBox[{"{", "2", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}, {
   3.4387172631559067`*^9, 3.43871727070444*^9}, {3.438717326440857*^9, 
   3.438717327207018*^9}, 3.438717371609825*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintTransform", "[", 
   RowBox[{"Rotation", ",", " ", 
    RowBox[{"{", "a_", "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"_", ",", " ", 
      RowBox[{"Point", "[", "p_", "]"}]}], "}"}]}], "]"}], ":=", 
  RowBox[{"RotationTransform", "[", 
   RowBox[{"a", ",", " ", "p"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4387182325635767`*^9, 3.4387182687935133`*^9}, {
   3.438718685213876*^9, 3.438718704609926*^9}, {3.438718736164422*^9, 
   3.438718738601409*^9}, {3.43871886842973*^9, 3.438718896057866*^9}, {
   3.438769936371955*^9, 3.438769962414604*^9}, {3.438771131651795*^9, 
   3.438771132104506*^9}, 3.438773613926077*^9, {3.438774324579049*^9, 
   3.438774329230919*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Scaling", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[",
      "pts_", "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "f_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"head", "[", 
   RowBox[{
    RowBox[{"ScalingTransform", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "f"}], "}"}], ",", "p0"}], "]"}], " ", "/@", " ", 
    "pts"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.4387140880416737`*^9}, {
   3.438714382036488*^9, 3.438714385081758*^9}, {3.438714468708665*^9, 
   3.438714469434083*^9}, {3.4387145160937138`*^9, 3.43871452998619*^9}, {
   3.438714593150159*^9, 3.43871460100224*^9}, 3.438714829886491*^9, {
   3.438714883886778*^9, 3.4387148888908663`*^9}, 3.438714945891643*^9, {
   3.438715194598452*^9, 3.4387152338042183`*^9}, {3.438715339103388*^9, 
   3.438715340707569*^9}, {3.438715605758421*^9, 3.438715606740409*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Scaling", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", " ", "r_"}], "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "f_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Circle", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ScalingTransform", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "f"}], "}"}], ",", "p0"}], "]"}], "[", "c", "]"}], 
    ",", 
    RowBox[{"r", " ", "f"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.438714112943643*^9}, {
   3.438714389347822*^9, 3.4387143963001347`*^9}, 3.438714471636639*^9, {
   3.438714538323835*^9, 3.43871453929872*^9}, {3.4387146122049637`*^9, 
   3.438714616345483*^9}, 3.438714892878724*^9, 3.438714947674595*^9, {
   3.4387152000793333`*^9, 3.438715250202952*^9}, 3.438715354728249*^9, {
   3.438715431252986*^9, 3.438715435377099*^9}, 3.4387156137205067`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Scaling", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p_", "]"}], ",", 
    RowBox[{"Point", "[", "p0_", "]"}], ",", "f_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{
    RowBox[{"ScalingTransform", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "f"}], "}"}], ",", "p0"}], "]"}], "[", "p", "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438714120905571*^9, 3.4387141395352087`*^9}, {
   3.438714391685238*^9, 3.43871440133753*^9}, 3.438714472068523*^9, {
   3.438714541769411*^9, 3.4387145424518337`*^9}, {3.438714624426499*^9, 
   3.438714625721301*^9}, 3.438714893484865*^9, 3.438714948978855*^9, {
   3.438715205758357*^9, 3.438715252283049*^9}, 3.438715355303775*^9, 
   3.438715614759626*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "Scaling", "]"}], ":=", 
  RowBox[{"{", "2", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}, {
  3.4387172631559067`*^9, 3.43871727070444*^9}, {3.438717326440857*^9, 
  3.438717327207018*^9}, {3.438717371609825*^9, 3.438717383129814*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Reflection", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[",
      "pts_", "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"head", "[", 
   RowBox[{
    RowBox[{"ScalingTransform", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"(", 
         RowBox[{"p2", "-", "p1"}], ")"}], "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "p1"}], "]"}], " ", "/@",
     " ", "pts"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.4387140880416737`*^9}, {
   3.438714382036488*^9, 3.438714385081758*^9}, {3.438714468708665*^9, 
   3.438714469434083*^9}, {3.4387145160937138`*^9, 3.43871452998619*^9}, {
   3.438714593150159*^9, 3.43871460100224*^9}, 3.438714829886491*^9, {
   3.438714883886778*^9, 3.4387148888908663`*^9}, 3.438714945891643*^9, {
   3.438715194598452*^9, 3.4387152338042183`*^9}, {3.438715339103388*^9, 
   3.438715340707569*^9}, {3.438715605758421*^9, 3.438715606740409*^9}, {
   3.438715662719646*^9, 3.438715663957364*^9}, {3.4387157793747187`*^9, 
   3.438715818836814*^9}, {3.438716135870492*^9, 3.438716138773836*^9}, 
   3.4387161754676647`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Reflection", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", " ", "r_"}], "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Circle", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ScalingTransform", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{
        RowBox[{"Reverse", "[", 
         RowBox[{"(", 
          RowBox[{"p2", "-", "p1"}], ")"}], "]"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "p1"}], "]"}], "[", 
     "c", "]"}], ",", "r"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438713962915263*^9, 3.438714112943643*^9}, {
   3.438714389347822*^9, 3.4387143963001347`*^9}, 3.438714471636639*^9, {
   3.438714538323835*^9, 3.43871453929872*^9}, {3.4387146122049637`*^9, 
   3.438714616345483*^9}, 3.438714892878724*^9, 3.438714947674595*^9, {
   3.4387152000793333`*^9, 3.438715250202952*^9}, 3.438715354728249*^9, {
   3.438715431252986*^9, 3.438715435377099*^9}, 3.4387156137205067`*^9, 
   3.43871566700012*^9, {3.438715801349784*^9, 3.438715820388846*^9}, {
   3.4387161440735493`*^9, 3.4387161733749323`*^9}, {3.4387162446416073`*^9, 
   3.43871624521395*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Reflection", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p_", "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Point", "[", 
   RowBox[{
    RowBox[{"ScalingTransform", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"(", 
         RowBox[{"p2", "-", "p1"}], ")"}], "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", "p1"}], "]"}], "[", 
    "p", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438714120905571*^9, 3.4387141395352087`*^9}, {
   3.438714391685238*^9, 3.43871440133753*^9}, 3.438714472068523*^9, {
   3.438714541769411*^9, 3.4387145424518337`*^9}, {3.438714624426499*^9, 
   3.438714625721301*^9}, 3.438714893484865*^9, 3.438714948978855*^9, {
   3.438715205758357*^9, 3.438715252283049*^9}, 3.438715355303775*^9, 
   3.438715614759626*^9, 3.438715667951962*^9, {3.438715802924268*^9, 
   3.438715821164933*^9}, {3.438716122353023*^9, 3.43871616724592*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Locus", "[", "___", "]"}], ":=", "$Failed"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4402722304326344`*^9, 3.440272235953004*^9}, {
  3.440272300510437*^9, 3.4402723024284973`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "Reflection", "]"}], ":=", 
  RowBox[{"{", "2", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717148625566*^9, 3.438717208165916*^9}, {
  3.4387172631559067`*^9, 3.43871727070444*^9}, {3.438717326440857*^9, 
  3.438717327207018*^9}, {3.438717371609825*^9, 3.438717383129814*^9}, {
  3.438718543229227*^9, 3.4387185447281847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StationaryObjects", "[", "_", "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4387174400336637`*^9, 3.438717443197906*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintTransform", "[", "___", "]"}], ":=", " ", 
  "Identity"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438717942937068*^9, 3.438717961199134*^9}, {
   3.438769971487522*^9, 3.4387699723827047`*^9}, 3.438774337186379*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Drag", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4383731436348352`*^9, 3.438373144288158*^9}}],

Cell["Drag the selection, resatisfy constraints.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.4383731744514227`*^9, 3.438373270096052*^9}, {
   3.438431911026372*^9, 3.438431930415826*^9}, 3.438456585776129*^9, {
   3.438457887503343*^9, 3.4384578879364967`*^9}, {3.438537918466029*^9, 
   3.438537926365324*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Drag", "[", 
   RowBox[{"model_", ",", " ", "selection_", ",", " ", "t_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newModel", ",", "changedObjects"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newModel", ",", " ", "changedObjects"}], "}"}], " ", "=", " ", 
      RowBox[{"DragSelection", "[", 
       RowBox[{"model", ",", " ", "selection", ",", "t"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Resatisfy", "[", 
      RowBox[{"newModel", ",", " ", "changedObjects"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438373147840066*^9, 3.438373166746851*^9}, {
   3.438427265744673*^9, 3.438427268135578*^9}, {3.438427396795951*^9, 
   3.438427460981089*^9}, {3.4384275656419783`*^9, 3.438427586166754*^9}, {
   3.4384276319266*^9, 3.438427633926209*^9}, {3.438428130662489*^9, 
   3.438428133237916*^9}, {3.438428200530737*^9, 3.438428208599*^9}, 
   3.438436702090878*^9, {3.438436757316441*^9, 3.438436757779611*^9}, {
   3.4384494282328167`*^9, 3.43844943073433*^9}, {3.438449989975171*^9, 
   3.438449994654148*^9}, {3.438454256879919*^9, 3.438454284562799*^9}, {
   3.43845451931831*^9, 3.438454524586001*^9}, {3.438456415944289*^9, 
   3.438456428396303*^9}, {3.438520725207032*^9, 3.438520784007702*^9}, 
   3.43852083693692*^9, 3.438520890412786*^9, {3.438521359685316*^9, 
   3.4385213810016413`*^9}, {3.438521430985847*^9, 3.4385215321539803`*^9}, {
   3.4385215634054317`*^9, 3.438521564736339*^9}, {3.438521781530594*^9, 
   3.438521789890636*^9}, {3.438535363016131*^9, 3.438535365574844*^9}, {
   3.4387731407432117`*^9, 3.438773245735561*^9}, {3.438773369775028*^9, 
   3.4387733806051073`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["DragSelection", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438521612680991*^9, 3.438521619455089*^9}}],

Cell["\<\
Given a model, a selection, and a drag transform, transforms the objects at \
the root of the drag and returns the new model along with the indices of the \
changed objects.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.438521639503167*^9, 3.43852168287969*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DragSelection", "[", 
   RowBox[{"model_", ",", " ", "selection_", ",", " ", "transform_"}], "]"}], 
  " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"newModel", "=", "model"}], ",", " ", 
      RowBox[{"transformQueue", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"selection", ",", "transform"}], "}"}], "]"}]}], ",", " ", 
      RowBox[{"changedObjects", "=", 
       RowBox[{"{", "}"}]}], ",", "i", ",", "t"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"transformQueue", " ", "=!=", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Dequeue", " ", "the", " ", "next", " ", "transform"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "t"}], "}"}], " ", "=", " ", 
         RowBox[{"First", "[", "transformQueue", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"transformQueue", " ", "=", " ", 
         RowBox[{"Rest", "[", "transformQueue", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Process", " ", "the", " ", "dequeued", " ", "transform"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
          RowBox[{"ConstraintFunction", "[", 
           RowBox[{"newModel", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]",
           "PointOnObject", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Project", " ", "transformed", " ", "point", " ", "to", " ", 
            "object", " ", "and", " ", "record", " ", "change"}], " ", "*)"}],
           "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"newModel", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"newModel", ",", " ", 
              RowBox[{"i", "\[Rule]", 
               RowBox[{"ProjectPointToObject", "[", 
                RowBox[{"newModel", ",", " ", "i", ",", " ", "t"}], "]"}]}]}],
              "]"}]}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"changedObjects", ",", " ", "i"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "Null", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{"Drag", " ", "leaf", " ", "point"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"newModel", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"newModel", ",", " ", 
              RowBox[{"i", "\[Rule]", 
               RowBox[{"DragPoint", "[", 
                RowBox[{"newModel", ",", " ", "i", ",", " ", "t"}], "]"}]}]}],
              "]"}]}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"changedObjects", ",", " ", "i"}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"transformQueue", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"transformQueue", ",", " ", "\[IndentingNewLine]", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"objArgs", "=", 
                  RowBox[{"ObjectArguments", "[", 
                   RowBox[{"newModel", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"paramArgs", "=", 
                  RowBox[{"ParameterArguments", "[", 
                   RowBox[{"newModel", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"constraint", "=", 
                  RowBox[{"ConstraintFunction", "[", 
                   RowBox[{"newModel", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"objArgs", "[", 
                   RowBox[{"[", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "objArgs", "]"}], "]"}], ",", 
                    RowBox[{"StationaryObjects", "[", "constraint", "]"}]}], 
                    "]"}], "]"}], "]"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ct", "=", 
                    RowBox[{"ConstraintTransform", "[", 
                    RowBox[{"constraint", ",", " ", "paramArgs", ",", " ", 
                    RowBox[{"First", " ", "/@", " ", 
                    RowBox[{"newModel", "[", 
                    RowBox[{"[", "objArgs", "]"}], "]"}]}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Composition", "[", 
                    RowBox[{"ct", ",", "t", ",", 
                    RowBox[{"InverseFunction", "[", "ct", "]"}]}], "]"}]}], 
                   "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], "]"}]}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newModel", ",", "changedObjects"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438454395016759*^9, 3.438454423806239*^9}, {
   3.438520903220848*^9, 3.438520904490295*^9}, {3.4385218968273907`*^9, 
   3.438521903395979*^9}, {3.438521941068684*^9, 3.438521945449161*^9}, {
   3.438522036300353*^9, 3.438522042068409*^9}, {3.438522094884739*^9, 
   3.4385221284470673`*^9}, {3.438530862349983*^9, 3.438530932856439*^9}, {
   3.438531044523892*^9, 3.4385310741423073`*^9}, {3.4385311150752*^9, 
   3.438531122994628*^9}, {3.438532657055718*^9, 3.438532821077353*^9}, {
   3.4385328523428383`*^9, 3.4385330358244*^9}, {3.438533077917642*^9, 
   3.43853308643274*^9}, {3.4385331242451677`*^9, 3.438533143928087*^9}, {
   3.438533181792913*^9, 3.4385332260177298`*^9}, {3.438533496214142*^9, 
   3.438533499932166*^9}, {3.4385346955343313`*^9, 3.438534749427191*^9}, {
   3.4385348340412407`*^9, 3.4385350359966183`*^9}, {3.438535282349502*^9, 
   3.438535288641403*^9}, {3.438537620965167*^9, 3.43853762546454*^9}, {
   3.438717462450391*^9, 3.438717489239477*^9}, {3.438717525886222*^9, 
   3.4387176300500307`*^9}, {3.438718781311307*^9, 3.438718803180208*^9}, {
   3.438719113222659*^9, 3.438719118189186*^9}, {3.438719184999269*^9, 
   3.438719206463139*^9}, 3.438719294574216*^9, {3.438719342075756*^9, 
   3.438719344566896*^9}, {3.438719382202805*^9, 3.4387194043102083`*^9}, {
   3.4387700174074802`*^9, 3.4387702056900587`*^9}, {3.438770407548265*^9, 
   3.43877041146218*^9}, {3.4387704854170437`*^9, 3.4387705003750134`*^9}, {
   3.4387705661862297`*^9, 3.438770583694401*^9}, {3.438770850284636*^9, 
   3.43877087394666*^9}, {3.4387709187390537`*^9, 3.438770929880892*^9}, {
   3.438770962466469*^9, 3.438770968058309*^9}, {3.438771036808407*^9, 
   3.438771048826766*^9}, {3.4387711506581583`*^9, 3.438771159531652*^9}, 
   3.438771218292756*^9, {3.43877201435741*^9, 3.438772037693255*^9}, 
   3.438772251305087*^9, {3.4387724757722816`*^9, 3.438772477015458*^9}, 
   3.43877268025601*^9, {3.4387736047765923`*^9, 3.438773607462069*^9}, {
   3.438773658804207*^9, 3.4387736615713987`*^9}, {3.4387741620865507`*^9, 
   3.43877423454869*^9}, {3.4387742719038877`*^9, 3.438774274357232*^9}, {
   3.438774338807849*^9, 3.438774357131196*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectPointToObject", "[", 
   RowBox[{"model_", ",", " ", "i_", ",", " ", "t_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"point", " ", "=", " ", 
       RowBox[{"ObjectCache", "[", 
        RowBox[{"model", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{"object", "=", " ", 
       RowBox[{"ObjectCache", "[", 
        RowBox[{"model", "[", 
         RowBox[{"[", 
          RowBox[{"model", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", "newPoint", ",", 
      "newParameter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newPoint", ",", "newParameter"}], "}"}], " ", "=", "  ", 
      RowBox[{"ProjectPoint", "[", 
       RowBox[{
        RowBox[{"TransformObject", "[", 
         RowBox[{"point", ",", "t"}], "]"}], ",", " ", "object"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"model", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "\[Rule]", "newPoint"}], ",", 
         RowBox[{"3", "\[Rule]", 
          RowBox[{"{", "newParameter", "}"}]}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4385336459585867`*^9, 3.438533853369026*^9}, {
   3.438533896615534*^9, 3.4385339656247177`*^9}, {3.438534000450883*^9, 
   3.438534015544526*^9}, {3.43853405349632*^9, 3.4385340598236933`*^9}, 
   3.438534419734954*^9, {3.438534527737135*^9, 3.4385345283276167`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectPoint", "[", 
   RowBox[{
    RowBox[{"Point", "[", "p_", "]"}], ",", " ", 
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", "r_"}], "]"}]}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newP", " ", "=", " ", 
      RowBox[{"c", " ", "+", " ", 
       RowBox[{"r", " ", 
        RowBox[{"Normalize", "[", 
         RowBox[{"p", "-", "c"}], "]"}]}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Point", "[", "newP", "]"}], ",", 
      RowBox[{"ArcTan", "@@", 
       RowBox[{"(", 
        RowBox[{"newP", "-", "c"}], ")"}]}]}], "}"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438534072345861*^9, 3.4385341749670877`*^9}, {
   3.438534208041325*^9, 3.4385342785983343`*^9}, 3.438622646917955*^9, 
   3.4386888351735277`*^9, 3.438689704227324*^9, {3.4386897445872498`*^9, 
   3.438689756966422*^9}, {3.43868986995156*^9, 3.43868992214688*^9}, {
   3.4386905468891907`*^9, 3.438690552245038*^9}, {3.438690665989605*^9, 
   3.438690669989653*^9}, 3.438691575262906*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectPoint", "[", 
   RowBox[{
    RowBox[{"Point", "[", 
     RowBox[{"p0", ":", 
      RowBox[{"{", 
       RowBox[{"x0_", ",", "y0_"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lineLength", ",", "projectedLength", ",", "distance"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lineLength", " ", "=", " ", 
      RowBox[{"Norm", "[", 
       RowBox[{"p1", "-", "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"projectedLength", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p0", "-", "p2"}], ")"}], ".", 
       RowBox[{"Normalize", "[", 
        RowBox[{"p1", "-", "p2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "head", ",", "\[IndentingNewLine]", "LineSegment", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"projectedLength", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"projectedLength", ",", "lineLength"}], "]"}], ",", "0"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "Ray", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"projectedLength", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"projectedLength", ",", "0"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{"p2", " ", "+", " ", 
         RowBox[{"projectedLength", " ", 
          RowBox[{"Normalize", "[", 
           RowBox[{"p1", "-", "p2"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"projectedLength", "/", "lineLength"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438534072345861*^9, 3.4385341749670877`*^9}, {
  3.438534208041325*^9, 3.4385342785983343`*^9}, {3.438540431383582*^9, 
  3.438540461234765*^9}, {3.438546233341928*^9, 3.438546237687273*^9}, {
  3.438546276076586*^9, 3.4385462978318157`*^9}, {3.438546371431782*^9, 
  3.4385464751181927`*^9}, {3.4385465166387653`*^9, 3.438546517859047*^9}, {
  3.438546551832374*^9, 3.438546552460445*^9}, {3.4385466317927437`*^9, 
  3.438546640419458*^9}, {3.43861907038883*^9, 3.4386190811435013`*^9}, {
  3.438621868514423*^9, 3.438621883927102*^9}, {3.438707310809873*^9, 
  3.438707316105276*^9}, {3.438707593724432*^9, 3.4387075940537024`*^9}, {
  3.438707988006295*^9, 3.438707988673674*^9}, {3.438708030635283*^9, 
  3.438708032912977*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DragPoint", "[", 
   RowBox[{"model_", ",", " ", "i_", ",", " ", "t_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pt", " ", "=", " ", 
      RowBox[{
       RowBox[{"ObjectCache", "[", 
        RowBox[{"model", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"model", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"1", "\[Rule]", 
       RowBox[{"Point", "[", 
        RowBox[{"t", "[", "pt", "]"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4385336459585867`*^9, 3.438533853369026*^9}, {
   3.438533896615534*^9, 3.4385339656247177`*^9}, {3.438534000450883*^9, 
   3.438534015544526*^9}, {3.43853405349632*^9, 3.4385340598236933`*^9}, 
   3.438534419734954*^9, {3.438534527737135*^9, 3.4385345283276167`*^9}, {
   3.438535078804823*^9, 3.4385351808870783`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Resatisfy", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.438521630887066*^9, 3.4385216332950363`*^9}}],

Cell["\<\
Given a list of changed objects in a model, resatisfies all the constraints \
in the model.  Objects that do not depend on changed objects are recorded as \
constant, and objects that depend on the changes objects are recalculated.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.438521742911746*^9, 3.438521749334897*^9}, {
  3.438521802271665*^9, 3.4385218576632147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Resatisfy", "[", 
   RowBox[{"model_", ",", " ", "changedObjects_"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"First", "[", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{"ResatisfyStep", ",", 
     RowBox[{"{", 
      RowBox[{"model", ",", " ", 
       RowBox[{"DependentObjects", "[", 
        RowBox[{"model", ",", " ", "changedObjects"}], "]"}]}], "}"}]}], 
    "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438454395016759*^9, 3.438454423806239*^9}, {
  3.438520903220848*^9, 3.438520904490295*^9}, {3.4385218968273907`*^9, 
  3.438521903395979*^9}, {3.438521941068684*^9, 3.438521945449161*^9}, {
  3.438522036300353*^9, 3.438522042068409*^9}, {3.438522094884739*^9, 
  3.4385221284470673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ResatisfyStep", "[", 
    RowBox[{"{", 
     RowBox[{"model_", ",", " ", "invalid_"}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newModel", ",", " ", 
       RowBox[{"newlyCompleted", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newModel", " ", "=", " ", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"invalid", ",", "i"}], "]"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"ObjectArguments", "[", 
                RowBox[{"model", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", "invalid"}],
               "]"}], "===", 
             RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"newlyCompleted", ",", "i"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Rest", "[", 
               RowBox[{"model", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"objectArgs", "=", 
                  RowBox[{"model", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"ObjectArguments", "[", 
                    RowBox[{"model", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
                   "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"objectArgs", ",", "$Failed"}], "]"}], ",", 
                  "\[IndentingNewLine]", "$Failed", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ConstraintFunction", "[", 
                    RowBox[{"model", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "@@", 
                   RowBox[{"Join", "[", 
                    RowBox[{"objectArgs", ",", 
                    RowBox[{"ParameterArguments", "[", 
                    RowBox[{"model", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"model", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "model", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"newModel", ",", 
        RowBox[{"Complement", "[", 
         RowBox[{"invalid", ",", "newlyCompleted"}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438436529315956*^9, 3.4384365548182573`*^9}, {
   3.4384365915431633`*^9, 3.438436607499482*^9}, {3.438436680125736*^9, 
   3.43843670026962*^9}, 3.438437093808358*^9, {3.43843713002458*^9, 
   3.438437158622476*^9}, {3.438437379866671*^9, 3.438437527222267*^9}, {
   3.438437559986146*^9, 3.43843760130608*^9}, {3.4384376589266787`*^9, 
   3.438437660933728*^9}, {3.438437691857594*^9, 3.438437801789358*^9}, {
   3.438437866397615*^9, 3.4384379448271437`*^9}, 3.438438435622191*^9, {
   3.438438487151435*^9, 3.438438510331802*^9}, 3.438454376945632*^9, {
   3.438455800929633*^9, 3.4384558363198957`*^9}, {3.438456088867337*^9, 
   3.438456091650423*^9}, {3.438521904537871*^9, 3.438521913142447*^9}, {
   3.4385221362899113`*^9, 3.438522151942874*^9}, {3.4385233060221767`*^9, 
   3.4385234267969313`*^9}, {3.438523651859128*^9, 3.4385236829296837`*^9}, {
   3.438531711652143*^9, 3.438531716627738*^9}, 3.438532200199059*^9, {
   3.438532266734605*^9, 3.4385322679151487`*^9}, 3.438532330163053*^9, {
   3.438712648697019*^9, 3.438712728034172*^9}, {3.438712843878154*^9, 
   3.438712885985324*^9}}],

Cell["\<\
Given a model and a list of object indices, returns the list of indices of \
dependent objects in the model.\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.438522170583756*^9, 3.438522190895473*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DependentObjects", "[", 
   RowBox[{"model_", ",", " ", "selection_"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"selection", "===", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"directDependencies", "=", 
        RowBox[{"DirectlyDependentObjects", "[", 
         RowBox[{"model", ",", " ", "selection"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Union", "[", 
       RowBox[{"directDependencies", ",", 
        RowBox[{"DependentObjects", "[", 
         RowBox[{"model", ",", "directDependencies"}], "]"}]}], "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438522938139916*^9, 3.438523130933619*^9}, {
  3.4387749537286587`*^9, 3.438774955170236*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DirectlyDependentObjects", "[", 
   RowBox[{"model_", ",", " ", "selection_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{"selection", ",", 
          RowBox[{"ObjectArguments", "[", 
           RowBox[{"model", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "i", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "model", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4385224879540567`*^9, 3.438522546177704*^9}, {
   3.438522610382818*^9, 3.438522617027869*^9}, {3.438522668742998*^9, 
   3.4385227706926117`*^9}, 3.43853226519698*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["TransformObject", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4384280281476107`*^9, 3.43842802954537*^9}, 
   3.438428164002721*^9, 3.438450411135584*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformObject", "[", 
   RowBox[{
    RowBox[{"Point", "[", "pt_", "]"}], ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"Point", "[", 
   RowBox[{"t", "[", "pt", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438428035241374*^9, 3.4384280370835648`*^9}, {
   3.4384280698134937`*^9, 3.438428077674857*^9}, {3.438428164740219*^9, 
   3.438428181703717*^9}, {3.438428222713563*^9, 3.438428247227867*^9}, {
   3.4384282811566763`*^9, 3.4384282818997583`*^9}, 3.4384500153907003`*^9, {
   3.438450152497553*^9, 3.438450155860506*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformObject", "[", 
   RowBox[{
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", " ", "r_Integer"}], "]"}], ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"Circle", "[", 
   RowBox[{
    RowBox[{"t", "[", "c", "]"}], ",", " ", 
    RowBox[{"Norm", "[", 
     RowBox[{"ApplyVectorTransform", "[", 
      RowBox[{"t", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "0"}], "}"}]}], "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438428035241374*^9, 3.4384280370835648`*^9}, {
   3.4384280698134937`*^9, 3.438428089171907*^9}, {3.4384281671406717`*^9, 
   3.438428182126685*^9}, {3.438428224519084*^9, 3.438428283011948*^9}, 
   3.438450016672155*^9, {3.4384501617491417`*^9, 3.4384501624014597`*^9}, {
   3.438450351903297*^9, 3.438450402349415*^9}, {3.438450464304923*^9, 
   3.438450465109521*^9}, {3.438450872898567*^9, 3.438450897389392*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TransformObject", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"LineSegment", "|", "Ray", "|", "Line"}], ")"}]}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], ",", "t_"}], "]"}], " ", ":=", 
  RowBox[{"head", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "[", "p1", "]"}], ",", " ", 
     RowBox[{"t", "[", "p2", "]"}]}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438428035241374*^9, 3.4384280370835648`*^9}, {
   3.4384280698134937`*^9, 3.438428112020784*^9}, {3.4384281681246862`*^9, 
   3.438428182536647*^9}, {3.438428224887086*^9, 3.438428284765032*^9}, {
   3.4384283334320173`*^9, 3.438428335748962*^9}, 3.4384500175447683`*^9, {
   3.438450365382085*^9, 3.438450370294063*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplyVectorTransform", "[", 
   RowBox[{"t_", ",", " ", "v_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TransformationMatrix", "[", "t", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "2"}], ",", 
      RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ".", "v"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438450476727768*^9, 3.438450503068975*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["ImportModel", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{
  3.438608395025898*^9, {3.4386100597800283`*^9, 3.4386100628554573`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetGSPObjectArgs", "[", "x_String", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"\"\<{\>\"", "<>", 
     RowBox[{"StringTake", "[", 
      RowBox[{"x", ",", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}], " ", "+", " ", 
        RowBox[{"First", "[", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"x", ",", 
           RowBox[{"RegularExpression", "[", "\"\<\\\\(.*\\\\)\>\"", "]"}]}], 
          "]"}], "]"}]}]}], "]"}], "<>", "\"\<}\>\""}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4386257325942574`*^9, 3.438625752320064*^9}, {
  3.438625888943213*^9, 3.438625927698061*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParseGSPObject", "[", "x_String", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"parenPos", ",", "args", ",", "argCount", ",", 
      RowBox[{"head", "=", "\"\<\>\""}]}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"parenPos", " ", "=", " ", 
      RowBox[{"StringPosition", "[", 
       RowBox[{"x", ",", 
        RowBox[{"RegularExpression", "[", "\"\<\\\\(.*\\\\)\>\"", "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"parenPos", " ", "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"args", " ", "=", " ", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"\"\<{\>\"", "<>", 
           RowBox[{"StringTake", "[", 
            RowBox[{"x", ",", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}], " ", "+", " ", 
              RowBox[{"First", "[", 
               RowBox[{"StringPosition", "[", 
                RowBox[{"x", ",", 
                 RowBox[{
                 "RegularExpression", "[", "\"\<\\\\(.*\\\\)\>\"", "]"}]}], 
                "]"}], "]"}]}]}], "]"}], "<>", "\"\<}\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"argCount", " ", "=", " ", 
         RowBox[{"Length", "[", "args", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"head", " ", "=", " ", 
         RowBox[{"First", "[", 
          RowBox[{"StringSplit", "[", 
           RowBox[{"x", ",", "\"\<(\>\""}], "]"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"head", "===", "\"\<Point\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Point", "[", "args", "]"}], ",", "Null", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Circle\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "CircleCenterRadius", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Circle by radius\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "CircleByRadius", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Point on object\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "PointOnObject", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Last", "[", "args", "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"First", "[", "args", "]"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Segment\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "LineSegmentThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Line\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "LineThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Ray\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "RayThroughPoints", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Midpoint\>\""}], "&&", 
        RowBox[{"argCount", "===", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Midpoint", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Intersect\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "PointAtIntersection", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Intersect1\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "PointAtIntersection1", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Intersect2\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "PointAtIntersection2", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Parallel\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Parallel", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Perpendicular\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Perpendicular", ",", 
         RowBox[{"{", "}"}], ",", "args"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Translation\>\""}], "&&", 
        RowBox[{"argCount", "===", "3"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Translation", ",", 
         RowBox[{"Rest", "[", "args", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"First", "[", "args", "]"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Rotation\>\""}], "&&", 
        RowBox[{"argCount", "===", "3"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Rotation", ",", 
         RowBox[{"{", 
          RowBox[{"Last", "[", "args", "]"}], "}"}], ",", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"args", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Dilation\>\""}], "&&", 
        RowBox[{"argCount", "===", "3"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Scaling", ",", 
         RowBox[{"{", 
          RowBox[{"Last", "[", "args", "]"}], "}"}], ",", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"args", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Reflection\>\""}], "&&", 
        RowBox[{"argCount", "===", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Reflection", ",", 
         RowBox[{"{", "}"}], ",", " ", "args"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "===", "\"\<Locus\>\""}], "&&", 
        RowBox[{"argCount", "===", "4"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Null", ",", " ", "Locus", ",", 
         RowBox[{"{", 
          RowBox[{"Last", "[", "args", "]"}], "}"}], ",", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"args", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       "True", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Ignoring unknown object \>\"", ",", "x"}], "]"}], ";", 
         
         RowBox[{"{", 
          RowBox[{"Null", ",", "\"\<Unknown\>\"", ",", " ", 
           RowBox[{"{", "}"}], ",", " ", 
           RowBox[{"{", "}"}]}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438625965572483*^9, 3.438626036307386*^9}, {
   3.438626069915642*^9, 3.43862609070636*^9}, {3.438626263191293*^9, 
   3.438626387529574*^9}, {3.4386264422435837`*^9, 3.438626446040634*^9}, {
   3.438626488875229*^9, 3.438626563465939*^9}, {3.438626595674614*^9, 
   3.438626661513558*^9}, {3.438627264738575*^9, 3.438627365502234*^9}, {
   3.4386854347234383`*^9, 3.438685451673643*^9}, {3.438685681524713*^9, 
   3.438685698267522*^9}, {3.4386859072094316`*^9, 3.438685911143002*^9}, 
   3.438687875863432*^9, 3.4386886009231367`*^9, 3.438688696886128*^9, {
   3.438695303893209*^9, 3.43869532060747*^9}, {3.43869573413171*^9, 
   3.438695743326112*^9}, {3.438695848055429*^9, 3.438695856867916*^9}, {
   3.4386961504532843`*^9, 3.4386961528551817`*^9}, {3.438696748178623*^9, 
   3.438696764016417*^9}, {3.438709491565168*^9, 3.438709499883596*^9}, {
   3.438714191756833*^9, 3.438714222052285*^9}, {3.438714656749209*^9, 
   3.438714707086837*^9}, {3.438714792983893*^9, 3.438714795837201*^9}, {
   3.438715369011202*^9, 3.438715376325395*^9}, {3.4387161958686247`*^9, 
   3.438716208237472*^9}, 3.438716293760336*^9, {3.440272068208453*^9, 
   3.440272113627598*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PruneUnknownObjects", "[", "model_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"newModel", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"unknownIndices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"indexMap", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MapIndexed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Unknown", " ", "object"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"Null", ",", " ", "\"\<Unknown\>\"", ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"unknownIndices", ",", " ", 
            RowBox[{"First", "[", "#2", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Known", " ", "object", " ", "with", " ", "dependencies", " ", 
            "on", " ", "unknown", " ", "objects"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"ObjectArguments", "[", "#", "]"}], ",", 
             "unknownIndices"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"unknownIndices", ",", " ", 
            RowBox[{"First", "[", "#2", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Keeper", " ", "*)"}], "\[IndentingNewLine]", 
          "True", ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"newModel", ",", " ", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ObjectArguments", "[", "#", "]"}], "/.", 
                  "indexMap"}], ")"}]}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"indexMap", ",", " ", 
             RowBox[{
              RowBox[{"First", "[", "#2", "]"}], "\[Rule]", 
              RowBox[{"Length", "[", "newModel", "]"}]}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], ",", " ", "model"}], "]"}], ";",
      "\[IndentingNewLine]", "newModel"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438686280844741*^9, 3.438686283170141*^9}, {
  3.438686777846696*^9, 3.438686852965583*^9}, {3.438686910319765*^9, 
  3.438686966677991*^9}, {3.438687064405774*^9, 3.438687631662673*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ImportModel", "[", 
    RowBox[{"name_", ",", "opts___"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fileString", ",", "appletString", ",", "width", ",", " ", "height", 
       ",", "constructionString", ",", "gspObjectStrings", ",", "includeSize",
        ",", " ", "model"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"includeSize", " ", "=", " ", 
       RowBox[{
        RowBox[{"IncludeSize", "/.", 
         RowBox[{"{", "opts", "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"IncludeSize", "\[Rule]", "False"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fileString", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"name", ",", "\"\<String\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"appletString", "=", 
       RowBox[{"First", "[", 
        RowBox[{"StringTake", "[", 
         RowBox[{"fileString", ",", 
          RowBox[{"StringPosition", "[", 
           RowBox[{"fileString", ",", 
            RowBox[{
            "RegularExpression", "[", "\"\<<APPLET.*/APPLET>\>\"", "]"}]}], 
           "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"width", ",", "height"}], "}"}], " ", "=", " ", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"\"\<{\>\"", "<>", "\[IndentingNewLine]", 
         RowBox[{"StringTake", "[", 
          RowBox[{"appletString", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"6", ",", "0"}], "}"}], "+", 
            RowBox[{"First", "[", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"appletString", ",", 
               RowBox[{
               "RegularExpression", "[", "\"\<WIDTH=\\\\d+\>\"", "]"}]}], 
              "]"}], "]"}]}]}], "]"}], "<>", "\[IndentingNewLine]", 
         "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
         RowBox[{"StringTake", "[", 
          RowBox[{"appletString", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"7", ",", "0"}], "}"}], "+", 
            RowBox[{"First", "[", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"appletString", ",", 
               RowBox[{
               "RegularExpression", "[", "\"\<HEIGHT=\\\\d+\>\"", "]"}]}], 
              "]"}], "]"}]}]}], "]"}], "<>", "\"\<}\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"constructionString", "=", 
       RowBox[{"StringTake", "[", 
        RowBox[{"fileString", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"26", ",", 
            RowBox[{"-", "2"}]}], "}"}], "+", 
          RowBox[{"First", "[", 
           RowBox[{"StringPosition", "[", 
            RowBox[{"fileString", ",", 
             RowBox[{
             "RegularExpression", "[", 
              "\"\<NAME=Construction VALUE=\\\".*\\\"\>\"", "]"}]}], "]"}], 
           "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"model", "=", 
       RowBox[{"ParseGSPObject", "/@", " ", 
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"StringReplace", "[", 
           RowBox[{"constructionString", ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"RegularExpression", "[", "\"\<\\[[^]]*\\]\>\"", "]"}],
                "\[Rule]", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"RegularExpression", "[", "\"\<{[^}]*} \>\"", "]"}], 
               "\[Rule]", "\"\<\>\""}], ",", 
              RowBox[{"\"\<\\r\>\"", "\[Rule]", "\"\<\>\""}], ",", 
              RowBox[{"\"\<\\n\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
           "]"}], ",", "\"\<;\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"model", " ", "=", " ", 
       RowBox[{"PruneUnknownObjects", "[", "model", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"model", " ", "=", " ", 
       RowBox[{"Construct", "[", "model", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"includeSize", ",", " ", 
        RowBox[{"{", 
         RowBox[{"model", ",", " ", 
          RowBox[{"{", 
           RowBox[{"width", ",", "height"}], "}"}]}], "}"}], ",", " ", 
        "model"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4385962345684357`*^9, 3.438596285747817*^9}, {
   3.4385963571833*^9, 3.438596358326524*^9}, {3.4385965923539658`*^9, 
   3.438596608029286*^9}, {3.438596894422662*^9, 3.438596938782289*^9}, {
   3.438596973431861*^9, 3.438596975492605*^9}, {3.438597017834073*^9, 
   3.438597262096615*^9}, {3.43859730447683*^9, 3.438597351016511*^9}, {
   3.438598025816452*^9, 3.438598153917315*^9}, {3.438598341595745*^9, 
   3.4385984024129553`*^9}, {3.4385984415176563`*^9, 3.438598491615137*^9}, {
   3.4385985325218983`*^9, 3.438598579039659*^9}, {3.438598613278515*^9, 
   3.438598615238833*^9}, {3.438598689839449*^9, 3.438598742064584*^9}, {
   3.4385988442361298`*^9, 3.4385988485627413`*^9}, {3.438598925218404*^9, 
   3.438598927463842*^9}, 3.438598978104288*^9, {3.4385990211992197`*^9, 
   3.438599053709093*^9}, {3.4385990993756523`*^9, 3.4385991047487288`*^9}, {
   3.438599158256727*^9, 3.438599161068645*^9}, 3.438603269300082*^9, {
   3.438604368482114*^9, 3.438604378552352*^9}, {3.438604586867715*^9, 
   3.438604687448456*^9}, {3.438604754680353*^9, 3.438604761456951*^9}, {
   3.438604837395194*^9, 3.438604860496814*^9}, {3.438605081202136*^9, 
   3.4386052261612988`*^9}, {3.438607523222143*^9, 3.4386075399413433`*^9}, {
   3.4386077448911333`*^9, 3.4386078523236637`*^9}, 3.438610066180717*^9, {
   3.438621738283001*^9, 3.438621739755121*^9}, {3.4386229107028227`*^9, 
   3.438622914549139*^9}, {3.438622955808289*^9, 3.4386229583208437`*^9}, {
   3.43862506644316*^9, 3.438625174537754*^9}, {3.4386273873331823`*^9, 
   3.438627462134611*^9}, {3.438627548383257*^9, 3.438627549297171*^9}, {
   3.438685538266736*^9, 3.438685671828232*^9}, {3.4386857757328367`*^9, 
   3.43868577663168*^9}, 3.438687646432191*^9, 3.4386878523660727`*^9, {
   3.4386884093095407`*^9, 3.438688500385112*^9}, {3.438689268610283*^9, 
   3.4386892696510487`*^9}, {3.438689458453361*^9, 3.438689489171732*^9}, {
   3.438690197467475*^9, 3.438690203875031*^9}, {3.4386902761584063`*^9, 
   3.4386902789774647`*^9}, {3.4386903130143003`*^9, 3.438690373113193*^9}, 
   3.438690493822495*^9, 3.438691682141102*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Tools", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.437743461164487*^9, 3.437743462849448*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "selectOn", ",", "selectOff", ",", "pointOn", ",", "pointOff", ",", 
     "circleOn", ",", "circleOff", ",", "lineSegmentOn", ",", 
     "lineSegmentOff"}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJzt1c9JA0EYxuEFKxArSCX2INhAwLMFahMeLEDEUy6WINn15DLBWWbz7p/n
g/AEEobN8P3I4fj88HTTdd3h93V+b8ye566fz/u/PvbzTm7C15fznEYOFXyP
rO3itp8PclWmuhg+/yIXqS5IXZC6IKepC1IXpC7IaeqC1MXS7AqTfq69q4us
pS70klUXWWu70Mt11EXWVl3opa26yDp3F6VJ/+6lq4usmSrKk76PpaiLrJnt
r5/0PV1bXWTNbHm7Sd/fXOoia2abt7vPrdRF1lb7rIu26iLr3Hurl2nqYtvq
Ypq62Kd6uawu9qkuLqsLrtFhj95GtjpfF1yjpS5a9aILrtHaLmp70QXXqP8L
8v9dtDpfF+R8XZTOIbdkbRel75N7sNTFD6lBO2U=
        "], {{0, 33}, {33, 0}}, {0., 
        1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJzt2kFKw0AUgOGAJxBP0JN4B8ELCK49j15FL+HCpW7EhYjgESSpuGgdSdqX
vEnyPShfugnDMD9dTDdXNxfXJ03TbH4+7fNZN6/nuzbGrHhKXbw8t/NJrtKh
XTzct/NBzsrLbt721AXXbKmLrU976oJrUBekLkhdkIepC1IXY1u698leF4ep
i1iH3pNmr5d/q4tYj/s3gV5qURexRnWhl1x1EevYXehlGnURa1YXpcnej7mq
i1izO+g72ftUu7qINfu8HzvZ+1eLuojVeV6Guog16jzrIlddxDr2udXLNOpi
XupiGnWxDPUSqy6WoS5i1QVr8LSbxz11wTVb6iKrF12wBod2MXYvumAN+r0g
+3eRtR5dkLogdUEe5thd/P9+co7272J7i/pV9O62nfff76X3k3P0Gw9yanc=

        "], {{0, 33}, {33, 0}}, {0., 1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmJmYGBQhGIQO5Rm4O7du////58xYwaQ3UEbgGbFKhqAUStGrRi1
YtSK4WcFAwzQyAoGVDBqBTG2EKN40KaoUStGrRi1glpW3KUlgFjxn8YAaAUD
jQHQCgCFTx0U
        "], {{0, 33}, {33, 0}}, {0, 255},
        ColorFunction->RGBColor],
       BoxForm`ImageTag[
       "Byte", ColorSpace -> "RGB", ImageSize -> Automatic, Interleaving -> 
        True, Magnification -> Automatic],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJzt2rEJwkAAhtEDR3CCTOIOggsI1s6jq+galtqIhYjgCHKJWCgRPSKXcO+H
8JImELivSzVfThejEEL1uOL9uN5x8mowK3htXRz2cVeySH/tYruJu5CDclbv
9KYuWLJtXTTu3tQFS1AXpC5IXZBp6oLUBakLMk1dkLogdUGmqYt+2tV/nrm/
Y6jqIq9dnX+9dKsu8qqLfqqLvOqin+qinzr/edUFqQtSF2SauiB1QeqCTFMX
pC5IXZBp6oLUBakLMs1/d/H5/eQQ/b6L5u/NW6vrVdz5+dz2fnKI3gGs5P6J

        "], {{0, 33}, {33, 0}}, {0., 1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJztnD1OAzEQRlfiBIgT5AwcgDsgcQEkas4Dt6AODSUlBQUFSCiiouEIaNdU
jD4r3r/xjt9I0YuUlTMz9pexvevsrm8vb066rtv9vfr3Z4MdLv6zw7CGTeni
arBXCEPwcd/bt2FSwY9hqS5OB/uEcFP00kX6/AvCKokuIEQXEKILCMcRXcRg
6bryfLCDoXcctRBd+PL+rrc3w5SnJ0O1f66uz/PBsLR95b93XqcSXczLj/fB
DNU4TOPo2VC1U1tcyn8Vb21xKaKLKVTx2vEQOw+WKt58fl4MvfxHF3mq/kq0
8wrm7Xmq/OTrzvp6QReJpfMfb3+jUelF5X/p+Ri6SMzX9/r9j0qV/6V/r1rT
hdo/UXXcy0+Yp+qvufbHWtNF+n67LtjKPglMzM97bf+Wtt+mLmz9jbpeVvcj
vP2qPd6ouvCal9bG1nQx1+9em7qYXme9qMZ56fifq53aqPq3dBxG1UXpvt/a
/bcWtz7OS0m9GMfWxgnxjou3NV0svb8H1yH7UfOS+xcxyP2LdajmpVvxPypV
/pdeJ6KLxNK6HPV+hxd5PqpOXSgmf+3znKqOo5c8eZ42ceu6yJPzF4oqXpUf
lU8v/9HFvFz6vJ5XPeK8HrpYk6Xnu/P1SPH4c99q/19dH3V/G13EYH7devz/
hHjHUQvRBYTL6UK1A2EklupCXQ9hC/wFIYmATA==
        "], {{0, 33}, {33, 0}}, {0., 
        1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJztnUFKxDAUhgueQDzBnMEDeAfBCwiuXXoWvYVr3bh06cKFCwUZREQEjyBt
7MK++cPUtpOX5HswfDMMhLz38jevSTqzOj0/Pttrmmb1+2rfY1jNdtDZ+mjI
l+fWviCskmN1cXvT2ieEWfGkszdDdAFrptJF4KMhuoA1EF345EVn75OZ2o9c
iS7m5X5nr4ZXl63dG4bvr0fyTnD7duL9sf1PHVd04YuHna0N4+PuwVC149Mv
23/lrze/0MW8DNfLJ0N1fVZxS+3HrseJio+KZ2o/0MVmqnypuiLwwzC1H16o
4hOPp3+9lKqLeJ2grm+M/6X1kks9VqouVPxrq3+8MV6P2Xx562cuuhium/yl
vX9MPS7gZsbv93e/Ppa7LlQd621ehnGqfKn8oos4vc2/+FuGv7noQu3nMk7q
9Hfp/f0ydGHXl1Lnc2rex47/udrxRpVfdBHIfBGIv8wXjBP8TeVv7rpgPaoM
sh41L8P1g/2L3KnypfKLLqbEmf1ub1Tx91YflqoLzkelJeejfOoini/O0y49
/jlPm5cuxupFzS+11WPx+ofnL0rVhWK8HuN5PW9+oQufHK6b9OT57ryILnyS
3wNJS3QBIbqAEF1A+D8urYt4+xDmyO11Ef4F4Fuy3+/pP6v2IcyRShc/kc0W
bg==
        "], {{0, 33}, {33, 0}}, {0., 1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJzt1ssNgCAQRdFJrIReqMDEBmjANiyBGuyJWhBFWfgDBp7RxJeYzOqenSpU
36qGiMT6zHcHmzHGWqu1dveA2Y4YAfuJn3g5Qcs+Tezi1YnTfkXiql+LuOlX
Ie775US0X0ik9EuIxD6bSO/ziKw+g8jt5xKMfhbB6ycSx5dndFLKB4iggL56
chua8DeOCPeTvwcGOU9Y8BxB4DliAkX8ElI=
        "], {{0, 33}, {33, 0}}, {0, 255},
        
        ColorFunction->RGBColor],
       BoxForm`ImageTag[
       "Byte", ColorSpace -> "RGB", ImageSize -> Automatic, Interleaving -> 
        True, Magnification -> Automatic],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}], ",", 
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJzt2c1JA1EYhtGBVCBWkErsQbABwXXq0Va0CRcudSMuQhAsQWZGXGS4Q2ZI
7u/5IJxkE7J4HwLJ9n53+7Dpum779+ifXw/3eXNs51zDF+ri472/b7JJl3bx
8tzfgSzKu+G+JuqCLRvqYvRtoi7YgrogdUHqglynLhjTpf8L6IItqAtdtGxu
O9cF7V8XjGOt+9cF7V8XnNf+59VF3dr/OnVRh/Z/XnVRlvYfR13kqf2nVRdp
tf881UUc7b8sdXFe7b8OdbFO+69bXYyGdm7/cbwa7nWiLtKqi7SGukjViy6Y
g0u7uHQvumAO+r4gT+8i1efRBakLUhfkOi/dxfz7kyV6ehfjr/o/QZ8e+9v/
vw69P1miv/4KkBw=
        "], {{0, 33}, {33, 0}}, {0., 1.},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Real", ColorSpace -> Automatic, Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->Automatic,
      ImageSizeRaw->{33, 33},
      PlotRange->{{0, 33}, {0, 33}}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4374999535166607`*^9, 3.437500061771063*^9}, {
   3.437500092322929*^9, 3.437500097014099*^9}, 3.4375035972588263`*^9, {
   3.437755156598366*^9, 3.4377551613108053`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Model", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4377434765872793`*^9, 3.4377434771533318`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EmptyModel", "[", "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437500952345409*^9, 3.4375009579593143`*^9}, {
   3.4375023742162037`*^9, 3.437502375418421*^9}, 3.43750359726017*^9, {
   3.437742507292304*^9, 3.437742507391426*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Selection", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4377434808738213`*^9, 3.437743482401539*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EmptySelection", "[", "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437742709437436*^9, 3.437742744432748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddToSelection", "[", 
   RowBox[{"selection_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{"selection", ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", "x", "}"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437501031299095*^9, 3.437501059168251*^9}, {
   3.437502393086014*^9, 3.437502425253414*^9}, {3.437502486972677*^9, 
   3.437502487562374*^9}, 3.437502623388308*^9, 3.437503597264954*^9, {
   3.437503846836093*^9, 3.437503905955579*^9}, {3.437505418591053*^9, 
   3.437505419641109*^9}, {3.4377425470463333`*^9, 3.437742551957768*^9}, {
   3.437742622758005*^9, 3.437742633883368*^9}, {3.437743531793496*^9, 
   3.437743533236932*^9}, {3.437745814900343*^9, 3.437745819505034*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToggleSelection", "[", 
   RowBox[{"selection_", ",", " ", "x_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{"ToggleSelection", "[", 
   RowBox[{"selection", ",", 
    RowBox[{"{", "x", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437501031299095*^9, 3.437501059168251*^9}, {
   3.437502393086014*^9, 3.437502425253414*^9}, {3.437502486972677*^9, 
   3.437502487562374*^9}, 3.437502623388308*^9, 3.437503597264954*^9, {
   3.437503846836093*^9, 3.437503905955579*^9}, {3.437505418591053*^9, 
   3.437505419641109*^9}, {3.437505725212491*^9, 3.43750572701031*^9}, {
   3.437505809021784*^9, 3.437505811490819*^9}, {3.437506149862277*^9, 
   3.437506264269717*^9}, {3.437506379800364*^9, 3.437506447750174*^9}, {
   3.4377426629281607`*^9, 3.4377426676448298`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToggleSelection", "[", 
   RowBox[{"selection_", ",", " ", "x_List"}], "]"}], " ", ":=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{"Complement", "[", 
     RowBox[{"x", ",", "selection"}], "]"}], ",", 
    RowBox[{"Complement", "[", 
     RowBox[{"selection", ",", "x"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437501031299095*^9, 3.437501059168251*^9}, {
   3.437502393086014*^9, 3.437502425253414*^9}, {3.437502486972677*^9, 
   3.437502487562374*^9}, 3.437502623388308*^9, 3.437503597264954*^9, {
   3.437503846836093*^9, 3.437503905955579*^9}, {3.437505418591053*^9, 
   3.437505419641109*^9}, {3.437505725212491*^9, 3.43750572701031*^9}, {
   3.437505809021784*^9, 3.437505811490819*^9}, {3.437506149862277*^9, 
   3.437506264269717*^9}, {3.437506379800364*^9, 3.437506414437051*^9}, 
   3.437742556813877*^9, {3.437742669845852*^9, 3.437742685793872*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteSelection", "[", 
   RowBox[{"model_", ",", " ", "selection_"}], "]"}], ":=", 
  RowBox[{"Complement", "[", 
   RowBox[{"model", ",", 
    RowBox[{"model", "[", 
     RowBox[{"[", "selection", "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4375077641489763`*^9, 3.437507874648446*^9}, {
  3.4375079046681747`*^9, 3.437507950652317*^9}, {3.437742559374625*^9, 
  3.437742560814587*^9}, {3.437742761291194*^9, 3.437742775417392*^9}, {
  3.438620773640362*^9, 3.4386207784928837`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Hit Testing", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.437743552647397*^9, 3.43774355555504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Distance", "[", 
   RowBox[{"pt_", ",", 
    RowBox[{"Point", "[", "p_", "]"}]}], "]"}], ":=", 
  RowBox[{"Norm", "[", 
   RowBox[{"pt", "-", "p"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437504475034955*^9, 3.43750450239821*^9}, 
   3.437742784300452*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Distance", "[", 
   RowBox[{"pt_", ",", 
    RowBox[{"Circle", "[", 
     RowBox[{"c_", ",", "r_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"pt", "-", "c"}], "]"}], "-", "r"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437504475034955*^9, 3.43750450239821*^9}, 
   3.437742784300452*^9, {3.438539009852784*^9, 3.4385390428652363`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Distance", "[", 
   RowBox[{
    RowBox[{"p0", ":", 
     RowBox[{"{", 
      RowBox[{"x0_", ",", "y0_"}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"head", ":", 
       RowBox[{"(", 
        RowBox[{"Line", "|", "LineSegment", "|", "Ray"}], ")"}]}], ")"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"x2_", ",", "y2_"}], "}"}]}]}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lineLength", ",", "projectedLength", ",", "distance"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lineLength", " ", "=", " ", 
      RowBox[{"Norm", "[", 
       RowBox[{"p2", "-", "p1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"projectedLength", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p0", "-", "p2"}], ")"}], ".", 
       RowBox[{"Normalize", "[", 
        RowBox[{"p1", "-", "p2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"distance", " ", "=", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x1", "-", "x2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"y2", "-", "y0"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x2", "-", "x0"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"y1", "-", "y2"}], ")"}]}]}], "]"}], "/", "lineLength"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "head", ",", "\[IndentingNewLine]", "Line", ",", "\[IndentingNewLine]", 
       "\t", "distance", ",", "\[IndentingNewLine]", "LineSegment", ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"projectedLength", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"p0", "-", "p2"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         
         RowBox[{"projectedLength", "\[GreaterEqual]", "lineLength"}], ",", 
         RowBox[{"Norm", "[", 
          RowBox[{"p0", "-", "p1"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         "True", ",", "distance"}], "\[IndentingNewLine]", "\t", "]"}], ",", 
       "\[IndentingNewLine]", "Ray", ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"projectedLength", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"p0", "-", "p2"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
         "True", ",", "distance"}], "\[IndentingNewLine]", "\t", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437504475034955*^9, 3.43750450239821*^9}, 
   3.437742784300452*^9, {3.438539009852784*^9, 3.4385390687200203`*^9}, {
   3.438539358621131*^9, 3.438539367249992*^9}, {3.438539401828496*^9, 
   3.438539415569745*^9}, {3.4385395201245947`*^9, 3.4385398361904383`*^9}, {
   3.43853992219099*^9, 3.438539944398295*^9}, {3.4385399798422937`*^9, 
   3.438540113017658*^9}, 3.43854048216404*^9, {3.438540568597815*^9, 
   3.438540629946218*^9}, 3.438546673730146*^9, 3.438619297424663*^9, 
   3.438707641872541*^9, {3.4387077070081997`*^9, 3.4387077509481564`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetHit", "[", 
   RowBox[{"model_", ",", "pt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"distances", ",", "i", ",", 
      RowBox[{"hit", "=", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"minDist", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Scan", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dist", "=", 
            RowBox[{"Distance", "[", 
             RowBox[{"pt", ",", 
              RowBox[{"ObjectCache", "[", "#", "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"i", "++"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"ObjectCache", "[", "#", "]"}], "]"}], "===", 
               "Point"}], "&&", " ", 
              RowBox[{"dist", " ", "<", "minDist"}]}], ",", 
             RowBox[{
              RowBox[{"minDist", "=", "dist"}], ";", 
              RowBox[{"hit", "=", 
               RowBox[{"{", "i", "}"}]}]}]}], "]"}]}]}], "]"}], "&"}], ",", 
       " ", "model"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"hit", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Scan", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"dist", "=", 
               RowBox[{"Distance", "[", 
                RowBox[{"pt", ",", 
                 RowBox[{"ObjectCache", "[", "#", "]"}]}], "]"}]}], "}"}], 
             ",", 
             RowBox[{
              RowBox[{"i", "++"}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", 
                   RowBox[{"ObjectCache", "[", "#", "]"}], "]"}], "=!=", 
                  "Point"}], " ", "&&", " ", 
                 RowBox[{"dist", " ", "<", "minDist"}]}], ",", 
                RowBox[{
                 RowBox[{"minDist", "=", "dist"}], ";", 
                 RowBox[{"hit", "=", 
                  RowBox[{"{", "i", "}"}]}]}]}], "]"}]}]}], "]"}], "&"}], ",",
           " ", "model"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "hit"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.437504010305636*^9, 3.437504037564495*^9}, {
   3.437504091555749*^9, 3.437504254463181*^9}, {3.437504299564233*^9, 
   3.437504338552395*^9}, {3.4375044404971027`*^9, 3.4375044694471407`*^9}, {
   3.437504524862914*^9, 3.4375045289379873`*^9}, {3.4375045606512537`*^9, 
   3.437504592555376*^9}, {3.4375046306517897`*^9, 3.437504891306437*^9}, {
   3.437505005719603*^9, 3.437505013131145*^9}, {3.43750507726471*^9, 
   3.437505092457881*^9}, {3.4375051942788*^9, 3.4375051962904577`*^9}, {
   3.437505236804706*^9, 3.4375052730752907`*^9}, {3.43750532546034*^9, 
   3.437505357275324*^9}, {3.437507225646703*^9, 3.437507305101554*^9}, 
   3.4377425623361387`*^9, {3.437742810227942*^9, 3.437742813449511*^9}, {
   3.438542635434086*^9, 3.4385426444060373`*^9}, {3.438543942347558*^9, 
   3.438543986339662*^9}, {3.438544176671698*^9, 3.438544239102388*^9}, {
   3.438544337152508*^9, 3.4385443767202044`*^9}, {3.438544409285563*^9, 
   3.438544459914879*^9}, {3.4385445247736797`*^9, 3.4385445376838512`*^9}, {
   3.4386082103778954`*^9, 3.438608217880265*^9}, 3.438608260519602*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Rendering", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4377435709987288`*^9, 3.437743571907508*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderSelection", "[", 
   RowBox[{"model_", ",", " ", "selection_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "=", "3"}], ",", 
      RowBox[{"f", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Magenta", ",", 
      RowBox[{"AbsoluteThickness", "[", 
       RowBox[{"2", "d"}], "]"}], ",", 
      RowBox[{"Opacity", "[", ".5", "]"}], ",", 
      RowBox[{"AbsolutePointSize", "[", 
       RowBox[{"4", "d"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"First", " ", "/@", " ", 
         RowBox[{"model", "[", 
          RowBox[{"[", "selection", "]"}], "]"}]}], ")"}], "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"LineSegment", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p2", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p2", "-", "p1"}], ")"}]}]}], ",", 
             RowBox[{"p1", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p1", "-", "p2"}], ")"}]}]}]}], "}"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Ray", "[", 
           RowBox[{"{", 
            RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"p2", ",", 
             RowBox[{"p1", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p1", "-", "p2"}], ")"}]}]}]}], "}"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4375015442784147`*^9, 3.437501555753519*^9}, {
   3.437501674179842*^9, 3.437501735944624*^9}, {3.4375024340156527`*^9, 
   3.437502438767148*^9}, {3.437502731309273*^9, 3.437502737618965*^9}, {
   3.437502775648815*^9, 3.4375028062654057`*^9}, {3.437502999767145*^9, 
   3.437503052796487*^9}, {3.437503088538311*^9, 3.43750309642844*^9}, {
   3.437503210760455*^9, 3.437503239503664*^9}, {3.4375033198236847`*^9, 
   3.437503337725197*^9}, 3.437503597266593*^9, {3.437742563558565*^9, 
   3.4377425646821423`*^9}, {3.437742859798058*^9, 3.437742876515316*^9}, {
   3.437742918801999*^9, 3.437742933730291*^9}, {3.438540723783733*^9, 
   3.4385407308272676`*^9}, {3.4385408491678143`*^9, 3.438540849307715*^9}, {
   3.438540901276237*^9, 3.438540908773099*^9}, {3.438540941758527*^9, 
   3.438540974206924*^9}, {3.438541005713826*^9, 3.438541023932579*^9}, {
   3.438541138915421*^9, 3.438541232409707*^9}, {3.438541265187766*^9, 
   3.438541291374963*^9}, {3.438541355531155*^9, 3.43854143808849*^9}, {
   3.438541471345441*^9, 3.43854162745737*^9}, 3.4385421599381647`*^9, {
   3.4385423588899384`*^9, 3.438542392132148*^9}, {3.438542436484004*^9, 
   3.43854245368261*^9}, 3.438707889976948*^9, {3.4387721182406273`*^9, 
   3.438772147268852*^9}, {3.438772230436761*^9, 3.438772237696795*^9}, 
   3.438772529646627*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EmptyTrace", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", "Red", ",", 
      RowBox[{"Point", "[", 
       RowBox[{"{", "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LineColor", "[", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CircleColor", "[", "]"}], ",", 
      RowBox[{"{", "}"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.438777329691296*^9, 3.438777357063755*^9}, {
  3.438777420333824*^9, 3.4387774641590443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdateTrace", "[", 
   RowBox[{"model_", ",", " ", "tracedObjectIndices_", ",", "trace_"}], "]"}],
   ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "points", ",", " ", "lines", ",", "lineSegments", ",", "rays", ",", " ", 
      "circles", ",", "tracedObjects", ",", " ", "tracePoints", ",", 
      "traceLines", ",", "traceCircles"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"tracedObjects", " ", "=", " ", 
      RowBox[{"model", "[", 
       RowBox[{"[", "tracedObjectIndices", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"points", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"tracedObjects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "===", "Point"}], ")"}],
           "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"tracedObjects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "===", "Line"}], ")"}], 
          "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p1", "=", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"p2", "=", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p1", "+", 
             RowBox[{"100", 
              RowBox[{"(", 
               RowBox[{"p1", "-", "p2"}], ")"}]}]}], ",", 
            RowBox[{"p2", "+", 
             RowBox[{"100", 
              RowBox[{"(", 
               RowBox[{"p2", "-", "p1"}], ")"}]}]}]}], "}"}]}], "]"}], "&"}], 
       " ", "/@", " ", "lines"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lineSegments", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"tracedObjects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "===", "LineSegment"}], 
           ")"}], "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rays", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"tracedObjects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "===", "Ray"}], ")"}], 
          "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rays", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p1", "=", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"p2", "=", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p1", "+", 
             RowBox[{"100", 
              RowBox[{"(", 
               RowBox[{"p1", "-", "p2"}], ")"}]}]}], ",", "p2"}], "}"}]}], 
         "]"}], "&"}], " ", "/@", " ", "rays"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"circles", "=", 
      RowBox[{"First", " ", "/@", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"tracedObjects", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "===", "Circle"}], 
           ")"}], "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tracePoints", " ", "=", " ", 
      RowBox[{"trace", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"traceLines", "=", " ", 
      RowBox[{"trace", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"traceCircles", "=", " ", 
      RowBox[{"trace", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"trace", ",", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"Join", "[", 
           RowBox[{"tracePoints", ",", "points"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"Join", "[", 
           RowBox[{
           "traceLines", ",", "lines", ",", "lineSegments", ",", "rays"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"-", "1"}]}], "}"}], "\[Rule]", 
          RowBox[{"Join", "[", 
           RowBox[{"traceCircles", ",", "circles"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4387774737218227`*^9, 3.438777605554153*^9}, {
   3.438777737136505*^9, 3.438778048482333*^9}, {3.43877815498564*^9, 
   3.4387781560842743`*^9}, {3.4387782049771967`*^9, 3.4387782615478*^9}, {
   3.438778337644403*^9, 3.4387783407685347`*^9}, {3.4387783911972027`*^9, 
   3.4387783992716513`*^9}, {3.438778438033197*^9, 3.438778442371561*^9}, 
   3.438778483789212*^9, {3.438779371947755*^9, 3.438779439693397*^9}, {
   3.438779474380765*^9, 3.438779556595406*^9}, {3.438779612787764*^9, 
   3.438779616550653*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RenderHighlight", "[", 
   RowBox[{"model_", ",", "selection_"}], "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "=", "3"}], ",", 
      RowBox[{"f", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"AbsoluteThickness", "[", "d", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"First", " ", "/@", " ", 
         RowBox[{"model", "[", 
          RowBox[{"[", "selection", "]"}], "]"}]}], ")"}], "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Point", "[", "p_", "]"}], "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{"Circle", "[", 
            RowBox[{"p", ",", 
             RowBox[{"Offset", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d", "+", "2.5"}], ")"}], 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LineSegment", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", "x", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p2", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p2", "-", "p1"}], ")"}]}]}], ",", 
             RowBox[{"p1", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p1", "-", "p2"}], ")"}]}]}]}], "}"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Ray", "[", 
           RowBox[{"{", 
            RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"p2", ",", 
             RowBox[{"p1", "+", 
              RowBox[{"f", 
               RowBox[{"(", 
                RowBox[{"p1", "-", "p2"}], ")"}]}]}]}], "}"}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4375015442784147`*^9, 3.437501555753519*^9}, {
   3.437501674179842*^9, 3.437501735944624*^9}, {3.4375024340156527`*^9, 
   3.437502438767148*^9}, {3.437502731309273*^9, 3.437502737618965*^9}, {
   3.437502775648815*^9, 3.4375028062654057`*^9}, {3.437502999767145*^9, 
   3.437503052796487*^9}, {3.437503088538311*^9, 3.43750309642844*^9}, {
   3.437503210760455*^9, 3.437503239503664*^9}, {3.4375033198236847`*^9, 
   3.437503337725197*^9}, 3.437503597266593*^9, {3.437742563558565*^9, 
   3.4377425646821423`*^9}, {3.437742859798058*^9, 3.437742876515316*^9}, {
   3.437742918801999*^9, 3.437742933730291*^9}, {3.438540723783733*^9, 
   3.4385407308272676`*^9}, {3.4385408491678143`*^9, 3.438540849307715*^9}, {
   3.438540901276237*^9, 3.438540908773099*^9}, {3.438540941758527*^9, 
   3.438540974206924*^9}, {3.438541005713826*^9, 3.438541023932579*^9}, {
   3.438541138915421*^9, 3.438541232409707*^9}, {3.438541265187766*^9, 
   3.438541291374963*^9}, {3.438541355531155*^9, 3.43854143808849*^9}, {
   3.438541471345441*^9, 3.43854162745737*^9}, 3.4385421599381647`*^9, {
   3.4385423588899384`*^9, 3.438542392132148*^9}, {3.438542436484004*^9, 
   3.43854245368261*^9}, {3.438707804149481*^9, 3.438707834369779*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["RunModel", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.437743596661104*^9, 3.437743603764023*^9}, 
   3.43860504980466*^9, {3.438609899358684*^9, 3.4386098995997972`*^9}, {
   3.438610080754939*^9, 3.4386100818558493`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "RunModel", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4385388963781548`*^9, 3.438538898398457*^9}, {
   3.438542743139359*^9, 3.438542744372753*^9}, 3.438609906526318*^9, 
   3.4386100838304243`*^9, {3.438610150516974*^9, 3.43861015208854*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RunModel", "[", "fileName_String", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"RunModel", "[", 
   RowBox[{"ImportModel", "[", 
    RowBox[{"fileName", ",", 
     RowBox[{"IncludeSize", "\[Rule]", "True"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.43861010625784*^9, 3.438610135554914*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RunModel", "[", "inputModel_List", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"RunModel", "[", 
   RowBox[{"{", 
    RowBox[{"inputModel", ",", " ", 
     RowBox[{"400", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}]}], "}"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438607970066473*^9, 3.4386079868137197`*^9}, {
  3.4386080255192003`*^9, 3.438608061951085*^9}, {3.438609764278529*^9, 
  3.4386097648971577`*^9}, {3.438609907149726*^9, 3.438609907789493*^9}, {
  3.438610084503449*^9, 3.438610084950871*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RunModel", "[", 
    RowBox[{"{", 
     RowBox[{"inputModel_List", ",", 
      RowBox[{"{", 
       RowBox[{"width_Integer", ",", "height_Integer"}], "}"}]}], "}"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"selection", "=", 
        RowBox[{"EmptySelection", "[", "]"}]}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"the", " ", 
         RowBox[{"selection", " ", "--"}], " ", "a", " ", "list", " ", "of", 
         " ", "object", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"mouseDownHit", "=", 
        RowBox[{"EmptySelection", "[", "]"}]}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "the", " ", "object", " ", "hit", " ", "by", " ", "a", " ", 
          "mouse"}], "-", "down"}], " ", "*)"}], "\[IndentingNewLine]", 
       "mouseDownPosition", ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "the", " ", "position", " ", "of", " ", "the", " ", "last", " ", 
          "mouse"}], "-", "down"}], " ", "*)"}], "\[IndentingNewLine]", 
       "mousePosition", ",", 
       RowBox[{"(*", " ", 
        RowBox[{"the", " ", "current", " ", "mouse", " ", "position"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"initialModel", " ", "=", " ", "inputModel"}], ",", 
       "\[IndentingNewLine]", "mouseDownModel", ",", "\[IndentingNewLine]", 
       RowBox[{"model", "=", "inputModel"}], ",", "\[IndentingNewLine]", 
       "mouseDownOnSelection", ",", "\[IndentingNewLine]", 
       "mouseDownShiftKey", ",", "\[IndentingNewLine]", "mouseDidDrag", ",", 
       "\[IndentingNewLine]", "firstDrag", ",", "\[IndentingNewLine]", 
       RowBox[{"displayTransform", "=", 
        RowBox[{"Composition", "[", 
         RowBox[{
          RowBox[{"TranslationTransform", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "height"}], "}"}], "]"}], ",", 
          RowBox[{"ScalingTransform", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"hitTransform", " ", "=", " ", 
        RowBox[{"Composition", "[", 
         RowBox[{
          RowBox[{"ScalingTransform", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
          RowBox[{"TranslationTransform", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "height"}]}], "}"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dragTransform", " ", "=", " ", 
        RowBox[{"ScalingTransform", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"tracedObjects", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"trace", "=", 
        RowBox[{"EmptyTrace", "[", "]"}]}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Column", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Trace\>\"", ",", 
                  RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"tracedObjects", "=", "selection"}], ")"}], "&"}], 
                ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"33", ",", "33"}], "}"}]}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Erase\\nTrace\>\"", ",", 
                  RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"trace", "=", 
                   RowBox[{"EmptyTrace", "[", "]"}]}], ")"}], "&"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"33", ",", "33"}], "}"}]}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], "]"}],
               ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Reset\>\"", ",", 
                  RowBox[{"FontSize", "\[Rule]", "8"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"model", "=", "initialModel"}], ";", 
                   RowBox[{"selection", "=", 
                    RowBox[{"EmptySelection", "[", "]"}]}]}], ")"}], "&"}], 
                ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"33", ",", "33"}], "}"}]}], ",", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}]}], 
               "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\"\<Center\>\"", 
            ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Framed", "[", 
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"GeometricTransformation", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"RenderModel", "[", "model", "]"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Dynamic", "[", 
                    RowBox[{"RenderSelection", "[", 
                    RowBox[{"model", ",", "selection"}], "]"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Dynamic", "[", "trace", "]"}]}], 
                  "\[IndentingNewLine]", "}"}], ",", "displayTransform"}], 
                "]"}], ",", " ", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "width"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "height"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"width", ",", "height"}], "}"}]}]}], "]"}], "]"}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<MouseDown\>\"", "\[RuleDelayed]", "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"mousePosition", " ", "=", " ", 
                RowBox[{"mouseDownPosition", "=", 
                 RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"mouseDownModel", "=", "model"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"mouseDownHit", "=", 
                RowBox[{"GetHit", "[", 
                 RowBox[{"model", ",", 
                  RowBox[{"hitTransform", "[", "mouseDownPosition", "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"mouseDownOnSelection", "=", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Intersection", "[", 
                   RowBox[{"selection", ",", "mouseDownHit"}], "]"}], "=!=", 
                  RowBox[{"{", "}"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"selection", " ", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"mouseDownHit", "===", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{"EmptySelection", "[", "]"}], " ", ",", 
                  RowBox[{"Union", "[", 
                   RowBox[{"selection", ",", "mouseDownHit"}], "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"firstDrag", "=", "True"}], ";", "\[IndentingNewLine]", 
               RowBox[{"mouseDidDrag", "=", "False"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"mouseDownShiftKey", "=", 
                RowBox[{"CurrentValue", "[", "\"\<ShiftKey\>\"", "]"}]}], 
               ";"}], "\[IndentingNewLine]", ")"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"\"\<MouseUp\>\"", "\[RuleDelayed]", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"!", "mouseDidDrag"}], " ", "&&", " ", 
                 "mouseDownOnSelection"}], ",", "\[IndentingNewLine]", 
                RowBox[{"selection", "=", 
                 RowBox[{"ToggleSelection", "[", 
                  RowBox[{"selection", ",", "mouseDownHit"}], "]"}]}]}], 
               "]"}], "\[IndentingNewLine]", ")"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"\"\<MouseDragged\>\"", "\[RuleDelayed]", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"!", "mouseDownOnSelection"}], " ", "&&", " ", 
                  RowBox[{"!", "mouseDownShiftKey"}]}], ",", 
                 RowBox[{"selection", "=", "mouseDownHit"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"mouseDidDrag", "=", "True"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"firstDrag", "=", "False"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"newPosition", "=", 
                   RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"model", " ", "=", " ", 
                   RowBox[{"Drag", "[", 
                    RowBox[{"mouseDownModel", ",", "selection", ",", " ", 
                    RowBox[{"TranslationTransform", "[", 
                    RowBox[{"dragTransform", "[", 
                    RowBox[{"mousePosition", "-", "mouseDownPosition"}], 
                    "]"}], "]"}]}], "]"}]}], ";", 
                  RowBox[{"mousePosition", "=", "newPosition"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"trace", "=", 
                RowBox[{"UpdateTrace", "[", 
                 RowBox[{"model", ",", " ", "tracedObjects", ",", "trace"}], 
                 "]"}]}]}], "\[IndentingNewLine]", ")"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "}"}], "}"}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Top"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4375002663012*^9, 3.4375003812408247`*^9}, {
   3.437500425049573*^9, 3.4375004379709377`*^9}, {3.437500499117703*^9, 
   3.4375005412443542`*^9}, {3.437500633485072*^9, 3.437500684310215*^9}, {
   3.4375008157972507`*^9, 3.437500890994378*^9}, {3.437500935854273*^9, 
   3.437500944198483*^9}, {3.437501068468761*^9, 3.4375011289941473`*^9}, {
   3.43750120300484*^9, 3.437501265658649*^9}, {3.437501305615797*^9, 
   3.437501314372808*^9}, {3.437501346531198*^9, 3.437501351256783*^9}, {
   3.4375014018433857`*^9, 3.437501430843755*^9}, {3.4375014964144783`*^9, 
   3.4375015405653963`*^9}, {3.43750158468701*^9, 3.437501586811016*^9}, {
   3.437501622611259*^9, 3.437501633323935*^9}, {3.437501773859486*^9, 
   3.437501821278665*^9}, {3.437503505648514*^9, 3.437503533304042*^9}, 
   3.43750359726862*^9, {3.437503709281452*^9, 3.437503775818654*^9}, 
   3.437503856451627*^9, {3.437503958814726*^9, 3.437503993272477*^9}, {
   3.437505663366808*^9, 3.437505692817478*^9}, 3.437506664931131*^9, {
   3.437506742281349*^9, 3.4375067589860563`*^9}, {3.437506834432221*^9, 
   3.437506967515657*^9}, {3.437507626342515*^9, 3.437507649812776*^9}, {
   3.437507692785985*^9, 3.4375077103396072`*^9}, {3.437507995665222*^9, 
   3.437507999426758*^9}, {3.437508035210587*^9, 3.4375080431329*^9}, {
   3.437508181457697*^9, 3.437508279159712*^9}, {3.437508355149135*^9, 
   3.437508394687948*^9}, {3.4375084285269327`*^9, 3.4375084853112373`*^9}, {
   3.437508620997967*^9, 3.4375086288354588`*^9}, {3.437508680510249*^9, 
   3.437508705037176*^9}, {3.437508769193334*^9, 3.437508813575808*^9}, {
   3.437508939073612*^9, 3.437508972508745*^9}, {3.437509010899393*^9, 
   3.43750921576213*^9}, {3.437509636363247*^9, 3.4375096471531343`*^9}, 
   3.437510172413702*^9, {3.4377416110776587`*^9, 3.437741648034952*^9}, {
   3.437741707755509*^9, 3.437741715548791*^9}, 3.4377420539184093`*^9, {
   3.4377427280710783`*^9, 3.4377427329879017`*^9}, {3.437743181474278*^9, 
   3.437743187776949*^9}, 3.437743503414969*^9, {3.437744976183159*^9, 
   3.437745041141139*^9}, {3.4377450792492113`*^9, 3.437745112047806*^9}, {
   3.4377451785864897`*^9, 3.437745179608369*^9}, {3.437745232113224*^9, 
   3.4377452605108757`*^9}, {3.4377452939135847`*^9, 
   3.4377453506472187`*^9}, {3.43774541732605*^9, 3.437745427804431*^9}, {
   3.437745498779994*^9, 3.4377455001469307`*^9}, {3.437745546442607*^9, 
   3.437745586805105*^9}, {3.437745619650354*^9, 3.4377456709993753`*^9}, {
   3.437745702705138*^9, 3.437745781476171*^9}, {3.437745881972415*^9, 
   3.4377458986495247`*^9}, {3.437745934183773*^9, 3.4377459349286823`*^9}, {
   3.43774599687715*^9, 3.4377460563661623`*^9}, {3.4377460963196287`*^9, 
   3.437746148865623*^9}, {3.437746183299708*^9, 3.437746212059169*^9}, {
   3.437746253757443*^9, 3.437746255421741*^9}, {3.4377463098093147`*^9, 
   3.4377463531510487`*^9}, {3.437746601364925*^9, 3.437746628433075*^9}, {
   3.4377466592727547`*^9, 3.43774667437673*^9}, {3.43774671196769*^9, 
   3.437746777959824*^9}, {3.437746809231202*^9, 3.4377468129739847`*^9}, {
   3.437753841447445*^9, 3.437753855162889*^9}, {3.437753959147608*^9, 
   3.437754192065774*^9}, {3.437754228691472*^9, 3.437754229369687*^9}, {
   3.4377544067583838`*^9, 3.4377545206856833`*^9}, {3.437755172356642*^9, 
   3.437755192190811*^9}, {3.438003521206401*^9, 3.438003528973238*^9}, {
   3.438003571069901*^9, 3.438003573100868*^9}, 3.438449445972126*^9, {
   3.43844997783937*^9, 3.43844998029587*^9}, {3.4385383830704527`*^9, 
   3.438538385569304*^9}, {3.4385384279804087`*^9, 3.438538433866744*^9}, {
   3.438538746704299*^9, 3.4385387617995367`*^9}, {3.438538837168745*^9, 
   3.438538917699238*^9}, {3.438542531119381*^9, 3.438542569639758*^9}, {
   3.438542749769402*^9, 3.438542751423173*^9}, {3.438542791636469*^9, 
   3.438542832406077*^9}, 3.438542870493827*^9, {3.4385429644169407`*^9, 
   3.4385429827945337`*^9}, {3.438543313866194*^9, 3.43854334288907*^9}, {
   3.438543560832305*^9, 3.4385435923400517`*^9}, 3.4385447166812162`*^9, {
   3.438544780349284*^9, 3.438544804041019*^9}, {3.438545895772765*^9, 
   3.438545896921274*^9}, {3.438607960516882*^9, 3.438607967147827*^9}, {
   3.4386080082672*^9, 3.438608021239819*^9}, {3.438608075111355*^9, 
   3.4386080876400757`*^9}, {3.438609766966124*^9, 3.438609767459737*^9}, 
   3.4386099085763493`*^9, 3.4386100854816713`*^9, {3.4386102229857693`*^9, 
   3.43861022744655*^9}, {3.4386109287044373`*^9, 3.4386109466654587`*^9}, {
   3.438619828016892*^9, 3.438619855612352*^9}, 3.438619908811245*^9, {
   3.438619999602721*^9, 3.438620119756544*^9}, {3.438620156549519*^9, 
   3.438620165784525*^9}, {3.438620379521585*^9, 3.438620410799474*^9}, {
   3.438620493743964*^9, 3.438620512975369*^9}, {3.438620564561726*^9, 
   3.43862057262337*^9}, 3.438620616475009*^9, {3.4386206601120253`*^9, 
   3.438620741187066*^9}, {3.438620802321494*^9, 3.4386208163035927`*^9}, 
   3.438620870446885*^9, {3.4386209283402567`*^9, 3.4386209298945312`*^9}, {
   3.438620985171672*^9, 3.438621012571272*^9}, {3.438621143892762*^9, 
   3.438621145011228*^9}, {3.438621272093696*^9, 3.438621305430963*^9}, 
   3.438621933810597*^9, {3.4386909142888317`*^9, 3.438690993683264*^9}, {
   3.438691288751878*^9, 3.438691299793895*^9}, {3.4386913748405657`*^9, 
   3.438691420312419*^9}, {3.438691472104802*^9, 3.4386915341903353`*^9}, {
   3.4387714321136293`*^9, 3.4387714452488947`*^9}, {3.4387715295818243`*^9, 
   3.438771549675949*^9}, {3.4387715905688334`*^9, 3.438771604607419*^9}, {
   3.438771646179389*^9, 3.4387716467030573`*^9}, {3.438771684913192*^9, 
   3.438771747309639*^9}, {3.438771791428928*^9, 3.438771819823378*^9}, {
   3.4387719095620527`*^9, 3.438771924907256*^9}, {3.438772183027549*^9, 
   3.4387721922791224`*^9}, {3.438772305206767*^9, 3.43877230634093*^9}, {
   3.4387724971204557`*^9, 3.4387724983251743`*^9}, 3.438772684574505*^9, 
   3.438773102705072*^9, {3.438775691688053*^9, 3.4387757942643023`*^9}, {
   3.43877584025244*^9, 3.438775843578343*^9}, {3.438775881684351*^9, 
   3.43877588807141*^9}, {3.438775924679216*^9, 3.4387759942976093`*^9}, {
   3.43877606811917*^9, 3.438776095153096*^9}, {3.438776351084992*^9, 
   3.43877635289363*^9}, {3.438776872159309*^9, 3.438776878693594*^9}, 
   3.43877691166973*^9, {3.438777102532218*^9, 3.438777103615714*^9}, {
   3.438777260226563*^9, 3.438777313387286*^9}, {3.4387775024423723`*^9, 
   3.438777503728923*^9}, {3.438779783708444*^9, 3.4387797972982492`*^9}}]
}, Closed]]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{981, 847},
WindowMargins->{{Automatic, 302}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait"},
ShowSelection->True,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 284, 4, 76, "Title"],
Cell[854, 28, 120, 1, 26, "Subsubtitle"],
Cell[977, 31, 729, 16, 86, "Text"],
Cell[CellGroupData[{
Cell[1731, 51, 122, 2, 67, "Section"],
Cell[CellGroupData[{
Cell[1878, 57, 147, 2, 34, "Subsection"],
Cell[2028, 61, 270, 5, 41, "Text"],
Cell[2301, 68, 307, 6, 41, "Text"],
Cell[2611, 76, 341, 6, 41, "Text"],
Cell[2955, 84, 146, 2, 26, "Text"],
Cell[3104, 88, 302, 6, 41, "Text"],
Cell[3409, 96, 215, 5, 26, "Text"],
Cell[3627, 103, 288, 6, 41, "Text"],
Cell[3918, 111, 233, 5, 26, "Text"],
Cell[4154, 118, 240, 5, 26, "Text"],
Cell[4397, 125, 345, 6, 41, "Text"],
Cell[4745, 133, 328, 8, 41, "Text"],
Cell[5076, 143, 262, 5, 41, "Text"],
Cell[5341, 150, 728, 13, 86, "Text"],
Cell[6072, 165, 261, 5, 26, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6370, 175, 127, 2, 34, "Subsection"],
Cell[6500, 179, 226, 5, 26, "Text"],
Cell[6729, 186, 321, 6, 41, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[7087, 197, 150, 2, 26, "Subsection"],
Cell[7240, 201, 373, 7, 41, "Text"],
Cell[7616, 210, 218, 5, 26, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[7871, 220, 103, 1, 26, "Subsection"],
Cell[7977, 223, 2803, 65, 329, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[10817, 293, 110, 1, 26, "Subsection"],
Cell[10930, 296, 129, 1, 26, "Text"],
Cell[11062, 299, 442, 10, 26, "Text"],
Cell[11507, 311, 104, 1, 26, "Text"],
Cell[11614, 314, 526, 9, 26, "Text"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[12189, 329, 90, 1, 37, "Section"],
Cell[CellGroupData[{
Cell[12304, 334, 93, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[12422, 339, 106, 1, 24, "Subsubsection"],
Cell[12531, 342, 259, 5, 26, "Text"],
Cell[12793, 349, 185, 4, 26, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13015, 358, 106, 1, 24, "Subsubsection"],
Cell[13124, 361, 109, 1, 26, "Text"],
Cell[13236, 364, 121, 1, 26, "Text"],
Cell[13360, 367, 274, 4, 26, "Text"],
Cell[13637, 373, 622, 10, 26, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14296, 388, 103, 1, 24, "Subsubsection"],
Cell[14402, 391, 114, 1, 26, "Text"],
Cell[14519, 394, 129, 1, 26, "Text"],
Cell[14651, 397, 142, 1, 26, "Text"],
Cell[14796, 400, 192, 4, 26, "Text"],
Cell[14991, 406, 235, 3, 26, "Text"],
Cell[15229, 411, 565, 7, 26, "Text"],
Cell[15797, 420, 271, 3, 26, "Text"]
}, Open  ]],
Cell[16083, 426, 104, 1, 24, "Subsubsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16224, 432, 93, 1, 34, "Subsection"],
Cell[16320, 435, 165, 2, 26, "Text"],
Cell[16488, 439, 128, 2, 26, "Text"],
Cell[16619, 443, 565, 9, 41, "Text"],
Cell[17187, 454, 370, 7, 41, "Text"],
Cell[17560, 463, 176, 2, 26, "Text"],
Cell[17739, 467, 146, 2, 26, "Text"],
Cell[17888, 471, 147, 2, 26, "Text"],
Cell[18038, 475, 182, 4, 26, "Text"],
Cell[18223, 481, 157, 2, 26, "Text"],
Cell[18383, 485, 180, 2, 26, "Text"],
Cell[18566, 489, 184, 2, 26, "Text"],
Cell[18753, 493, 553, 7, 26, "Text"],
Cell[19309, 502, 546, 7, 26, "Text"],
Cell[19858, 511, 549, 7, 26, "Text"],
Cell[20410, 520, 214, 5, 26, "Text"],
Cell[20627, 527, 248, 5, 26, "Text"],
Cell[20878, 534, 258, 3, 26, "Text"],
Cell[21139, 539, 232, 3, 26, "Text"],
Cell[21374, 544, 251, 3, 26, "Text"],
Cell[21628, 549, 521, 8, 26, "Text"],
Cell[22152, 559, 523, 7, 26, "Text"],
Cell[22678, 568, 517, 7, 26, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[23244, 581, 95, 1, 37, "Section"],
Cell[CellGroupData[{
Cell[23364, 586, 102, 1, 34, "Subsection"],
Cell[23469, 589, 232, 5, 26, "Text"],
Cell[CellGroupData[{
Cell[23726, 598, 399, 8, 27, "Input"],
Cell[24128, 608, 3177, 100, 213, "Output"]
}, Closed]],
Cell[27320, 711, 253, 7, 27, "Input"],
Cell[27576, 720, 284, 5, 26, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[27897, 730, 212, 3, 26, "Subsection"],
Cell[28112, 735, 136, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[28273, 740, 5834, 155, 223, "Input"],
Cell[34110, 897, 4714, 116, 321, "Output"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[38873, 1019, 263, 4, 26, "Subsection"],
Cell[39139, 1025, 332, 6, 26, "Text"],
Cell[CellGroupData[{
Cell[39496, 1035, 10069, 269, 460, "Input"],
Cell[49568, 1306, 4876, 120, 417, "Output"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[54493, 1432, 160, 3, 26, "Subsection"],
Cell[54656, 1437, 276, 5, 26, "Text"],
Cell[CellGroupData[{
Cell[54957, 1446, 6675, 178, 361, "Input"],
Cell[61635, 1626, 4862, 120, 365, "Output"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[66546, 1752, 103, 1, 26, "Subsection"],
Cell[66652, 1755, 378, 7, 41, "Text"],
Cell[CellGroupData[{
Cell[67055, 1766, 3945, 109, 163, "Input"],
Cell[71003, 1877, 4874, 120, 567, "Output"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[75926, 2003, 155, 2, 26, "Subsection"],
Cell[76084, 2007, 395, 7, 41, "Text"],
Cell[CellGroupData[{
Cell[76504, 2018, 4826, 132, 267, "Input"],
Cell[81333, 2152, 4787, 118, 637, "Output"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[86169, 2276, 100, 1, 26, "Subsection"],
Cell[86272, 2279, 449, 7, 41, "Text"],
Cell[CellGroupData[{
Cell[86746, 2290, 9202, 252, 373, "Input"],
Cell[95951, 2544, 4869, 119, 453, "Output"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[100869, 2669, 104, 1, 26, "Subsection"],
Cell[CellGroupData[{
Cell[100998, 2674, 3127, 86, 181, "Input"],
Cell[104128, 2762, 4888, 120, 411, "Output"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109077, 2889, 320, 5, 67, "Section",
 InitializationCell->True],
Cell[109400, 2896, 442, 8, 41, "Text",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[109867, 2908, 131, 2, 34, "Subsection",
 InitializationCell->True],
Cell[110001, 2912, 321, 8, 27, "Input",
 InitializationCell->True],
Cell[110325, 2922, 313, 8, 27, "Input",
 InitializationCell->True],
Cell[110641, 2932, 348, 9, 27, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[111026, 2946, 132, 2, 26, "Subsection",
 InitializationCell->True],
Cell[111161, 2950, 748, 20, 58, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[111946, 2975, 154, 2, 26, "Subsection",
 InitializationCell->True],
Cell[112103, 2979, 293, 7, 27, "Input",
 InitializationCell->True],
Cell[112399, 2988, 251, 6, 27, "Input",
 InitializationCell->True],
Cell[112653, 2996, 302, 7, 27, "Input",
 InitializationCell->True],
Cell[112958, 3005, 296, 7, 27, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[113291, 3017, 177, 3, 26, "Subsection",
 InitializationCell->True],
Cell[113471, 3022, 168, 3, 27, "Input",
 InitializationCell->True],
Cell[113642, 3027, 2460, 60, 178, "Input",
 InitializationCell->True],
Cell[116105, 3089, 344, 9, 27, "Input",
 InitializationCell->True],
Cell[116452, 3100, 341, 9, 27, "Input",
 InitializationCell->True],
Cell[116796, 3111, 165, 3, 27, "Input",
 InitializationCell->True],
Cell[116964, 3116, 1812, 47, 73, "Input",
 InitializationCell->True],
Cell[118779, 3165, 1323, 33, 58, "Input",
 InitializationCell->True],
Cell[120105, 3200, 1078, 31, 43, "Input",
 InitializationCell->True],
Cell[121186, 3233, 983, 28, 43, "Input",
 InitializationCell->True],
Cell[122172, 3263, 774, 20, 27, "Input",
 InitializationCell->True],
Cell[122949, 3285, 713, 15, 27, "Input",
 InitializationCell->True],
Cell[123665, 3302, 653, 15, 27, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[124355, 3322, 160, 3, 26, "Subsection",
 InitializationCell->True],
Cell[124518, 3327, 412, 9, 43, "Input",
 InitializationCell->True],
Cell[124933, 3338, 2805, 63, 148, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[127775, 3406, 203, 3, 26, "Subsection",
 InitializationCell->True],
Cell[127981, 3411, 350, 8, 27, "Input",
 InitializationCell->True],
Cell[128334, 3421, 1705, 35, 88, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[130076, 3461, 107, 2, 26, "Subsection",
 InitializationCell->True],
Cell[130186, 3465, 766, 22, 73, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[130989, 3492, 130, 2, 26, "Subsection",
 InitializationCell->True],
Cell[131122, 3496, 457, 12, 43, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[131616, 3513, 177, 3, 26, "Subsection",
 InitializationCell->True],
Cell[131796, 3518, 420, 9, 43, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[132253, 3532, 130, 2, 26, "Subsection",
 InitializationCell->True],
Cell[132386, 3536, 749, 16, 27, "Input",
 InitializationCell->True],
Cell[133138, 3554, 858, 19, 27, "Input",
 InitializationCell->True],
Cell[133999, 3575, 223, 5, 27, "Input",
 InitializationCell->True],
Cell[134225, 3582, 1290, 25, 27, "Input",
 InitializationCell->True],
Cell[135518, 3609, 612, 14, 27, "Input",
 InitializationCell->True],
Cell[136133, 3625, 625, 14, 27, "Input",
 InitializationCell->True],
Cell[136761, 3641, 608, 14, 27, "Input",
 InitializationCell->True],
Cell[137372, 3657, 180, 4, 27, "Input",
 InitializationCell->True],
Cell[137555, 3663, 721, 16, 27, "Input",
 InitializationCell->True],
Cell[138279, 3681, 750, 16, 27, "Input",
 InitializationCell->True],
Cell[139032, 3699, 180, 4, 27, "Input",
 InitializationCell->True],
Cell[139215, 3705, 1528, 38, 74, "Input",
 InitializationCell->True],
Cell[140746, 3745, 267, 6, 27, "Input",
 InitializationCell->True],
Cell[141016, 3753, 1714, 37, 44, "Input",
 InitializationCell->True],
Cell[142733, 3792, 273, 6, 27, "Input",
 InitializationCell->True],
Cell[143009, 3800, 1055, 28, 43, "Input",
 InitializationCell->True],
Cell[144067, 3830, 975, 25, 43, "Input",
 InitializationCell->True],
Cell[145045, 3857, 1084, 27, 43, "Input",
 InitializationCell->True],
Cell[146132, 3886, 6551, 170, 268, "Input",
 InitializationCell->True],
Cell[152686, 4058, 8956, 211, 437, "Input",
 InitializationCell->True],
Cell[161645, 4271, 8910, 210, 437, "Input",
 InitializationCell->True],
Cell[170558, 4483, 679, 21, 44, "Input",
 InitializationCell->True],
Cell[171240, 4506, 503, 14, 43, "Input",
 InitializationCell->True],
Cell[171746, 4522, 440, 12, 43, "Input",
 InitializationCell->True],
Cell[172189, 4536, 913, 23, 44, "Input",
 InitializationCell->True],
Cell[173105, 4561, 751, 19, 43, "Input",
 InitializationCell->True],
Cell[173859, 4582, 689, 17, 43, "Input",
 InitializationCell->True],
Cell[174551, 4601, 340, 7, 27, "Input",
 InitializationCell->True],
Cell[174894, 4610, 753, 16, 27, "Input",
 InitializationCell->True],
Cell[175650, 4628, 1093, 26, 44, "Input",
 InitializationCell->True],
Cell[176746, 4656, 957, 23, 43, "Input",
 InitializationCell->True],
Cell[177706, 4681, 818, 20, 43, "Input",
 InitializationCell->True],
Cell[178527, 4703, 361, 7, 27, "Input",
 InitializationCell->True],
Cell[178891, 4712, 1571, 39, 60, "Input",
 InitializationCell->True],
Cell[180465, 4753, 1417, 35, 44, "Input",
 InitializationCell->True],
Cell[181885, 4790, 1238, 31, 44, "Input",
 InitializationCell->True],
Cell[183126, 4823, 236, 5, 27, "Input",
 InitializationCell->True],
Cell[183365, 4830, 415, 8, 27, "Input",
 InitializationCell->True],
Cell[183783, 4840, 207, 5, 27, "Input",
 InitializationCell->True],
Cell[183993, 4847, 280, 6, 27, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[184310, 4858, 121, 2, 26, "Subsection",
 InitializationCell->True],
Cell[184434, 4862, 327, 5, 26, "Text",
 InitializationCell->True],
Cell[184764, 4869, 1854, 36, 88, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[186655, 4910, 128, 2, 26, "Subsection",
 InitializationCell->True],
Cell[186786, 4914, 289, 6, 41, "Text",
 InitializationCell->True],
Cell[187078, 4922, 8096, 158, 583, "Input",
 InitializationCell->True],
Cell[195177, 5082, 1810, 46, 118, "Input",
 InitializationCell->True],
Cell[196990, 5130, 1182, 30, 73, "Input",
 InitializationCell->True],
Cell[198175, 5162, 3007, 72, 210, "Input",
 InitializationCell->True],
Cell[201185, 5236, 1108, 27, 73, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[202330, 5268, 126, 2, 26, "Subsection",
 InitializationCell->True],
Cell[202459, 5272, 399, 7, 41, "Text",
 InitializationCell->True],
Cell[202861, 5281, 777, 18, 43, "Input",
 InitializationCell->True],
Cell[203641, 5301, 4476, 97, 313, "Input",
 InitializationCell->True],
Cell[208120, 5400, 225, 5, 26, "Text",
 InitializationCell->True],
Cell[208348, 5407, 948, 24, 88, "Input",
 InitializationCell->True],
Cell[209299, 5433, 960, 26, 58, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[210296, 5464, 179, 3, 26, "Subsection",
 InitializationCell->True],
Cell[210478, 5469, 591, 12, 27, "Input",
 InitializationCell->True],
Cell[211072, 5483, 923, 20, 43, "Input",
 InitializationCell->True],
Cell[211998, 5505, 867, 21, 44, "Input",
 InitializationCell->True],
Cell[212868, 5528, 457, 12, 43, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[213362, 5545, 155, 3, 26, "Subsection",
 InitializationCell->True],
Cell[213520, 5550, 781, 21, 73, "Input",
 InitializationCell->True],
Cell[214304, 5573, 9363, 205, 583, "Input",
 InitializationCell->True],
Cell[223670, 5780, 3122, 74, 283, "Input",
 InitializationCell->True],
Cell[226795, 5856, 6771, 139, 523, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[233603, 6000, 120, 2, 26, "Subsection",
 InitializationCell->True],
Cell[233726, 6004, 6977, 159, 67, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[240740, 6168, 124, 2, 26, "Subsection",
 InitializationCell->True],
Cell[240867, 6172, 338, 8, 27, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[241242, 6185, 126, 2, 26, "Subsection",
 InitializationCell->True],
Cell[241371, 6189, 217, 6, 27, "Input",
 InitializationCell->True],
Cell[241591, 6197, 797, 15, 27, "Input",
 InitializationCell->True],
Cell[242391, 6214, 829, 15, 27, "Input",
 InitializationCell->True],
Cell[243223, 6231, 947, 18, 43, "Input",
 InitializationCell->True],
Cell[244173, 6251, 560, 12, 27, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[244770, 6268, 125, 2, 26, "Subsection",
 InitializationCell->True],
Cell[244898, 6272, 320, 9, 27, "Input",
 InitializationCell->True],
Cell[245221, 6283, 454, 12, 27, "Input",
 InitializationCell->True],
Cell[245678, 6297, 3540, 83, 344, "Input",
 InitializationCell->True],
Cell[249221, 6382, 3805, 87, 223, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[253063, 6474, 126, 2, 26, "Subsection",
 InitializationCell->True],
Cell[253192, 6478, 3476, 76, 163, "Input",
 InitializationCell->True],
Cell[256671, 6556, 824, 22, 103, "Input",
 InitializationCell->True],
Cell[257498, 6580, 6650, 176, 343, "Input",
 InitializationCell->True],
Cell[264151, 6758, 3676, 83, 178, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[267864, 6846, 248, 4, 26, "Subsection",
 InitializationCell->True],
Cell[268115, 6852, 308, 5, 27, "Input",
 InitializationCell->True],
Cell[268426, 6859, 368, 9, 43, "Input",
 InitializationCell->True],
Cell[268797, 6870, 598, 14, 43, "Input",
 InitializationCell->True],
Cell[269398, 6886, 17980, 336, 1033, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
